                                                QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 [                                                                                                       +
   {                                                                                                     +
     "Plan": {                                                                                           +
       "Node Type": "Sort",                                                                             +
       "Parallel Aware": false,                                                                          +
       "Startup Cost": 252226.47,                                                                        +
       "Total Cost": 252226.82,                                                                          +
       "Plan Rows": 1,                                                                                   +
       "Plan Width": 236,                                                                                +
       "Plans": [                                                                                        +
         {                                                                                               +
           "Node Type": "Aggregate",                                                                     +
           "Strategy": "Sorted",                                                                         +
           "Partial Mode": "Finalize",                                                                   +
           "Parent Relationship": "Outer",                                                               +
           "Parallel Aware": false,                                                                      +
           "Startup Cost": 252226.47,                                                                    +
           "Total Cost": 252228.55,                                                                      +
           "Plan Rows": 6,                                                                               +
           "Plan Width": 236,                                                                            +
           "Group Key": ["l_returnflag", "l_linestatus"],                                                +
           "Plans": [                                                                                    +
             {                                                                                           +
               "Node Type": "Gather Merge",                                                              +
               "Parent Relationship": "Outer",                                                           +
               "Parallel Aware": false,                                                                  +
               "Startup Cost": 252226.47,                                                                +
               "Total Cost": 252227.87,                                                                  +
               "Plan Rows": 12,                                                                          +
               "Plan Width": 236,                                                                        +
               "Workers Planned": 2,                                                                     +
               "Plans": [                                                                                +
                 {                                                                                       +
                   "Node Type": "Sort",                                                                  +
                   "Parent Relationship": "Outer",                                                       +
                   "Parallel Aware": false,                                                              +
                   "Startup Cost": 251226.45,                                                            +
                   "Total Cost": 251226.47,                                                              +
                   "Plan Rows": 6,                                                                       +
                   "Plan Width": 236,                                                                    +
                   "Sort Key": ["l_returnflag", "l_linestatus"],                                         +
                   "Plans": [                                                                            +
                     {                                                                                   +
                       "Node Type": "Aggregate",                                                         +
                       "Strategy": "Hashed",                                                             +
                       "Partial Mode": "Partial",                                                        +
                       "Parent Relationship": "Outer",                                                   +
                       "Parallel Aware": false,                                                          +
                       "Startup Cost": 251226.21,                                                        +
                       "Total Cost": 251226.37,                                                          +
                       "Plan Rows": 6,                                                                   +
                       "Plan Width": 236,                                                                +
                       "Group Key": ["l_returnflag", "l_linestatus"],                                    +
                       "Plans": [                                                                        +
                         {                                                                               +
                           "Node Type": "Seq Scan",                                                      +
                           "Parent Relationship": "Outer",                                               +
                           "Parallel Aware": true,                                                       +
                           "Relation Name": "lineitem",                                                  +
                           "Alias": "lineitem",                                                          +
                           "Startup Cost": 0.00,                                                         +
                           "Total Cost": 152802.09,                                                      +
                           "Plan Rows": 2460603,                                                         +
                           "Plan Width": 25,                                                             +
                           "Filter": "(l_shipdate <= '1998-08-29 00:00:00'::timestamp without time zone)"+
                         }                                                                               +
                       ]                                                                                 +
                     }                                                                                   +
                   ]                                                                                     +
                 }                                                                                       +
               ]                                                                                         +
             }                                                                                           +
           ]                                                                                             +
         }                                                                                               +
       ]                                                                                                 +
     },                                                                                                  +
     "JIT": {                                                                                            +
       "Worker Number": -1,                                                                              +
       "Functions": 10,                                                                                  +
       "Options": {                                                                                      +
         "Inlining": false,                                                                              +
         "Optimization": false,                                                                          +
         "Expressions": true,                                                                            +
         "Deforming": true                                                                               +
       }                                                                                                 +
     }                                                                                                   +
   }                                                                                                     +
 ]
(1 row)

 l_returnflag | l_linestatus | sum_qty  | sum_base_price |  sum_disc_price  |     sum_charge     |       avg_qty       |     avg_price      |        avg_disc        | count_order 
--------------+--------------+----------+----------------+------------------+--------------------+---------------------+--------------------+------------------------+-------------
 A            | F            | 37734107 | 56586554400.73 | 53758257134.8700 | 55909065222.827692 | 25.5220058532573370 | 38273.129734621672 | 0.04998529583839761162 |     1478493
(1 row)

QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 [                                                                                                       +
   {                                                                                                     +
     "Plan": {                                                                                           +
       "Node Type": "Limit",                                                                             +
       "Parallel Aware": false,                                                                          +
       "Startup Cost": 13655.54,                                                                         +
       "Total Cost": 13655.55,                                                                           +
       "Plan Rows": 1,                                                                                   +
       "Plan Width": 192,                                                                                +
       "Plans": [                                                                                        +
         {                                                                                               +
           "Node Type": "Sort",                                                                          +
           "Parent Relationship": "Outer",                                                               +
           "Parallel Aware": false,                                                                      +
           "Startup Cost": 13655.54,                                                                     +
           "Total Cost": 13655.55,                                                                       +
           "Plan Rows": 1,                                                                               +
           "Plan Width": 192,                                                                            +
           "Sort Key": ["supplier.s_acctbal DESC", "nation.n_name", "supplier.s_name", "part.p_partkey"],+
           "Plans": [                                                                                    +
             {                                                                                           +
               "Node Type": "Nested Loop",                                                               +
               "Parent Relationship": "Outer",                                                           +
               "Parallel Aware": false,                                                                  +
               "Join Type": "Inner",                                                                     +
               "Startup Cost": 0.71,                                                                     +
               "Total Cost": 13655.53,                                                                   +
               "Plan Rows": 1,                                                                           +
               "Plan Width": 192,                                                                        +
               "Inner Unique": true,                                                                     +
               "Join Filter": "(nation.n_regionkey = region.r_regionkey)",                               +
               "Plans": [                                                                                +
                 {                                                                                       +
                   "Node Type": "Nested Loop",                                                           +
                   "Parent Relationship": "Outer",                                                       +
                   "Parallel Aware": false,                                                              +
                   "Join Type": "Inner",                                                                 +
                   "Startup Cost": 0.71,                                                                 +
                   "Total Cost": 13654.46,                                                               +
                   "Plan Rows": 1,                                                                       +
                   "Plan Width": 200,                                                                    +
                   "Inner Unique": true,                                                                 +
                   "Join Filter": "(supplier.s_nationkey = nation.n_nationkey)",                         +
                   "Plans": [                                                                            +
                     {                                                                                   +
                       "Node Type": "Nested Loop",                                                       +
                       "Parent Relationship": "Outer",                                                   +
                       "Parallel Aware": false,                                                          +
                       "Join Type": "Inner",                                                             +
                       "Startup Cost": 0.71,                                                             +
                       "Total Cost": 13652.90,                                                           +
                       "Plan Rows": 1,                                                                   +
                       "Plan Width": 174,                                                                +
                       "Inner Unique": true,                                                             +
                       "Plans": [                                                                        +
                         {                                                                               +
                           "Node Type": "Nested Loop",                                                   +
                           "Parent Relationship": "Outer",                                               +
                           "Parallel Aware": false,                                                      +
                           "Join Type": "Inner",                                                         +
                           "Startup Cost": 0.42,                                                         +
                           "Total Cost": 13652.59,                                                       +
                           "Plan Rows": 1,                                                               +
                           "Plan Width": 38,                                                             +
                           "Inner Unique": false,                                                        +
                           "Plans": [                                                                    +
                             {                                                                           +
                               "Node Type": "Seq Scan",                                                  +
                               "Parent Relationship": "Outer",                                           +
                               "Parallel Aware": false,                                                  +
                               "Relation Name": "part",                                                  +
                               "Alias": "part",                                                          +
                               "Startup Cost": 0.00,                                                     +
                               "Total Cost": 710.00,                                                     +
                               "Plan Rows": 71,                                                          +
                               "Plan Width": 30,                                                         +
                               "Filter": "(((p_type)::text ~~ '%BRASS'::text) AND (p_size = 41))"        +
                             },                                                                          +
                             {                                                                           +
                               "Node Type": "Index Scan",                                                +
                               "Parent Relationship": "Inner",                                           +
                               "Parallel Aware": false,                                                  +
                               "Scan Direction": "Forward",                                              +
                               "Index Name": "idx_partsupp_partkey",                                     +
                               "Relation Name": "partsupp",                                              +
                               "Alias": "partsupp",                                                      +
                               "Startup Cost": 0.42,                                                     +
                               "Total Cost": 182.28,                                                     +
                               "Plan Rows": 1,                                                           +
                               "Plan Width": 22,                                                         +
                               "Index Cond": "(ps_partkey = part.p_partkey)",                            +
                               "Filter": "((SubPlan 1) = ps_supplycost)",                                +
                               "Plans": [                                                                +
                                 {                                                                       +
                                   "Node Type": "Aggregate",                                             +
                                   "Strategy": "Plain",                                                  +
                                   "Partial Mode": "Simple",                                             +
                                   "Parent Relationship": "SubPlan",                                     +
                                   "Subplan Name": "SubPlan 1",                                          +
                                   "Parallel Aware": false,                                              +
                                   "Startup Cost": 43.45,                                                +
                                   "Total Cost": 43.46,                                                  +
                                   "Plan Rows": 1,                                                       +
                                   "Plan Width": 32,                                                     +
                                   "Plans": [                                                            +
                                     {                                                                   +
                                       "Node Type": "Nested Loop",                                       +
                                       "Parent Relationship": "Outer",                                   +
                                       "Parallel Aware": false,                                          +
                                       "Join Type": "Inner",                                             +
                                       "Startup Cost": 0.85,                                             +
                                       "Total Cost": 43.45,                                              +
                                       "Plan Rows": 1,                                                   +
                                       "Plan Width": 6,                                                  +
                                       "Inner Unique": false,                                            +
                                       "Join Filter": "(nation_1.n_regionkey = region_1.r_regionkey)",   +
                                       "Plans": [                                                        +
                                         {                                                               +
                                           "Node Type": "Seq Scan",                                      +
                                           "Parent Relationship": "Outer",                               +
                                           "Parallel Aware": false,                                      +
                                           "Relation Name": "region",                                    +
                                           "Alias": "region_1",                                          +
                                           "Startup Cost": 0.00,                                         +
                                           "Total Cost": 1.06,                                           +
                                           "Plan Rows": 1,                                               +
                                           "Plan Width": 4,                                              +
                                           "Filter": "(r_name = 'AFRICA'::bpchar)"                       +
                                         },                                                              +
                                         {                                                               +
                                           "Node Type": "Nested Loop",                                   +
                                           "Parent Relationship": "Inner",                               +
                                           "Parallel Aware": false,                                      +
                                           "Join Type": "Inner",                                         +
                                           "Startup Cost": 0.85,                                         +
                                           "Total Cost": 42.33,                                          +
                                           "Plan Rows": 4,                                               +
                                           "Plan Width": 14,                                             +
                                           "Inner Unique": true,                                         +
                                           "Plans": [                                                    +
                                             {                                                           +
                                               "Node Type": "Nested Loop",                               +
                                               "Parent Relationship": "Outer",                           +
                                               "Parallel Aware": false,                                  +
                                               "Join Type": "Inner",                                     +
                                               "Startup Cost": 0.71,                                     +
                                               "Total Cost": 41.71,                                      +
                                               "Plan Rows": 4,                                           +
                                               "Plan Width": 14,                                         +
                                               "Inner Unique": true,                                     +
                                               "Plans": [                                                +
                                                 {                                                       +
                                                   "Node Type": "Index Scan",                            +
                                                   "Parent Relationship": "Outer",                       +
                                                   "Parallel Aware": false,                              +
                                                   "Scan Direction": "Forward",                          +
                                                   "Index Name": "idx_partsupp_partkey",                 +
                                                   "Relation Name": "partsupp",                          +
                                                   "Alias": "partsupp_1",                                +
                                                   "Startup Cost": 0.42,                                 +
                                                   "Total Cost": 8.50,                                   +
                                                   "Plan Rows": 4,                                       +
                                                   "Plan Width": 14,                                     +
                                                   "Index Cond": "(ps_partkey = part.p_partkey)"         +
                                                 },                                                      +
                                                 {                                                       +
                                                   "Node Type": "Index Scan",                            +
                                                   "Parent Relationship": "Inner",                       +
                                                   "Parallel Aware": false,                              +
                                                   "Scan Direction": "Forward",                          +
                                                   "Index Name": "supplier_pkey",                        +
                                                   "Relation Name": "supplier",                          +
                                                   "Alias": "supplier_1",                                +
                                                   "Startup Cost": 0.29,                                 +
                                                   "Total Cost": 8.30,                                   +
                                                   "Plan Rows": 1,                                       +
                                                   "Plan Width": 12,                                     +
                                                   "Index Cond": "(s_suppkey = partsupp_1.ps_suppkey)"   +
                                                 }                                                       +
                                               ]                                                         +
                                             },                                                          +
                                             {                                                           +
                                               "Node Type": "Index Scan",                                +
                                               "Parent Relationship": "Inner",                           +
                                               "Parallel Aware": false,                                  +
                                               "Scan Direction": "Forward",                              +
                                               "Index Name": "nation_pkey",                              +
                                               "Relation Name": "nation",                                +
                                               "Alias": "nation_1",                                      +
                                               "Startup Cost": 0.14,                                     +
                                               "Total Cost": 0.16,                                       +
                                               "Plan Rows": 1,                                           +
                                               "Plan Width": 12,                                         +
                                               "Index Cond": "(n_nationkey = supplier_1.s_nationkey)"    +
                                             }                                                           +
                                           ]                                                             +
                                         }                                                               +
                                       ]                                                                 +
                                     }                                                                   +
                                   ]                                                                     +
                                 }                                                                       +
                               ]                                                                         +
                             }                                                                           +
                           ]                                                                             +
                         },                                                                              +
                         {                                                                               +
                           "Node Type": "Index Scan",                                                    +
                           "Parent Relationship": "Inner",                                               +
                           "Parallel Aware": false,                                                      +
                           "Scan Direction": "Forward",                                                  +
                           "Index Name": "supplier_pkey",                                                +
                           "Relation Name": "supplier",                                                  +
                           "Alias": "supplier",                                                          +
                           "Startup Cost": 0.29,                                                         +
                           "Total Cost": 0.30,                                                           +
                           "Plan Rows": 1,                                                               +
                           "Plan Width": 148,                                                            +
                           "Index Cond": "(s_suppkey = partsupp.ps_suppkey)"                             +
                         }                                                                               +
                       ]                                                                                 +
                     },                                                                                  +
                     {                                                                                   +
                       "Node Type": "Seq Scan",                                                          +
                       "Parent Relationship": "Inner",                                                   +
                       "Parallel Aware": false,                                                          +
                       "Relation Name": "nation",                                                        +
                       "Alias": "nation",                                                                +
                       "Startup Cost": 0.00,                                                             +
                       "Total Cost": 1.25,                                                               +
                       "Plan Rows": 25,                                                                  +
                       "Plan Width": 38                                                                  +
                     }                                                                                   +
                   ]                                                                                     +
                 },                                                                                      +
                 {                                                                                       +
                   "Node Type": "Seq Scan",                                                              +
                   "Parent Relationship": "Inner",                                                       +
                   "Parallel Aware": false,                                                              +
                   "Relation Name": "region",                                                            +
                   "Alias": "region",                                                                    +
                   "Startup Cost": 0.00,                                                                 +
                   "Total Cost": 1.06,                                                                   +
                   "Plan Rows": 1,                                                                       +
                   "Plan Width": 4,                                                                      +
                   "Filter": "(r_name = 'AFRICA'::bpchar)"                                               +
                 }                                                                                       +
               ]                                                                                         +
             }                                                                                           +
           ]                                                                                             +
         }                                                                                               +
       ]                                                                                                 +
     }                                                                                                   +
   }                                                                                                     +
 ]
(1 row)

 s_acctbal |          s_name           |          n_name           | p_partkey |          p_mfgr           |                s_address                 |     s_phone     |                                              s_comment                                              
-----------+---------------------------+---------------------------+-----------+---------------------------+------------------------------------------+-----------------+-----------------------------------------------------------------------------------------------------
   9836.53 | Supplier#000005077        | ALGERIA                   |     10074 | Manufacturer#3            | AoD06AAcIfuPu4B6YzUyFOYgVyb6             | 10-852-519-9875 | ven accounts. quickly express deposits was blithe
   9789.53 | Supplier#000009333        | ETHIOPIA                  |      4332 | Manufacturer#4            | e9JTDP8Pt7IrPBBlimjs ,                   | 15-289-312-9549 | e furiously quickly special packages. fluffily final pearls are about the
   9194.06 | Supplier#000002367        | ALGERIA                   |      9866 | Manufacturer#4            | c42IIv2nUcLJ9hGrhhiAmfOQwvq1zgzxg8tv     | 10-321-635-8217 |  sauternes boost carefully sly
   9182.66 | Supplier#000002593        | KENYA                     |      2592 | Manufacturer#1            | oRkHFWHinuEMfLR1OPZSbW0rjYBK             | 24-370-287-8574 | ffily. fluffily regular platelets sleep carefully. even asymptotes boost qu
   9024.58 | Supplier#000008952        | ETHIOPIA                  |     13949 | Manufacturer#1            | Pieung,FW1704mtb                         | 15-856-379-5065 | y even ideas. ironic theodolites use furiously fluffily express pinto beans.
   8476.39 | Supplier#000001029        | ETHIOPIA                  |     16026 | Manufacturer#2            | 6quaw3pjSuzrj5d                          | 15-507-720-2035 | ly fluffily even pinto beans. bold packages across the doggedly unusual deposits slee
   7856.00 | Supplier#000004130        | KENYA                     |      9129 | Manufacturer#2            | 2Qd5FYKuN,sT                             | 24-766-166-3005 | finally fluffily final deposits. unusual ideas sublate slyly furiously regular accounts: slyly ex
   7461.28 | Supplier#000003479        | MOROCCO                   |      8478 | Manufacturer#1            | OuQuffXBJFwrjPQCrqqVkj8jJA15Ex           | 25-609-427-3896 | sly. fluffily even instructions detect carefully! final theodolites haggle blithely fur
   6714.90 | Supplier#000002382        | ETHIOPIA                  |     17379 | Manufacturer#5            | otBPUYXGv LZifYiBq1XPTVKn7d              | 15-391-167-3113 | s boost after the quickly pendin
   6353.37 | Supplier#000002399        | MOROCCO                   |      4898 | Manufacturer#3            | SrJEPXIjxUZm21                           | 25-717-506-8761 | arefully ironic accounts run furiously! quickly unusual requests print 
   6257.01 | Supplier#000005576        | ALGERIA                   |     18072 | Manufacturer#5            | UXqU25sDkQRbz7YI8U                       | 10-616-875-3742 |  final requests. pending theodolites are enticingly; ironic requests nag around 
   6095.56 | Supplier#000001547        | ALGERIA                   |      6546 | Manufacturer#2            | bgbQboa0uUWjyXQlmtmHvXh                  | 10-509-209-3829 | ts nag final, final accounts. quietly even requests solve fu
   5997.41 | Supplier#000002760        | ETHIOPIA                  |       259 | Manufacturer#2            | JwaOuD8jdeWmVr6SEnVbF,KpdO6              | 15-554-965-5719 | aggle carefully final deposits. furiously ironic pinto be
   5632.80 | Supplier#000006638        | ALGERIA                   |      6637 | Manufacturer#1            | DwONGWZWPFxc8PO7                         | 10-918-771-1784 | , pending packages wake slyly. special packages haggle blithely bold depths: theodoli
   5262.96 | Supplier#000006538        | ETHIOPIA                  |     14036 | Manufacturer#1            | P3cQB4pXMpKnmFaV6KoSH                    | 15-992-941-8372 | express theodolites cajole furiously according to the final, ironic packa
   5139.45 | Supplier#000004403        | MOZAMBIQUE                |     16899 | Manufacturer#2            | kNuMkd6GbeJpDyrfPTvzGks1bxWRPC           | 26-971-753-9655 | integrate carefully about the pending, even deposits. furiously pending instructions 
   4869.04 | Supplier#000005121        | KENYA                     |      7620 | Manufacturer#4            | tSJ3v6tz8dkFGm1nBLzG5TDKWlwunrmsTbN      | 24-323-343-8567 | riously regular dependencies. quickly exp
   4479.45 | Supplier#000001945        | MOZAMBIQUE                |      4444 | Manufacturer#5            | edI,,ekDTNDdlzQYIHnhdbkw                 | 26-826-634-5171 | lar accounts cajole slyly blithel
   4407.93 | Supplier#000005916        | ALGERIA                   |     15915 | Manufacturer#3            | eTiCaIOAelGmGFFsaevI6pm                  | 10-514-995-4456 | nts. blithely pending accounts wake quickly against t
   4210.77 | Supplier#000009724        | ALGERIA                   |     14721 | Manufacturer#3            | ICG8T,65SKiEHuEM7cuXDdb1s UACT           | 10-375-108-2181 | es: quickly final platelets use fluff
   4183.98 | Supplier#000003615        | MOZAMBIQUE                |      6114 | Manufacturer#4            | tMQyLZmdndVb9Q9VUh,yQNXRnYE6nv           | 26-633-200-8239 | ffily thin theodolites. requests mainta
   3955.67 | Supplier#000002411        | MOZAMBIQUE                |     14907 | Manufacturer#1            | vhHQgR,vY3s,Ntb,yIUYN6XCZFMopFZslUL      | 26-906-744-9070 | lyly final deposits haggle furiously ironic theodolites. even, final theodolites wake. qui
   3932.75 | Supplier#000002768        | MOROCCO                   |       267 | Manufacturer#2            | Z5XIwCs200u2A2aA                         | 25-753-877-2336 | ts integrate after the blith
   3902.59 | Supplier#000006140        | ALGERIA                   |     16139 | Manufacturer#5            | 93EycC3P9tiKu5XEkgb3duqG0                | 10-779-683-2433 | ent foxes. quietly unusual requests sleep carefully from the doggedly express instructions. bli
   3853.97 | Supplier#000009014        | ALGERIA                   |      4013 | Manufacturer#5            | VESdCwbtiG1mRHWvkdOZsmZJU                | 10-628-325-8932 |  even packages boost slyly carefully 
   3284.77 | Supplier#000009084        | ALGERIA                   |      4083 | Manufacturer#3            | vFZS4BU4E8BTJ5r8PcrZFtc2pnIXm            | 10-830-177-5803 | cial accounts. slyly final theodolites detect slyly fluffily regular reques
   1887.55 | Supplier#000000803        | MOROCCO                   |       802 | Manufacturer#3            | ,IXoixqcMluU5OEK7RhD,mDrBE2E3ygs         | 25-347-400-8216 | uiet ideas. even packages haggle carefully according to the fluffily slow requests. furiously ironi
   1681.78 | Supplier#000001314        | MOROCCO                   |     18812 | Manufacturer#4            | aJDmqSRKvJC1Kgj,ceIfkh                   | 25-594-221-9764 | ously regular pinto beans. quickly express depo
   1602.63 | Supplier#000009110        | MOZAMBIQUE                |      6609 | Manufacturer#3            | XF7zJMesO8DPCVXLFFK6OI                   | 26-849-550-2740 | nusual ideas boost carefully! theodolites wake furiously. blithely pendi
   1280.51 | Supplier#000001407        | ALGERIA                   |      6406 | Manufacturer#2            | WK03co4CUF2cG2,hv rnQ                    | 10-436-924-3833 | ages boost carefully express accoun
    933.88 | Supplier#000006626        | MOZAMBIQUE                |     16625 | Manufacturer#4            | ObYBeLozdoDjS7f791dqrXWBgfQR7xwOigm ,eVg | 26-897-536-6470 |  carefully regular foxes boost slyly regular packages-- bli
    617.59 | Supplier#000002962        | ALGERIA                   |     17959 | Manufacturer#1            | gRQXWtrUwB6Al99PmX1O                     | 10-441-106-4025 | tions boost slyly regular, express dolphins. ironic ideas haggle slyl
    378.43 | Supplier#000002045        | KENYA                     |     12044 | Manufacturer#5            | 3GVjWVjXkGXUeF82afLa,A                   | 24-956-242-7409 | ter the fluffily even deposits
     92.44 | Supplier#000000058        | MOZAMBIQUE                |     17556 | Manufacturer#3            | 01dEADIZoCULZXg                          | 26-659-969-5586 | refully final foxes are. even, express courts according to the b
   -194.72 | Supplier#000009559        | MOROCCO                   |      4558 | Manufacturer#4            | 8dQO1,H5piQRBDV,96PYVVCXW2dunI0yKXJJ77Bh | 25-566-702-1125 | ironic accounts sleep. courts cajole slyly. accounts sleep final deposi
   -519.74 | Supplier#000009299        | KENYA                     |     11795 | Manufacturer#1            | UKUpKpXccW5X4r1n1UIIxpjpJH               | 24-957-349-7082 | press packages are quickly after the furiously silent accounts. unus
   -763.43 | Supplier#000006017        | MOROCCO                   |      6016 | Manufacturer#1            | IUor4VqlDPJqahcVWH6KpmA29cbnu5X0SnD6     | 25-309-274-1235 | e after the even instructions. carefully silent deposits sleep.
   -787.56 | Supplier#000001443        | MOROCCO                   |     16440 | Manufacturer#3            | mRFGwS7y1HfgWC6styUuSst8orq2JlJhCWHCsr7r | 25-723-252-9388 | accounts. bold, pending ideas haggle blithely along the carefully ruthless deposits. qui
(38 rows)

QUERY PLAN                                                           
--------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                             +
   {                                                                                                                           +
     "Plan": {                                                                                                                 +
       "Node Type": "Limit",                                                                                                   +
       "Parallel Aware": false,                                                                                                +
       "Startup Cost": 202037.10,                                                                                              +
       "Total Cost": 202037.12,                                                                                                +
       "Plan Rows": 10,                                                                                                        +
       "Plan Width": 48,                                                                                                       +
       "Plans": [                                                                                                              +
         {                                                                                                                     +
           "Node Type": "Sort",                                                                                                +
           "Parent Relationship": "Outer",                                                                                     +
           "Parallel Aware": false,                                                                                            +
           "Startup Cost": 202037.10,                                                                                          +
           "Total Cost": 202816.49,                                                                                            +
           "Plan Rows": 311757,                                                                                                +
           "Plan Width": 48,                                                                                                   +
           "Sort Key": ["(sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC", "orders.o_orderdate"],+
           "Plans": [                                                                                                          +
             {                                                                                                                 +
               "Node Type": "Aggregate",                                                                                       +
               "Strategy": "Sorted",                                                                                           +
               "Partial Mode": "Finalize",                                                                                     +
               "Parent Relationship": "Outer",                                                                                 +
               "Parallel Aware": false,                                                                                        +
               "Startup Cost": 154271.60,                                                                                      +
               "Total Cost": 195300.14,                                                                                        +
               "Plan Rows": 311757,                                                                                            +
               "Plan Width": 48,                                                                                               +
               "Group Key": ["lineitem.l_orderkey", "orders.o_orderdate", "orders.o_shippriority"],                            +
               "Plans": [                                                                                                      +
                 {                                                                                                             +
                   "Node Type": "Gather Merge",                                                                                +
                   "Parent Relationship": "Outer",                                                                             +
                   "Parallel Aware": false,                                                                                    +
                   "Startup Cost": 154271.60,                                                                                  +
                   "Total Cost": 188155.71,                                                                                    +
                   "Plan Rows": 259798,                                                                                        +
                   "Plan Width": 48,                                                                                           +
                   "Workers Planned": 2,                                                                                       +
                   "Plans": [                                                                                                  +
                     {                                                                                                         +
                       "Node Type": "Aggregate",                                                                               +
                       "Strategy": "Sorted",                                                                                   +
                       "Partial Mode": "Partial",                                                                              +
                       "Parent Relationship": "Outer",                                                                         +
                       "Parallel Aware": false,                                                                                +
                       "Startup Cost": 153271.58,                                                                              +
                       "Total Cost": 157168.55,                                                                                +
                       "Plan Rows": 129899,                                                                                    +
                       "Plan Width": 48,                                                                                       +
                       "Group Key": ["lineitem.l_orderkey", "orders.o_orderdate", "orders.o_shippriority"],                    +
                       "Plans": [                                                                                              +
                         {                                                                                                     +
                           "Node Type": "Sort",                                                                                +
                           "Parent Relationship": "Outer",                                                                     +
                           "Parallel Aware": false,                                                                            +
                           "Startup Cost": 153271.58,                                                                          +
                           "Total Cost": 153596.32,                                                                            +
                           "Plan Rows": 129899,                                                                                +
                           "Plan Width": 28,                                                                                   +
                           "Sort Key": ["lineitem.l_orderkey", "orders.o_orderdate", "orders.o_shippriority"],                 +
                           "Plans": [                                                                                          +
                             {                                                                                                 +
                               "Node Type": "Nested Loop",                                                                     +
                               "Parent Relationship": "Outer",                                                                 +
                               "Parallel Aware": false,                                                                        +
                               "Join Type": "Inner",                                                                           +
                               "Startup Cost": 4647.78,                                                                        +
                               "Total Cost": 139130.58,                                                                        +
                               "Plan Rows": 129899,                                                                            +
                               "Plan Width": 28,                                                                               +
                               "Inner Unique": false,                                                                          +
                               "Plans": [                                                                                      +
                                 {                                                                                             +
                                   "Node Type": "Hash Join",                                                                   +
                                   "Parent Relationship": "Outer",                                                             +
                                   "Parallel Aware": true,                                                                     +
                                   "Join Type": "Inner",                                                                       +
                                   "Startup Cost": 4647.35,                                                                    +
                                   "Total Cost": 40862.68,                                                                     +
                                   "Plan Rows": 59962,                                                                         +
                                   "Plan Width": 12,                                                                           +
                                   "Inner Unique": true,                                                                       +
                                   "Hash Cond": "(orders.o_custkey = customer.c_custkey)",                                     +
                                   "Plans": [                                                                                  +
                                     {                                                                                         +
                                       "Node Type": "Seq Scan",                                                                +
                                       "Parent Relationship": "Outer",                                                         +
                                       "Parallel Aware": true,                                                                 +
                                       "Relation Name": "orders",                                                              +
                                       "Alias": "orders",                                                                      +
                                       "Startup Cost": 0.00,                                                                   +
                                       "Total Cost": 35437.50,                                                                 +
                                       "Plan Rows": 296306,                                                                    +
                                       "Plan Width": 20,                                                                       +
                                       "Filter": "(o_orderdate < '1995-03-03'::date)"                                          +
                                     },                                                                                        +
                                     {                                                                                         +
                                       "Node Type": "Hash",                                                                    +
                                       "Parent Relationship": "Inner",                                                         +
                                       "Parallel Aware": true,                                                                 +
                                       "Startup Cost": 4489.25,                                                                +
                                       "Total Cost": 4489.25,                                                                  +
                                       "Plan Rows": 12648,                                                                     +
                                       "Plan Width": 4,                                                                        +
                                       "Plans": [                                                                              +
                                         {                                                                                     +
                                           "Node Type": "Seq Scan",                                                            +
                                           "Parent Relationship": "Outer",                                                     +
                                           "Parallel Aware": true,                                                             +
                                           "Relation Name": "customer",                                                        +
                                           "Alias": "customer",                                                                +
                                           "Startup Cost": 0.00,                                                               +
                                           "Total Cost": 4489.25,                                                              +
                                           "Plan Rows": 12648,                                                                 +
                                           "Plan Width": 4,                                                                    +
                                           "Filter": "(c_mktsegment = 'FURNITURE'::bpchar)"                                    +
                                         }                                                                                     +
                                       ]                                                                                       +
                                     }                                                                                         +
                                   ]                                                                                           +
                                 },                                                                                            +
                                 {                                                                                             +
                                   "Node Type": "Index Scan",                                                                  +
                                   "Parent Relationship": "Inner",                                                             +
                                   "Parallel Aware": false,                                                                    +
                                   "Scan Direction": "Forward",                                                                +
                                   "Index Name": "idx_lineitem_orderkey",                                                      +
                                   "Relation Name": "lineitem",                                                                +
                                   "Alias": "lineitem",                                                                        +
                                   "Startup Cost": 0.43,                                                                       +
                                   "Total Cost": 1.55,                                                                         +
                                   "Plan Rows": 9,                                                                             +
                                   "Plan Width": 20,                                                                           +
                                   "Index Cond": "(l_orderkey = orders.o_orderkey)",                                           +
                                   "Filter": "(l_shipdate > '1995-03-03'::date)"                                               +
                                 }                                                                                             +
                               ]                                                                                               +
                             }                                                                                                 +
                           ]                                                                                                   +
                         }                                                                                                     +
                       ]                                                                                                       +
                     }                                                                                                         +
                   ]                                                                                                           +
                 }                                                                                                             +
               ]                                                                                                               +
             }                                                                                                                 +
           ]                                                                                                                   +
         }                                                                                                                     +
       ]                                                                                                                       +
     },                                                                                                                        +
     "JIT": {                                                                                                                  +
       "Worker Number": -1,                                                                                                    +
       "Functions": 29,                                                                                                        +
       "Options": {                                                                                                            +
         "Inlining": false,                                                                                                    +
         "Optimization": false,                                                                                                +
         "Expressions": true,                                                                                                  +
         "Deforming": true                                                                                                     +
       }                                                                                                                       +
     }                                                                                                                         +
   }                                                                                                                           +
 ]
(1 row)

 l_orderkey |   revenue   | o_orderdate | o_shippriority 
------------+-------------+-------------+----------------
     820962 | 419926.0763 | 1995-02-11  |              0
     630307 | 415855.5458 | 1995-01-30  |              0
    4607909 | 414722.4714 | 1995-02-27  |              0
    3182468 | 410405.5494 | 1995-02-11  |              0
    4868034 | 404208.2718 | 1995-02-20  |              0
    1670759 | 394096.6203 | 1995-02-20  |              0
    3021510 | 392182.0173 | 1995-02-04  |              0
    4940928 | 391339.2508 | 1995-02-12  |              0
    4046689 | 387831.7184 | 1995-02-07  |              0
     725350 | 385547.2742 | 1995-03-02  |              0
(10 rows)

QUERY PLAN                                                                           
----------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                             +
   {                                                                                                                                                           +
     "Plan": {                                                                                                                                                 +
       "Node Type": "Limit",                                                                                                                                   +
       "Parallel Aware": false,                                                                                                                                +
       "Startup Cost": 63857.26,                                                                                                                               +
       "Total Cost": 63866.16,                                                                                                                                 +
       "Plan Rows": 1,                                                                                                                                         +
       "Plan Width": 24,                                                                                                                                       +
       "Plans": [                                                                                                                                              +
         {                                                                                                                                                     +
           "Node Type": "Aggregate",                                                                                                                           +
           "Strategy": "Sorted",                                                                                                                               +
           "Partial Mode": "Finalize",                                                                                                                         +
           "Parent Relationship": "Outer",                                                                                                                     +
           "Parallel Aware": false,                                                                                                                            +
           "Startup Cost": 63857.26,                                                                                                                           +
           "Total Cost": 63901.74,                                                                                                                             +
           "Plan Rows": 5,                                                                                                                                     +
           "Plan Width": 24,                                                                                                                                   +
           "Group Key": ["orders.o_orderpriority"],                                                                                                            +
           "Plans": [                                                                                                                                          +
             {                                                                                                                                                 +
               "Node Type": "Gather Merge",                                                                                                                    +
               "Parent Relationship": "Outer",                                                                                                                 +
               "Parallel Aware": false,                                                                                                                        +
               "Startup Cost": 63857.26,                                                                                                                       +
               "Total Cost": 63901.64,                                                                                                                         +
               "Plan Rows": 10,                                                                                                                                +
               "Plan Width": 24,                                                                                                                               +
               "Workers Planned": 2,                                                                                                                           +
               "Plans": [                                                                                                                                      +
                 {                                                                                                                                             +
                   "Node Type": "Aggregate",                                                                                                                   +
                   "Strategy": "Sorted",                                                                                                                       +
                   "Partial Mode": "Partial",                                                                                                                  +
                   "Parent Relationship": "Outer",                                                                                                             +
                   "Parallel Aware": false,                                                                                                                    +
                   "Startup Cost": 62857.24,                                                                                                                   +
                   "Total Cost": 62900.46,                                                                                                                     +
                   "Plan Rows": 5,                                                                                                                             +
                   "Plan Width": 24,                                                                                                                           +
                   "Group Key": ["orders.o_orderpriority"],                                                                                                    +
                   "Plans": [                                                                                                                                  +
                     {                                                                                                                                         +
                       "Node Type": "Sort",                                                                                                                    +
                       "Parent Relationship": "Outer",                                                                                                         +
                       "Parallel Aware": false,                                                                                                                +
                       "Startup Cost": 62857.24,                                                                                                               +
                       "Total Cost": 62871.63,                                                                                                                 +
                       "Plan Rows": 5756,                                                                                                                      +
                       "Plan Width": 16,                                                                                                                       +
                       "Sort Key": ["orders.o_orderpriority"],                                                                                                 +
                       "Plans": [                                                                                                                              +
                         {                                                                                                                                     +
                           "Node Type": "Nested Loop",                                                                                                         +
                           "Parent Relationship": "Outer",                                                                                                     +
                           "Parallel Aware": false,                                                                                                            +
                           "Join Type": "Semi",                                                                                                                +
                           "Startup Cost": 1242.02,                                                                                                            +
                           "Total Cost": 62497.75,                                                                                                             +
                           "Plan Rows": 5756,                                                                                                                  +
                           "Plan Width": 16,                                                                                                                   +
                           "Inner Unique": false,                                                                                                              +
                           "Plans": [                                                                                                                          +
                             {                                                                                                                                 +
                               "Node Type": "Bitmap Heap Scan",                                                                                                +
                               "Parent Relationship": "Outer",                                                                                                 +
                               "Parallel Aware": true,                                                                                                         +
                               "Relation Name": "orders",                                                                                                      +
                               "Alias": "orders",                                                                                                              +
                               "Startup Cost": 1241.59,                                                                                                        +
                               "Total Cost": 29230.72,                                                                                                         +
                               "Plan Rows": 24275,                                                                                                             +
                               "Plan Width": 20,                                                                                                               +
                               "Recheck Cond": "((o_orderdate >= '1993-06-01'::date) AND (o_orderdate < '1993-09-01 00:00:00'::timestamp without time zone))", +
                               "Plans": [                                                                                                                      +
                                 {                                                                                                                             +
                                   "Node Type": "Bitmap Index Scan",                                                                                           +
                                   "Parent Relationship": "Outer",                                                                                             +
                                   "Parallel Aware": false,                                                                                                    +
                                   "Index Name": "idx_orders_orderdate",                                                                                       +
                                   "Startup Cost": 0.00,                                                                                                       +
                                   "Total Cost": 1227.03,                                                                                                      +
                                   "Plan Rows": 58260,                                                                                                         +
                                   "Plan Width": 0,                                                                                                            +
                                   "Index Cond": "((o_orderdate >= '1993-06-01'::date) AND (o_orderdate < '1993-09-01 00:00:00'::timestamp without time zone))"+
                                 }                                                                                                                             +
                               ]                                                                                                                               +
                             },                                                                                                                                +
                             {                                                                                                                                 +
                               "Node Type": "Index Scan",                                                                                                      +
                               "Parent Relationship": "Inner",                                                                                                 +
                               "Parallel Aware": false,                                                                                                        +
                               "Scan Direction": "Forward",                                                                                                    +
                               "Index Name": "idx_lineitem_orderkey",                                                                                          +
                               "Relation Name": "lineitem",                                                                                                    +
                               "Alias": "lineitem",                                                                                                            +
                               "Startup Cost": 0.43,                                                                                                           +
                               "Total Cost": 5.13,                                                                                                             +
                               "Plan Rows": 6,                                                                                                                 +
                               "Plan Width": 8,                                                                                                                +
                               "Index Cond": "(l_orderkey = orders.o_orderkey)",                                                                               +
                               "Filter": "(l_commitdate < l_receiptdate)"                                                                                      +
                             }                                                                                                                                 +
                           ]                                                                                                                                   +
                         }                                                                                                                                     +
                       ]                                                                                                                                       +
                     }                                                                                                                                         +
                   ]                                                                                                                                           +
                 }                                                                                                                                             +
               ]                                                                                                                                               +
             }                                                                                                                                                 +
           ]                                                                                                                                                   +
         }                                                                                                                                                     +
       ]                                                                                                                                                       +
     }                                                                                                                                                         +
   }                                                                                                                                                           +
 ]
(1 row)

 o_orderpriority | order_count 
-----------------+-------------
 1-URGENT        |       10640
(1 row)

QUERY PLAN                                                                             
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                                 +
   {                                                                                                                                                               +
     "Plan": {                                                                                                                                                     +
       "Node Type": "Limit",                                                                                                                                       +
       "Parallel Aware": false,                                                                                                                                    +
       "Startup Cost": 89340.16,                                                                                                                                   +
       "Total Cost": 89340.17,                                                                                                                                     +
       "Plan Rows": 1,                                                                                                                                             +
       "Plan Width": 58,                                                                                                                                           +
       "Plans": [                                                                                                                                                  +
         {                                                                                                                                                         +
           "Node Type": "Sort",                                                                                                                                    +
           "Parent Relationship": "Outer",                                                                                                                         +
           "Parallel Aware": false,                                                                                                                                +
           "Startup Cost": 89340.16,                                                                                                                               +
           "Total Cost": 89340.23,                                                                                                                                 +
           "Plan Rows": 25,                                                                                                                                        +
           "Plan Width": 58,                                                                                                                                       +
           "Sort Key": ["(sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC"],                                                          +
           "Plans": [                                                                                                                                              +
             {                                                                                                                                                     +
               "Node Type": "Aggregate",                                                                                                                           +
               "Strategy": "Sorted",                                                                                                                               +
               "Partial Mode": "Finalize",                                                                                                                         +
               "Parent Relationship": "Outer",                                                                                                                     +
               "Parallel Aware": false,                                                                                                                            +
               "Startup Cost": 89295.78,                                                                                                                           +
               "Total Cost": 89340.04,                                                                                                                             +
               "Plan Rows": 25,                                                                                                                                    +
               "Plan Width": 58,                                                                                                                                   +
               "Group Key": ["nation.n_name"],                                                                                                                     +
               "Plans": [                                                                                                                                          +
                 {                                                                                                                                                 +
                   "Node Type": "Gather Merge",                                                                                                                    +
                   "Parent Relationship": "Outer",                                                                                                                 +
                   "Parallel Aware": false,                                                                                                                        +
                   "Startup Cost": 89295.78,                                                                                                                       +
                   "Total Cost": 89339.35,                                                                                                                         +
                   "Plan Rows": 50,                                                                                                                                +
                   "Plan Width": 58,                                                                                                                               +
                   "Workers Planned": 2,                                                                                                                           +
                   "Plans": [                                                                                                                                      +
                     {                                                                                                                                             +
                       "Node Type": "Aggregate",                                                                                                                   +
                       "Strategy": "Sorted",                                                                                                                       +
                       "Partial Mode": "Partial",                                                                                                                  +
                       "Parent Relationship": "Outer",                                                                                                             +
                       "Parallel Aware": false,                                                                                                                    +
                       "Startup Cost": 88295.76,                                                                                                                   +
                       "Total Cost": 88333.56,                                                                                                                     +
                       "Plan Rows": 25,                                                                                                                            +
                       "Plan Width": 58,                                                                                                                           +
                       "Group Key": ["nation.n_name"],                                                                                                             +
                       "Plans": [                                                                                                                                  +
                         {                                                                                                                                         +
                           "Node Type": "Sort",                                                                                                                    +
                           "Parent Relationship": "Outer",                                                                                                         +
                           "Parallel Aware": false,                                                                                                                +
                           "Startup Cost": 88295.76,                                                                                                               +
                           "Total Cost": 88303.25,                                                                                                                 +
                           "Plan Rows": 2999,                                                                                                                      +
                           "Plan Width": 38,                                                                                                                       +
                           "Sort Key": ["nation.n_name"],                                                                                                          +
                           "Plans": [                                                                                                                              +
                             {                                                                                                                                     +
                               "Node Type": "Hash Join",                                                                                                           +
                               "Parent Relationship": "Outer",                                                                                                     +
                               "Parallel Aware": false,                                                                                                            +
                               "Join Type": "Inner",                                                                                                               +
                               "Startup Cost": 483.37,                                                                                                             +
                               "Total Cost": 88122.56,                                                                                                             +
                               "Plan Rows": 2999,                                                                                                                  +
                               "Plan Width": 38,                                                                                                                   +
                               "Inner Unique": true,                                                                                                               +
                               "Hash Cond": "((lineitem.l_suppkey = supplier.s_suppkey) AND (customer.c_nationkey = supplier.s_nationkey))",                       +
                               "Plans": [                                                                                                                          +
                                 {                                                                                                                                 +
                                   "Node Type": "Nested Loop",                                                                                                     +
                                   "Parent Relationship": "Outer",                                                                                                 +
                                   "Parallel Aware": false,                                                                                                        +
                                   "Join Type": "Inner",                                                                                                           +
                                   "Startup Cost": 3.37,                                                                                                           +
                                   "Total Cost": 87247.08,                                                                                                         +
                                   "Plan Rows": 75329,                                                                                                             +
                                   "Plan Width": 58,                                                                                                               +
                                   "Inner Unique": false,                                                                                                          +
                                   "Plans": [                                                                                                                      +
                                     {                                                                                                                             +
                                       "Node Type": "Nested Loop",                                                                                                 +
                                       "Parent Relationship": "Outer",                                                                                             +
                                       "Parallel Aware": false,                                                                                                    +
                                       "Join Type": "Inner",                                                                                                       +
                                       "Startup Cost": 2.94,                                                                                                       +
                                       "Total Cost": 25776.88,                                                                                                     +
                                       "Plan Rows": 18828,                                                                                                         +
                                       "Plan Width": 42,                                                                                                           +
                                       "Inner Unique": false,                                                                                                      +
                                       "Plans": [                                                                                                                  +
                                         {                                                                                                                         +
                                           "Node Type": "Hash Join",                                                                                               +
                                           "Parent Relationship": "Outer",                                                                                         +
                                           "Parallel Aware": false,                                                                                                +
                                           "Join Type": "Inner",                                                                                                   +
                                           "Startup Cost": 2.51,                                                                                                   +
                                           "Total Cost": 4694.88,                                                                                                  +
                                           "Plan Rows": 12500,                                                                                                     +
                                           "Plan Width": 42,                                                                                                       +
                                           "Inner Unique": false,                                                                                                  +
                                           "Hash Cond": "(customer.c_nationkey = nation.n_nationkey)",                                                             +
                                           "Plans": [                                                                                                              +
                                             {                                                                                                                     +
                                               "Node Type": "Seq Scan",                                                                                            +
                                               "Parent Relationship": "Outer",                                                                                     +
                                               "Parallel Aware": true,                                                                                             +
                                               "Relation Name": "customer",                                                                                        +
                                               "Alias": "customer",                                                                                                +
                                               "Startup Cost": 0.00,                                                                                               +
                                               "Total Cost": 4333.00,                                                                                              +
                                               "Plan Rows": 62500,                                                                                                 +
                                               "Plan Width": 12                                                                                                    +
                                             },                                                                                                                    +
                                             {                                                                                                                     +
                                               "Node Type": "Hash",                                                                                                +
                                               "Parent Relationship": "Inner",                                                                                     +
                                               "Parallel Aware": false,                                                                                            +
                                               "Startup Cost": 2.45,                                                                                               +
                                               "Total Cost": 2.45,                                                                                                 +
                                               "Plan Rows": 5,                                                                                                     +
                                               "Plan Width": 30,                                                                                                   +
                                               "Plans": [                                                                                                          +
                                                 {                                                                                                                 +
                                                   "Node Type": "Hash Join",                                                                                       +
                                                   "Parent Relationship": "Outer",                                                                                 +
                                                   "Parallel Aware": false,                                                                                        +
                                                   "Join Type": "Inner",                                                                                           +
                                                   "Startup Cost": 1.07,                                                                                           +
                                                   "Total Cost": 2.45,                                                                                             +
                                                   "Plan Rows": 5,                                                                                                 +
                                                   "Plan Width": 30,                                                                                               +
                                                   "Inner Unique": true,                                                                                           +
                                                   "Hash Cond": "(nation.n_regionkey = region.r_regionkey)",                                                       +
                                                   "Plans": [                                                                                                      +
                                                     {                                                                                                             +
                                                       "Node Type": "Seq Scan",                                                                                    +
                                                       "Parent Relationship": "Outer",                                                                             +
                                                       "Parallel Aware": false,                                                                                    +
                                                       "Relation Name": "nation",                                                                                  +
                                                       "Alias": "nation",                                                                                          +
                                                       "Startup Cost": 0.00,                                                                                       +
                                                       "Total Cost": 1.25,                                                                                         +
                                                       "Plan Rows": 25,                                                                                            +
                                                       "Plan Width": 38                                                                                            +
                                                     },                                                                                                            +
                                                     {                                                                                                             +
                                                       "Node Type": "Hash",                                                                                        +
                                                       "Parent Relationship": "Inner",                                                                             +
                                                       "Parallel Aware": false,                                                                                    +
                                                       "Startup Cost": 1.06,                                                                                       +
                                                       "Total Cost": 1.06,                                                                                         +
                                                       "Plan Rows": 1,                                                                                             +
                                                       "Plan Width": 4,                                                                                            +
                                                       "Plans": [                                                                                                  +
                                                         {                                                                                                         +
                                                           "Node Type": "Seq Scan",                                                                                +
                                                           "Parent Relationship": "Outer",                                                                         +
                                                           "Parallel Aware": false,                                                                                +
                                                           "Relation Name": "region",                                                                              +
                                                           "Alias": "region",                                                                                      +
                                                           "Startup Cost": 0.00,                                                                                   +
                                                           "Total Cost": 1.06,                                                                                     +
                                                           "Plan Rows": 1,                                                                                         +
                                                           "Plan Width": 4,                                                                                        +
                                                           "Filter": "(r_name = 'AMERICA'::bpchar)"                                                                +
                                                         }                                                                                                         +
                                                       ]                                                                                                           +
                                                     }                                                                                                             +
                                                   ]                                                                                                               +
                                                 }                                                                                                                 +
                                               ]                                                                                                                   +
                                             }                                                                                                                     +
                                           ]                                                                                                                       +
                                         },                                                                                                                        +
                                         {                                                                                                                         +
                                           "Node Type": "Index Scan",                                                                                              +
                                           "Parent Relationship": "Inner",                                                                                         +
                                           "Parallel Aware": false,                                                                                                +
                                           "Scan Direction": "Forward",                                                                                            +
                                           "Index Name": "idx_orders_custkey",                                                                                     +
                                           "Relation Name": "orders",                                                                                              +
                                           "Alias": "orders",                                                                                                      +
                                           "Startup Cost": 0.43,                                                                                                   +
                                           "Total Cost": 1.66,                                                                                                     +
                                           "Plan Rows": 3,                                                                                                         +
                                           "Plan Width": 12,                                                                                                       +
                                           "Index Cond": "(o_custkey = customer.c_custkey)",                                                                       +
                                           "Filter": "((o_orderdate >= '1994-01-01'::date) AND (o_orderdate < '1995-01-01 00:00:00'::timestamp without time zone))"+
                                         }                                                                                                                         +
                                       ]                                                                                                                           +
                                     },                                                                                                                            +
                                     {                                                                                                                             +
                                       "Node Type": "Index Scan",                                                                                                  +
                                       "Parent Relationship": "Inner",                                                                                             +
                                       "Parallel Aware": false,                                                                                                    +
                                       "Scan Direction": "Forward",                                                                                                +
                                       "Index Name": "idx_lineitem_orderkey",                                                                                      +
                                       "Relation Name": "lineitem",                                                                                                +
                                       "Alias": "lineitem",                                                                                                        +
                                       "Startup Cost": 0.43,                                                                                                       +
                                       "Total Cost": 3.09,                                                                                                         +
                                       "Plan Rows": 17,                                                                                                            +
                                       "Plan Width": 28,                                                                                                           +
                                       "Index Cond": "(l_orderkey = orders.o_orderkey)"                                                                            +
                                     }                                                                                                                             +
                                   ]                                                                                                                               +
                                 },                                                                                                                                +
                                 {                                                                                                                                 +
                                   "Node Type": "Hash",                                                                                                            +
                                   "Parent Relationship": "Inner",                                                                                                 +
                                   "Parallel Aware": false,                                                                                                        +
                                   "Startup Cost": 330.00,                                                                                                         +
                                   "Total Cost": 330.00,                                                                                                           +
                                   "Plan Rows": 10000,                                                                                                             +
                                   "Plan Width": 12,                                                                                                               +
                                   "Plans": [                                                                                                                      +
                                     {                                                                                                                             +
                                       "Node Type": "Seq Scan",                                                                                                    +
                                       "Parent Relationship": "Outer",                                                                                             +
                                       "Parallel Aware": false,                                                                                                    +
                                       "Relation Name": "supplier",                                                                                                +
                                       "Alias": "supplier",                                                                                                        +
                                       "Startup Cost": 0.00,                                                                                                       +
                                       "Total Cost": 330.00,                                                                                                       +
                                       "Plan Rows": 10000,                                                                                                         +
                                       "Plan Width": 12                                                                                                            +
                                     }                                                                                                                             +
                                   ]                                                                                                                               +
                                 }                                                                                                                                 +
                               ]                                                                                                                                   +
                             }                                                                                                                                     +
                           ]                                                                                                                                       +
                         }                                                                                                                                         +
                       ]                                                                                                                                           +
                     }                                                                                                                                             +
                   ]                                                                                                                                               +
                 }                                                                                                                                                 +
               ]                                                                                                                                                   +
             }                                                                                                                                                     +
           ]                                                                                                                                                       +
         }                                                                                                                                                         +
       ]                                                                                                                                                           +
     }                                                                                                                                                             +
   }                                                                                                                                                               +
 ]
(1 row)

          n_name           |    revenue    
---------------------------+---------------
 PERU                      | 56206762.5035
(1 row)

QUERY PLAN                                                                                                            
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                                                                                              +
   {                                                                                                                                                                                                                            +
     "Plan": {                                                                                                                                                                                                                  +
       "Node Type": "Limit",                                                                                                                                                                                                    +
       "Parallel Aware": false,                                                                                                                                                                                                 +
       "Startup Cost": 179059.89,                                                                                                                                                                                               +
       "Total Cost": 179059.90,                                                                                                                                                                                                 +
       "Plan Rows": 1,                                                                                                                                                                                                          +
       "Plan Width": 32,                                                                                                                                                                                                        +
       "Plans": [                                                                                                                                                                                                               +
         {                                                                                                                                                                                                                      +
           "Node Type": "Aggregate",                                                                                                                                                                                            +
           "Strategy": "Plain",                                                                                                                                                                                                 +
           "Partial Mode": "Finalize",                                                                                                                                                                                          +
           "Parent Relationship": "Outer",                                                                                                                                                                                      +
           "Parallel Aware": false,                                                                                                                                                                                             +
           "Startup Cost": 179059.89,                                                                                                                                                                                           +
           "Total Cost": 179059.90,                                                                                                                                                                                             +
           "Plan Rows": 1,                                                                                                                                                                                                      +
           "Plan Width": 32,                                                                                                                                                                                                    +
           "Plans": [                                                                                                                                                                                                           +
             {                                                                                                                                                                                                                  +
               "Node Type": "Gather",                                                                                                                                                                                           +
               "Parent Relationship": "Outer",                                                                                                                                                                                  +
               "Parallel Aware": false,                                                                                                                                                                                         +
               "Startup Cost": 179059.67,                                                                                                                                                                                       +
               "Total Cost": 179059.88,                                                                                                                                                                                         +
               "Plan Rows": 2,                                                                                                                                                                                                  +
               "Plan Width": 32,                                                                                                                                                                                                +
               "Workers Planned": 2,                                                                                                                                                                                            +
               "Single Copy": false,                                                                                                                                                                                            +
               "Plans": [                                                                                                                                                                                                       +
                 {                                                                                                                                                                                                              +
                   "Node Type": "Aggregate",                                                                                                                                                                                    +
                   "Strategy": "Plain",                                                                                                                                                                                         +
                   "Partial Mode": "Partial",                                                                                                                                                                                   +
                   "Parent Relationship": "Outer",                                                                                                                                                                              +
                   "Parallel Aware": false,                                                                                                                                                                                     +
                   "Startup Cost": 178059.67,                                                                                                                                                                                   +
                   "Total Cost": 178059.68,                                                                                                                                                                                     +
                   "Plan Rows": 1,                                                                                                                                                                                              +
                   "Plan Width": 32,                                                                                                                                                                                            +
                   "Plans": [                                                                                                                                                                                                   +
                     {                                                                                                                                                                                                          +
                       "Node Type": "Seq Scan",                                                                                                                                                                                 +
                       "Parent Relationship": "Outer",                                                                                                                                                                          +
                       "Parallel Aware": true,                                                                                                                                                                                  +
                       "Relation Name": "lineitem",                                                                                                                                                                             +
                       "Alias": "lineitem",                                                                                                                                                                                     +
                       "Startup Cost": 0.00,                                                                                                                                                                                    +
                       "Total Cost": 177807.76,                                                                                                                                                                                 +
                       "Plan Rows": 50381,                                                                                                                                                                                      +
                       "Plan Width": 12,                                                                                                                                                                                        +
                       "Filter": "((l_shipdate >= '1994-01-01'::date) AND (l_shipdate < '1995-01-01 00:00:00'::timestamp without time zone) AND (l_discount >= 0.02) AND (l_discount <= 0.04) AND (l_quantity < '25'::numeric))"+
                     }                                                                                                                                                                                                          +
                   ]                                                                                                                                                                                                            +
                 }                                                                                                                                                                                                              +
               ]                                                                                                                                                                                                                +
             }                                                                                                                                                                                                                  +
           ]                                                                                                                                                                                                                    +
         }                                                                                                                                                                                                                      +
       ]                                                                                                                                                                                                                        +
     },                                                                                                                                                                                                                         +
     "JIT": {                                                                                                                                                                                                                   +
       "Worker Number": -1,                                                                                                                                                                                                     +
       "Functions": 8,                                                                                                                                                                                                          +
       "Options": {                                                                                                                                                                                                             +
         "Inlining": false,                                                                                                                                                                                                     +
         "Optimization": false,                                                                                                                                                                                                 +
         "Expressions": true,                                                                                                                                                                                                   +
         "Deforming": true                                                                                                                                                                                                      +
       }                                                                                                                                                                                                                        +
     }                                                                                                                                                                                                                          +
   }                                                                                                                                                                                                                            +
 ]
(1 row)

    revenue    
---------------
 67115958.8031
(1 row)

QUERY PLAN                                                                                         
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                                                         +
   {                                                                                                                                                                                       +
     "Plan": {                                                                                                                                                                             +
       "Node Type": "Limit",                                                                                                                                                               +
       "Parallel Aware": false,                                                                                                                                                            +
       "Startup Cost": 76731.30,                                                                                                                                                           +
       "Total Cost": 76731.43,                                                                                                                                                             +
       "Plan Rows": 1,                                                                                                                                                                     +
       "Plan Width": 92,                                                                                                                                                                   +
       "Plans": [                                                                                                                                                                          +
         {                                                                                                                                                                                 +
           "Node Type": "Aggregate",                                                                                                                                                       +
           "Strategy": "Sorted",                                                                                                                                                           +
           "Partial Mode": "Finalize",                                                                                                                                                     +
           "Parent Relationship": "Outer",                                                                                                                                                 +
           "Parallel Aware": false,                                                                                                                                                        +
           "Startup Cost": 76731.30,                                                                                                                                                       +
           "Total Cost": 77557.11,                                                                                                                                                         +
           "Plan Rows": 5955,                                                                                                                                                              +
           "Plan Width": 92,                                                                                                                                                               +
           "Group Key": ["n1.n_name", "n2.n_name", "(date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))"],                                                       +
           "Plans": [                                                                                                                                                                      +
             {                                                                                                                                                                             +
               "Node Type": "Gather Merge",                                                                                                                                                +
               "Parent Relationship": "Outer",                                                                                                                                             +
               "Parallel Aware": false,                                                                                                                                                    +
               "Startup Cost": 76731.30,                                                                                                                                                   +
               "Total Cost": 77390.87,                                                                                                                                                     +
               "Plan Rows": 4962,                                                                                                                                                          +
               "Plan Width": 92,                                                                                                                                                           +
               "Workers Planned": 2,                                                                                                                                                       +
               "Plans": [                                                                                                                                                                  +
                 {                                                                                                                                                                         +
                   "Node Type": "Aggregate",                                                                                                                                               +
                   "Strategy": "Sorted",                                                                                                                                                   +
                   "Partial Mode": "Partial",                                                                                                                                              +
                   "Parent Relationship": "Outer",                                                                                                                                         +
                   "Parallel Aware": false,                                                                                                                                                +
                   "Startup Cost": 75731.27,                                                                                                                                               +
                   "Total Cost": 75818.11,                                                                                                                                                 +
                   "Plan Rows": 2481,                                                                                                                                                      +
                   "Plan Width": 92,                                                                                                                                                       +
                   "Group Key": ["n1.n_name", "n2.n_name", "(date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))"],                                               +
                   "Plans": [                                                                                                                                                              +
                     {                                                                                                                                                                     +
                       "Node Type": "Sort",                                                                                                                                                +
                       "Parent Relationship": "Outer",                                                                                                                                     +
                       "Parallel Aware": false,                                                                                                                                            +
                       "Startup Cost": 75731.27,                                                                                                                                           +
                       "Total Cost": 75737.47,                                                                                                                                             +
                       "Plan Rows": 2481,                                                                                                                                                  +
                       "Plan Width": 72,                                                                                                                                                   +
                       "Sort Key": ["n1.n_name", "n2.n_name", "(date_part('year'::text, (lineitem.l_shipdate)::timestamp without time zone))"],                                            +
                       "Plans": [                                                                                                                                                          +
                         {                                                                                                                                                                 +
                           "Node Type": "Hash Join",                                                                                                                                       +
                           "Parent Relationship": "Outer",                                                                                                                                 +
                           "Parallel Aware": false,                                                                                                                                        +
                           "Join Type": "Inner",                                                                                                                                           +
                           "Startup Cost": 374.36,                                                                                                                                         +
                           "Total Cost": 75591.38,                                                                                                                                         +
                           "Plan Rows": 2481,                                                                                                                                              +
                           "Plan Width": 72,                                                                                                                                               +
                           "Inner Unique": false,                                                                                                                                          +
                           "Hash Cond": "(lineitem.l_suppkey = supplier.s_suppkey)",                                                                                                       +
                           "Join Filter": "(((n1.n_name = 'CANADA'::bpchar) AND (n2.n_name = 'ROMANIA'::bpchar)) OR ((n1.n_name = 'ROMANIA'::bpchar) AND (n2.n_name = 'CANADA'::bpchar)))",+
                           "Plans": [                                                                                                                                                      +
                             {                                                                                                                                                             +
                               "Node Type": "Nested Loop",                                                                                                                                 +
                               "Parent Relationship": "Outer",                                                                                                                             +
                               "Parallel Aware": false,                                                                                                                                    +
                               "Join Type": "Inner",                                                                                                                                       +
                               "Startup Cost": 2.26,                                                                                                                                       +
                               "Total Cost": 74886.74,                                                                                                                                     +
                               "Plan Rows": 59930,                                                                                                                                         +
                               "Plan Width": 50,                                                                                                                                           +
                               "Inner Unique": false,                                                                                                                                      +
                               "Plans": [                                                                                                                                                  +
                                 {                                                                                                                                                         +
                                   "Node Type": "Nested Loop",                                                                                                                             +
                                   "Parent Relationship": "Outer",                                                                                                                         +
                                   "Parallel Aware": false,                                                                                                                                +
                                   "Join Type": "Inner",                                                                                                                                   +
                                   "Startup Cost": 1.83,                                                                                                                                   +
                                   "Total Cost": 13234.08,                                                                                                                                 +
                                   "Plan Rows": 50000,                                                                                                                                     +
                                   "Plan Width": 30,                                                                                                                                       +
                                   "Inner Unique": false,                                                                                                                                  +
                                   "Plans": [                                                                                                                                              +
                                     {                                                                                                                                                     +
                                       "Node Type": "Hash Join",                                                                                                                           +
                                       "Parent Relationship": "Outer",                                                                                                                     +
                                       "Parallel Aware": false,                                                                                                                            +
                                       "Join Type": "Inner",                                                                                                                               +
                                       "Startup Cost": 1.40,                                                                                                                               +
                                       "Total Cost": 4526.27,                                                                                                                              +
                                       "Plan Rows": 5000,                                                                                                                                  +
                                       "Plan Width": 30,                                                                                                                                   +
                                       "Inner Unique": true,                                                                                                                               +
                                       "Hash Cond": "(customer.c_nationkey = n2.n_nationkey)",                                                                                             +
                                       "Plans": [                                                                                                                                          +
                                         {                                                                                                                                                 +
                                           "Node Type": "Seq Scan",                                                                                                                        +
                                           "Parent Relationship": "Outer",                                                                                                                 +
                                           "Parallel Aware": true,                                                                                                                         +
                                           "Relation Name": "customer",                                                                                                                    +
                                           "Alias": "customer",                                                                                                                            +
                                           "Startup Cost": 0.00,                                                                                                                           +
                                           "Total Cost": 4333.00,                                                                                                                          +
                                           "Plan Rows": 62500,                                                                                                                             +
                                           "Plan Width": 12                                                                                                                                +
                                         },                                                                                                                                                +
                                         {                                                                                                                                                 +
                                           "Node Type": "Hash",                                                                                                                            +
                                           "Parent Relationship": "Inner",                                                                                                                 +
                                           "Parallel Aware": false,                                                                                                                        +
                                           "Startup Cost": 1.38,                                                                                                                           +
                                           "Total Cost": 1.38,                                                                                                                             +
                                           "Plan Rows": 2,                                                                                                                                 +
                                           "Plan Width": 30,                                                                                                                               +
                                           "Plans": [                                                                                                                                      +
                                             {                                                                                                                                             +
                                               "Node Type": "Seq Scan",                                                                                                                    +
                                               "Parent Relationship": "Outer",                                                                                                             +
                                               "Parallel Aware": false,                                                                                                                    +
                                               "Relation Name": "nation",                                                                                                                  +
                                               "Alias": "n2",                                                                                                                              +
                                               "Startup Cost": 0.00,                                                                                                                       +
                                               "Total Cost": 1.38,                                                                                                                         +
                                               "Plan Rows": 2,                                                                                                                             +
                                               "Plan Width": 30,                                                                                                                           +
                                               "Filter": "((n_name = 'ROMANIA'::bpchar) OR (n_name = 'CANADA'::bpchar))"                                                                   +
                                             }                                                                                                                                             +
                                           ]                                                                                                                                               +
                                         }                                                                                                                                                 +
                                       ]                                                                                                                                                   +
                                     },                                                                                                                                                    +
                                     {                                                                                                                                                     +
                                       "Node Type": "Index Scan",                                                                                                                          +
                                       "Parent Relationship": "Inner",                                                                                                                     +
                                       "Parallel Aware": false,                                                                                                                            +
                                       "Scan Direction": "Forward",                                                                                                                        +
                                       "Index Name": "idx_orders_custkey",                                                                                                                 +
                                       "Relation Name": "orders",                                                                                                                          +
                                       "Alias": "orders",                                                                                                                                  +
                                       "Startup Cost": 0.43,                                                                                                                               +
                                       "Total Cost": 1.57,                                                                                                                                 +
                                       "Plan Rows": 17,                                                                                                                                    +
                                       "Plan Width": 12,                                                                                                                                   +
                                       "Index Cond": "(o_custkey = customer.c_custkey)"                                                                                                    +
                                     }                                                                                                                                                     +
                                   ]                                                                                                                                                       +
                                 },                                                                                                                                                        +
                                 {                                                                                                                                                         +
                                   "Node Type": "Index Scan",                                                                                                                              +
                                   "Parent Relationship": "Inner",                                                                                                                         +
                                   "Parallel Aware": false,                                                                                                                                +
                                   "Scan Direction": "Forward",                                                                                                                            +
                                   "Index Name": "idx_lineitem_orderkey",                                                                                                                  +
                                   "Relation Name": "lineitem",                                                                                                                            +
                                   "Alias": "lineitem",                                                                                                                                    +
                                   "Startup Cost": 0.43,                                                                                                                                   +
                                   "Total Cost": 1.18,                                                                                                                                     +
                                   "Plan Rows": 5,                                                                                                                                         +
                                   "Plan Width": 32,                                                                                                                                       +
                                   "Index Cond": "(l_orderkey = orders.o_orderkey)",                                                                                                       +
                                   "Filter": "((l_shipdate >= '1995-01-01'::date) AND (l_shipdate <= '1996-12-31'::date))"                                                                 +
                                 }                                                                                                                                                         +
                               ]                                                                                                                                                           +
                             },                                                                                                                                                            +
                             {                                                                                                                                                             +
                               "Node Type": "Hash",                                                                                                                                        +
                               "Parent Relationship": "Inner",                                                                                                                             +
                               "Parallel Aware": false,                                                                                                                                    +
                               "Startup Cost": 362.10,                                                                                                                                     +
                               "Total Cost": 362.10,                                                                                                                                       +
                               "Plan Rows": 800,                                                                                                                                           +
                               "Plan Width": 30,                                                                                                                                           +
                               "Plans": [                                                                                                                                                  +
                                 {                                                                                                                                                         +
                                   "Node Type": "Hash Join",                                                                                                                               +
                                   "Parent Relationship": "Outer",                                                                                                                         +
                                   "Parallel Aware": false,                                                                                                                                +
                                   "Join Type": "Inner",                                                                                                                                   +
                                   "Startup Cost": 1.40,                                                                                                                                   +
                                   "Total Cost": 362.10,                                                                                                                                   +
                                   "Plan Rows": 800,                                                                                                                                       +
                                   "Plan Width": 30,                                                                                                                                       +
                                   "Inner Unique": true,                                                                                                                                   +
                                   "Hash Cond": "(supplier.s_nationkey = n1.n_nationkey)",                                                                                                 +
                                   "Plans": [                                                                                                                                              +
                                     {                                                                                                                                                     +
                                       "Node Type": "Seq Scan",                                                                                                                            +
                                       "Parent Relationship": "Outer",                                                                                                                     +
                                       "Parallel Aware": false,                                                                                                                            +
                                       "Relation Name": "supplier",                                                                                                                        +
                                       "Alias": "supplier",                                                                                                                                +
                                       "Startup Cost": 0.00,                                                                                                                               +
                                       "Total Cost": 330.00,                                                                                                                               +
                                       "Plan Rows": 10000,                                                                                                                                 +
                                       "Plan Width": 12                                                                                                                                    +
                                     },                                                                                                                                                    +
                                     {                                                                                                                                                     +
                                       "Node Type": "Hash",                                                                                                                                +
                                       "Parent Relationship": "Inner",                                                                                                                     +
                                       "Parallel Aware": false,                                                                                                                            +
                                       "Startup Cost": 1.38,                                                                                                                               +
                                       "Total Cost": 1.38,                                                                                                                                 +
                                       "Plan Rows": 2,                                                                                                                                     +
                                       "Plan Width": 30,                                                                                                                                   +
                                       "Plans": [                                                                                                                                          +
                                         {                                                                                                                                                 +
                                           "Node Type": "Seq Scan",                                                                                                                        +
                                           "Parent Relationship": "Outer",                                                                                                                 +
                                           "Parallel Aware": false,                                                                                                                        +
                                           "Relation Name": "nation",                                                                                                                      +
                                           "Alias": "n1",                                                                                                                                  +
                                           "Startup Cost": 0.00,                                                                                                                           +
                                           "Total Cost": 1.38,                                                                                                                             +
                                           "Plan Rows": 2,                                                                                                                                 +
                                           "Plan Width": 30,                                                                                                                               +
                                           "Filter": "((n_name = 'CANADA'::bpchar) OR (n_name = 'ROMANIA'::bpchar))"                                                                       +
                                         }                                                                                                                                                 +
                                       ]                                                                                                                                                   +
                                     }                                                                                                                                                     +
                                   ]                                                                                                                                                       +
                                 }                                                                                                                                                         +
                               ]                                                                                                                                                           +
                             }                                                                                                                                                             +
                           ]                                                                                                                                                               +
                         }                                                                                                                                                                 +
                       ]                                                                                                                                                                   +
                     }                                                                                                                                                                     +
                   ]                                                                                                                                                                       +
                 }                                                                                                                                                                         +
               ]                                                                                                                                                                           +
             }                                                                                                                                                                             +
           ]                                                                                                                                                                               +
         }                                                                                                                                                                                 +
       ]                                                                                                                                                                                   +
     }                                                                                                                                                                                     +
   }                                                                                                                                                                                       +
 ]
(1 row)

        supp_nation        |        cust_nation        | l_year |    revenue    
---------------------------+---------------------------+--------+---------------
 CANADA                    | ROMANIA                   |   1995 | 56247832.4594
(1 row)

QUERY PLAN                                                              
-------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                  +
   {                                                                                                                                +
     "Plan": {                                                                                                                      +
       "Node Type": "Limit",                                                                                                        +
       "Parallel Aware": false,                                                                                                     +
       "Startup Cost": 19172.28,                                                                                                    +
       "Total Cost": 19172.32,                                                                                                      +
       "Plan Rows": 1,                                                                                                              +
       "Plan Width": 40,                                                                                                            +
       "Plans": [                                                                                                                   +
         {                                                                                                                          +
           "Node Type": "Aggregate",                                                                                                +
           "Strategy": "Sorted",                                                                                                    +
           "Partial Mode": "Simple",                                                                                                +
           "Parent Relationship": "Outer",                                                                                          +
           "Parallel Aware": false,                                                                                                 +
           "Startup Cost": 19172.28,                                                                                                +
           "Total Cost": 19182.76,                                                                                                  +
           "Plan Rows": 233,                                                                                                        +
           "Plan Width": 40,                                                                                                        +
           "Group Key": ["(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))"],                           +
           "Plans": [                                                                                                               +
             {                                                                                                                      +
               "Node Type": "Sort",                                                                                                 +
               "Parent Relationship": "Outer",                                                                                      +
               "Parallel Aware": false,                                                                                             +
               "Startup Cost": 19172.28,                                                                                            +
               "Total Cost": 19172.86,                                                                                              +
               "Plan Rows": 233,                                                                                                    +
               "Plan Width": 46,                                                                                                    +
               "Sort Key": ["(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))"],                        +
               "Plans": [                                                                                                           +
                 {                                                                                                                  +
                   "Node Type": "Nested Loop",                                                                                      +
                   "Parent Relationship": "Outer",                                                                                  +
                   "Parallel Aware": false,                                                                                         +
                   "Join Type": "Inner",                                                                                            +
                   "Startup Cost": 1.56,                                                                                            +
                   "Total Cost": 19163.12,                                                                                          +
                   "Plan Rows": 233,                                                                                                +
                   "Plan Width": 46,                                                                                                +
                   "Inner Unique": true,                                                                                            +
                   "Join Filter": "(supplier.s_nationkey = n2.n_nationkey)",                                                        +
                   "Plans": [                                                                                                       +
                     {                                                                                                              +
                       "Node Type": "Nested Loop",                                                                                  +
                       "Parent Relationship": "Outer",                                                                              +
                       "Parallel Aware": false,                                                                                     +
                       "Join Type": "Inner",                                                                                        +
                       "Startup Cost": 1.56,                                                                                        +
                       "Total Cost": 19076.38,                                                                                      +
                       "Plan Rows": 233,                                                                                            +
                       "Plan Width": 24,                                                                                            +
                       "Inner Unique": true,                                                                                        +
                       "Plans": [                                                                                                   +
                         {                                                                                                          +
                           "Node Type": "Nested Loop",                                                                              +
                           "Parent Relationship": "Outer",                                                                          +
                           "Parallel Aware": false,                                                                                 +
                           "Join Type": "Inner",                                                                                    +
                           "Startup Cost": 1.28,                                                                                    +
                           "Total Cost": 19005.55,                                                                                  +
                           "Plan Rows": 234,                                                                                        +
                           "Plan Width": 24,                                                                                        +
                           "Inner Unique": false,                                                                                   +
                           "Join Filter": "(n1.n_nationkey = customer.c_nationkey)",                                                +
                           "Plans": [                                                                                               +
                             {                                                                                                      +
                               "Node Type": "Nested Loop",                                                                          +
                               "Parent Relationship": "Outer",                                                                      +
                               "Parallel Aware": false,                                                                             +
                               "Join Type": "Inner",                                                                                +
                               "Startup Cost": 0.00,                                                                                +
                               "Total Cost": 2.62,                                                                                  +
                               "Plan Rows": 5,                                                                                      +
                               "Plan Width": 4,                                                                                     +
                               "Inner Unique": false,                                                                               +
                               "Join Filter": "(n1.n_regionkey = region.r_regionkey)",                                              +
                               "Plans": [                                                                                           +
                                 {                                                                                                  +
                                   "Node Type": "Seq Scan",                                                                         +
                                   "Parent Relationship": "Outer",                                                                  +
                                   "Parallel Aware": false,                                                                         +
                                   "Relation Name": "region",                                                                       +
                                   "Alias": "region",                                                                               +
                                   "Startup Cost": 0.00,                                                                            +
                                   "Total Cost": 1.06,                                                                              +
                                   "Plan Rows": 1,                                                                                  +
                                   "Plan Width": 4,                                                                                 +
                                   "Filter": "(r_name = 'EUROPE'::bpchar)"                                                          +
                                 },                                                                                                 +
                                 {                                                                                                  +
                                   "Node Type": "Seq Scan",                                                                         +
                                   "Parent Relationship": "Inner",                                                                  +
                                   "Parallel Aware": false,                                                                         +
                                   "Relation Name": "nation",                                                                       +
                                   "Alias": "n1",                                                                                   +
                                   "Startup Cost": 0.00,                                                                            +
                                   "Total Cost": 1.25,                                                                              +
                                   "Plan Rows": 25,                                                                                 +
                                   "Plan Width": 12                                                                                 +
                                 }                                                                                                  +
                               ]                                                                                                    +
                             },                                                                                                     +
                             {                                                                                                      +
                               "Node Type": "Materialize",                                                                          +
                               "Parent Relationship": "Inner",                                                                      +
                               "Parallel Aware": false,                                                                             +
                               "Startup Cost": 1.28,                                                                                +
                               "Total Cost": 18917.96,                                                                              +
                               "Plan Rows": 1172,                                                                                   +
                               "Plan Width": 32,                                                                                    +
                               "Plans": [                                                                                           +
                                 {                                                                                                  +
                                   "Node Type": "Nested Loop",                                                                      +
                                   "Parent Relationship": "Outer",                                                                  +
                                   "Parallel Aware": false,                                                                         +
                                   "Join Type": "Inner",                                                                            +
                                   "Startup Cost": 1.28,                                                                            +
                                   "Total Cost": 18912.10,                                                                          +
                                   "Plan Rows": 1172,                                                                               +
                                   "Plan Width": 32,                                                                                +
                                   "Inner Unique": true,                                                                            +
                                   "Plans": [                                                                                       +
                                     {                                                                                              +
                                       "Node Type": "Nested Loop",                                                                  +
                                       "Parent Relationship": "Outer",                                                              +
                                       "Parallel Aware": false,                                                                     +
                                       "Join Type": "Inner",                                                                        +
                                       "Startup Cost": 0.86,                                                                        +
                                       "Total Cost": 18357.21,                                                                      +
                                       "Plan Rows": 1172,                                                                           +
                                       "Plan Width": 32,                                                                            +
                                       "Inner Unique": true,                                                                        +
                                       "Plans": [                                                                                   +
                                         {                                                                                          +
                                           "Node Type": "Nested Loop",                                                              +
                                           "Parent Relationship": "Outer",                                                          +
                                           "Parallel Aware": false,                                                                 +
                                           "Join Type": "Inner",                                                                    +
                                           "Startup Cost": 0.43,                                                                    +
                                           "Total Cost": 16550.80,                                                                  +
                                           "Plan Rows": 3834,                                                                       +
                                           "Plan Width": 28,                                                                        +
                                           "Inner Unique": false,                                                                   +
                                           "Plans": [                                                                               +
                                             {                                                                                      +
                                               "Node Type": "Seq Scan",                                                             +
                                               "Parent Relationship": "Outer",                                                      +
                                               "Parallel Aware": false,                                                             +
                                               "Relation Name": "part",                                                             +
                                               "Alias": "part",                                                                     +
                                               "Startup Cost": 0.00,                                                                +
                                               "Total Cost": 660.00,                                                                +
                                               "Plan Rows": 121,                                                                    +
                                               "Plan Width": 4,                                                                     +
                                               "Filter": "((p_type)::text = 'LARGE BRUSHED COPPER'::text)"                          +
                                             },                                                                                     +
                                             {                                                                                      +
                                               "Node Type": "Index Scan",                                                           +
                                               "Parent Relationship": "Inner",                                                      +
                                               "Parallel Aware": false,                                                             +
                                               "Scan Direction": "Forward",                                                         +
                                               "Index Name": "idx_lineitem_part_supp",                                              +
                                               "Relation Name": "lineitem",                                                         +
                                               "Alias": "lineitem",                                                                 +
                                               "Startup Cost": 0.43,                                                                +
                                               "Total Cost": 131.01,                                                                +
                                               "Plan Rows": 32,                                                                     +
                                               "Plan Width": 36,                                                                    +
                                               "Index Cond": "(l_partkey = part.p_partkey)"                                         +
                                             }                                                                                      +
                                           ]                                                                                        +
                                         },                                                                                         +
                                         {                                                                                          +
                                           "Node Type": "Index Scan",                                                               +
                                           "Parent Relationship": "Inner",                                                          +
                                           "Parallel Aware": false,                                                                 +
                                           "Scan Direction": "Forward",                                                             +
                                           "Index Name": "orders_pkey",                                                             +
                                           "Relation Name": "orders",                                                               +
                                           "Alias": "orders",                                                                       +
                                           "Startup Cost": 0.43,                                                                    +
                                           "Total Cost": 0.47,                                                                      +
                                           "Plan Rows": 1,                                                                          +
                                           "Plan Width": 16,                                                                        +
                                           "Index Cond": "(o_orderkey = lineitem.l_orderkey)",                                      +
                                           "Filter": "((o_orderdate >= '1995-01-01'::date) AND (o_orderdate <= '1996-12-31'::date))"+
                                         }                                                                                          +
                                       ]                                                                                            +
                                     },                                                                                             +
                                     {                                                                                              +
                                       "Node Type": "Index Scan",                                                                   +
                                       "Parent Relationship": "Inner",                                                              +
                                       "Parallel Aware": false,                                                                     +
                                       "Scan Direction": "Forward",                                                                 +
                                       "Index Name": "customer_pkey",                                                               +
                                       "Relation Name": "customer",                                                                 +
                                       "Alias": "customer",                                                                         +
                                       "Startup Cost": 0.42,                                                                        +
                                       "Total Cost": 0.47,                                                                          +
                                       "Plan Rows": 1,                                                                              +
                                       "Plan Width": 12,                                                                            +
                                       "Index Cond": "(c_custkey = orders.o_custkey)"                                               +
                                     }                                                                                              +
                                   ]                                                                                                +
                                 }                                                                                                  +
                               ]                                                                                                    +
                             }                                                                                                      +
                           ]                                                                                                        +
                         },                                                                                                         +
                         {                                                                                                          +
                           "Node Type": "Index Scan",                                                                               +
                           "Parent Relationship": "Inner",                                                                          +
                           "Parallel Aware": false,                                                                                 +
                           "Scan Direction": "Forward",                                                                             +
                           "Index Name": "supplier_pkey",                                                                           +
                           "Relation Name": "supplier",                                                                             +
                           "Alias": "supplier",                                                                                     +
                           "Startup Cost": 0.29,                                                                                    +
                           "Total Cost": 0.30,                                                                                      +
                           "Plan Rows": 1,                                                                                          +
                           "Plan Width": 12,                                                                                        +
                           "Index Cond": "(s_suppkey = lineitem.l_suppkey)"                                                         +
                         }                                                                                                          +
                       ]                                                                                                            +
                     },                                                                                                             +
                     {                                                                                                              +
                       "Node Type": "Materialize",                                                                                  +
                       "Parent Relationship": "Inner",                                                                              +
                       "Parallel Aware": false,                                                                                     +
                       "Startup Cost": 0.00,                                                                                        +
                       "Total Cost": 1.38,                                                                                          +
                       "Plan Rows": 25,                                                                                             +
                       "Plan Width": 30,                                                                                            +
                       "Plans": [                                                                                                   +
                         {                                                                                                          +
                           "Node Type": "Seq Scan",                                                                                 +
                           "Parent Relationship": "Outer",                                                                          +
                           "Parallel Aware": false,                                                                                 +
                           "Relation Name": "nation",                                                                               +
                           "Alias": "n2",                                                                                           +
                           "Startup Cost": 0.00,                                                                                    +
                           "Total Cost": 1.25,                                                                                      +
                           "Plan Rows": 25,                                                                                         +
                           "Plan Width": 30                                                                                         +
                         }                                                                                                          +
                       ]                                                                                                            +
                     }                                                                                                              +
                   ]                                                                                                                +
                 }                                                                                                                  +
               ]                                                                                                                    +
             }                                                                                                                      +
           ]                                                                                                                        +
         }                                                                                                                          +
       ]                                                                                                                            +
     }                                                                                                                              +
   }                                                                                                                                +
 ]
(1 row)

 o_year |       mkt_share        
--------+------------------------
   1995 | 0.02121528063030216607
(1 row)

QUERY PLAN                                                                 
-------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                        +
   {                                                                                                                                      +
     "Plan": {                                                                                                                            +
       "Node Type": "Limit",                                                                                                              +
       "Parallel Aware": false,                                                                                                           +
       "Startup Cost": 9100.65,                                                                                                           +
       "Total Cost": 9100.78,                                                                                                             +
       "Plan Rows": 1,                                                                                                                    +
       "Plan Width": 66,                                                                                                                  +
       "Plans": [                                                                                                                         +
         {                                                                                                                                +
           "Node Type": "Aggregate",                                                                                                      +
           "Strategy": "Sorted",                                                                                                          +
           "Partial Mode": "Finalize",                                                                                                    +
           "Parent Relationship": "Outer",                                                                                                +
           "Parallel Aware": false,                                                                                                       +
           "Startup Cost": 9100.65,                                                                                                       +
           "Total Cost": 10853.49,                                                                                                        +
           "Plan Rows": 12735,                                                                                                            +
           "Plan Width": 66,                                                                                                              +
           "Group Key": ["nation.n_name", "(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))"],                +
           "Plans": [                                                                                                                     +
             {                                                                                                                            +
               "Node Type": "Gather Merge",                                                                                               +
               "Parent Relationship": "Outer",                                                                                            +
               "Parallel Aware": false,                                                                                                   +
               "Startup Cost": 9100.65,                                                                                                   +
               "Total Cost": 10524.51,                                                                                                    +
               "Plan Rows": 10612,                                                                                                        +
               "Plan Width": 66,                                                                                                          +
               "Workers Planned": 2,                                                                                                      +
               "Plans": [                                                                                                                 +
                 {                                                                                                                        +
                   "Node Type": "Aggregate",                                                                                              +
                   "Strategy": "Sorted",                                                                                                  +
                   "Partial Mode": "Partial",                                                                                             +
                   "Parent Relationship": "Outer",                                                                                        +
                   "Parallel Aware": false,                                                                                               +
                   "Startup Cost": 8100.62,                                                                                               +
                   "Total Cost": 8299.60,                                                                                                 +
                   "Plan Rows": 5306,                                                                                                     +
                   "Plan Width": 66,                                                                                                      +
                   "Group Key": ["nation.n_name", "(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone))"],        +
                   "Plans": [                                                                                                             +
                     {                                                                                                                    +
                       "Node Type": "Sort",                                                                                               +
                       "Parent Relationship": "Outer",                                                                                    +
                       "Parallel Aware": false,                                                                                           +
                       "Startup Cost": 8100.62,                                                                                           +
                       "Total Cost": 8113.89,                                                                                             +
                       "Plan Rows": 5306,                                                                                                 +
                       "Plan Width": 57,                                                                                                  +
                       "Sort Key": ["nation.n_name", "(date_part('year'::text, (orders.o_orderdate)::timestamp without time zone)) DESC"],+
                       "Plans": [                                                                                                         +
                         {                                                                                                                +
                           "Node Type": "Hash Join",                                                                                      +
                           "Parent Relationship": "Outer",                                                                                +
                           "Parallel Aware": false,                                                                                       +
                           "Join Type": "Inner",                                                                                          +
                           "Startup Cost": 680.62,                                                                                        +
                           "Total Cost": 7772.36,                                                                                         +
                           "Plan Rows": 5306,                                                                                             +
                           "Plan Width": 57,                                                                                              +
                           "Inner Unique": true,                                                                                          +
                           "Hash Cond": "(supplier.s_nationkey = nation.n_nationkey)",                                                    +
                           "Plans": [                                                                                                     +
                             {                                                                                                            +
                               "Node Type": "Nested Loop",                                                                                +
                               "Parent Relationship": "Outer",                                                                            +
                               "Parallel Aware": false,                                                                                   +
                               "Join Type": "Inner",                                                                                      +
                               "Startup Cost": 679.06,                                                                                    +
                               "Total Cost": 7727.98,                                                                                     +
                               "Plan Rows": 5306,                                                                                         +
                               "Plan Width": 35,                                                                                          +
                               "Inner Unique": true,                                                                                      +
                               "Plans": [                                                                                                 +
                                 {                                                                                                        +
                                   "Node Type": "Nested Loop",                                                                            +
                                   "Parent Relationship": "Outer",                                                                        +
                                   "Parallel Aware": false,                                                                               +
                                   "Join Type": "Inner",                                                                                  +
                                   "Startup Cost": 678.63,                                                                                +
                                   "Total Cost": 5254.55,                                                                                 +
                                   "Plan Rows": 5306,                                                                                     +
                                   "Plan Width": 39,                                                                                      +
                                   "Inner Unique": false,                                                                                 +
                                   "Join Filter": "(supplier.s_suppkey = lineitem.l_suppkey)",                                            +
                                   "Plans": [                                                                                             +
                                     {                                                                                                    +
                                       "Node Type": "Nested Loop",                                                                        +
                                       "Parent Relationship": "Outer",                                                                    +
                                       "Parallel Aware": false,                                                                           +
                                       "Join Type": "Inner",                                                                              +
                                       "Startup Cost": 678.20,                                                                            +
                                       "Total Cost": 4453.57,                                                                             +
                                       "Plan Rows": 674,                                                                                  +
                                       "Plan Width": 38,                                                                                  +
                                       "Inner Unique": true,                                                                              +
                                       "Plans": [                                                                                         +
                                         {                                                                                                +
                                           "Node Type": "Merge Join",                                                                     +
                                           "Parent Relationship": "Outer",                                                                +
                                           "Parallel Aware": false,                                                                       +
                                           "Join Type": "Inner",                                                                          +
                                           "Startup Cost": 677.91,                                                                        +
                                           "Total Cost": 4248.81,                                                                         +
                                           "Plan Rows": 674,                                                                              +
                                           "Plan Width": 26,                                                                              +
                                           "Inner Unique": true,                                                                          +
                                           "Merge Cond": "(partsupp.ps_partkey = part.p_partkey)",                                        +
                                           "Plans": [                                                                                     +
                                             {                                                                                            +
                                               "Node Type": "Index Scan",                                                                 +
                                               "Parent Relationship": "Outer",                                                            +
                                               "Parallel Aware": true,                                                                    +
                                               "Scan Direction": "Forward",                                                               +
                                               "Index Name": "idx_partsupp_partkey",                                                      +
                                               "Relation Name": "partsupp",                                                               +
                                               "Alias": "partsupp",                                                                       +
                                               "Startup Cost": 0.42,                                                                      +
                                               "Total Cost": 34465.76,                                                                    +
                                               "Plan Rows": 333333,                                                                       +
                                               "Plan Width": 22                                                                           +
                                             },                                                                                           +
                                             {                                                                                            +
                                               "Node Type": "Sort",                                                                       +
                                               "Parent Relationship": "Inner",                                                            +
                                               "Parallel Aware": false,                                                                   +
                                               "Startup Cost": 677.49,                                                                    +
                                               "Total Cost": 678.50,                                                                      +
                                               "Plan Rows": 404,                                                                          +
                                               "Plan Width": 4,                                                                           +
                                               "Sort Key": ["part.p_partkey"],                                                            +
                                               "Plans": [                                                                                 +
                                                 {                                                                                        +
                                                   "Node Type": "Seq Scan",                                                               +
                                                   "Parent Relationship": "Outer",                                                        +
                                                   "Parallel Aware": false,                                                               +
                                                   "Relation Name": "part",                                                               +
                                                   "Alias": "part",                                                                       +
                                                   "Startup Cost": 0.00,                                                                  +
                                                   "Total Cost": 660.00,                                                                  +
                                                   "Plan Rows": 404,                                                                      +
                                                   "Plan Width": 4,                                                                       +
                                                   "Filter": "((p_name)::text ~~ '%papaya%'::text)"                                       +
                                                 }                                                                                        +
                                               ]                                                                                          +
                                             }                                                                                            +
                                           ]                                                                                              +
                                         },                                                                                               +
                                         {                                                                                                +
                                           "Node Type": "Index Scan",                                                                     +
                                           "Parent Relationship": "Inner",                                                                +
                                           "Parallel Aware": false,                                                                       +
                                           "Scan Direction": "Forward",                                                                   +
                                           "Index Name": "supplier_pkey",                                                                 +
                                           "Relation Name": "supplier",                                                                   +
                                           "Alias": "supplier",                                                                           +
                                           "Startup Cost": 0.29,                                                                          +
                                           "Total Cost": 0.30,                                                                            +
                                           "Plan Rows": 1,                                                                                +
                                           "Plan Width": 12,                                                                              +
                                           "Index Cond": "(s_suppkey = partsupp.ps_suppkey)"                                              +
                                         }                                                                                                +
                                       ]                                                                                                  +
                                     },                                                                                                   +
                                     {                                                                                                    +
                                       "Node Type": "Index Scan",                                                                         +
                                       "Parent Relationship": "Inner",                                                                    +
                                       "Parallel Aware": false,                                                                           +
                                       "Scan Direction": "Forward",                                                                       +
                                       "Index Name": "idx_lineitem_part_supp",                                                            +
                                       "Relation Name": "lineitem",                                                                       +
                                       "Alias": "lineitem",                                                                               +
                                       "Startup Cost": 0.43,                                                                              +
                                       "Total Cost": 1.18,                                                                                +
                                       "Plan Rows": 1,                                                                                    +
                                       "Plan Width": 41,                                                                                  +
                                       "Index Cond": "((l_partkey = partsupp.ps_partkey) AND (l_suppkey = partsupp.ps_suppkey))"          +
                                     }                                                                                                    +
                                   ]                                                                                                      +
                                 },                                                                                                       +
                                 {                                                                                                        +
                                   "Node Type": "Index Scan",                                                                             +
                                   "Parent Relationship": "Inner",                                                                        +
                                   "Parallel Aware": false,                                                                               +
                                   "Scan Direction": "Forward",                                                                           +
                                   "Index Name": "orders_pkey",                                                                           +
                                   "Relation Name": "orders",                                                                             +
                                   "Alias": "orders",                                                                                     +
                                   "Startup Cost": 0.43,                                                                                  +
                                   "Total Cost": 0.47,                                                                                    +
                                   "Plan Rows": 1,                                                                                        +
                                   "Plan Width": 8,                                                                                       +
                                   "Index Cond": "(o_orderkey = lineitem.l_orderkey)"                                                     +
                                 }                                                                                                        +
                               ]                                                                                                          +
                             },                                                                                                           +
                             {                                                                                                            +
                               "Node Type": "Hash",                                                                                       +
                               "Parent Relationship": "Inner",                                                                            +
                               "Parallel Aware": false,                                                                                   +
                               "Startup Cost": 1.25,                                                                                      +
                               "Total Cost": 1.25,                                                                                        +
                               "Plan Rows": 25,                                                                                           +
                               "Plan Width": 30,                                                                                          +
                               "Plans": [                                                                                                 +
                                 {                                                                                                        +
                                   "Node Type": "Seq Scan",                                                                               +
                                   "Parent Relationship": "Outer",                                                                        +
                                   "Parallel Aware": false,                                                                               +
                                   "Relation Name": "nation",                                                                             +
                                   "Alias": "nation",                                                                                     +
                                   "Startup Cost": 0.00,                                                                                  +
                                   "Total Cost": 1.25,                                                                                    +
                                   "Plan Rows": 25,                                                                                       +
                                   "Plan Width": 30                                                                                       +
                                 }                                                                                                        +
                               ]                                                                                                          +
                             }                                                                                                            +
                           ]                                                                                                              +
                         }                                                                                                                +
                       ]                                                                                                                  +
                     }                                                                                                                    +
                   ]                                                                                                                      +
                 }                                                                                                                        +
               ]                                                                                                                          +
             }                                                                                                                            +
           ]                                                                                                                              +
         }                                                                                                                                +
       ]                                                                                                                                  +
     }                                                                                                                                    +
   }                                                                                                                                      +
 ]
(1 row)

          nation           | o_year |  sum_profit  
---------------------------+--------+--------------
 ALGERIA                   |   1998 | 2938913.9922
(1 row)

QUERY PLAN                                                                                   
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                                             +
   {                                                                                                                                                                           +
     "Plan": {                                                                                                                                                                 +
       "Node Type": "Limit",                                                                                                                                                   +
       "Parallel Aware": false,                                                                                                                                                +
       "Startup Cost": 170632.19,                                                                                                                                              +
       "Total Cost": 170632.24,                                                                                                                                                +
       "Plan Rows": 20,                                                                                                                                                        +
       "Plan Width": 202,                                                                                                                                                      +
       "Plans": [                                                                                                                                                              +
         {                                                                                                                                                                     +
           "Node Type": "Sort",                                                                                                                                                +
           "Parent Relationship": "Outer",                                                                                                                                     +
           "Parallel Aware": false,                                                                                                                                            +
           "Startup Cost": 170632.19,                                                                                                                                          +
           "Total Cost": 170771.67,                                                                                                                                            +
           "Plan Rows": 55790,                                                                                                                                                 +
           "Plan Width": 202,                                                                                                                                                  +
           "Sort Key": ["(sum((lineitem.l_extendedprice * ('1'::numeric - lineitem.l_discount)))) DESC"],                                                                      +
           "Plans": [                                                                                                                                                          +
             {                                                                                                                                                                 +
               "Node Type": "Aggregate",                                                                                                                                       +
               "Strategy": "Sorted",                                                                                                                                           +
               "Partial Mode": "Finalize",                                                                                                                                     +
               "Parent Relationship": "Outer",                                                                                                                                 +
               "Parallel Aware": false,                                                                                                                                        +
               "Startup Cost": 161979.75,                                                                                                                                      +
               "Total Cost": 169147.64,                                                                                                                                        +
               "Plan Rows": 55790,                                                                                                                                             +
               "Plan Width": 202,                                                                                                                                              +
               "Group Key": ["customer.c_custkey", "nation.n_name"],                                                                                                           +
               "Plans": [                                                                                                                                                      +
                 {                                                                                                                                                             +
                   "Node Type": "Gather Merge",                                                                                                                                +
                   "Parent Relationship": "Outer",                                                                                                                             +
                   "Parallel Aware": false,                                                                                                                                    +
                   "Startup Cost": 161979.75,                                                                                                                                  +
                   "Total Cost": 167985.35,                                                                                                                                    +
                   "Plan Rows": 46492,                                                                                                                                         +
                   "Plan Width": 202,                                                                                                                                          +
                   "Workers Planned": 2,                                                                                                                                       +
                   "Plans": [                                                                                                                                                  +
                     {                                                                                                                                                         +
                       "Node Type": "Aggregate",                                                                                                                               +
                       "Strategy": "Sorted",                                                                                                                                   +
                       "Partial Mode": "Partial",                                                                                                                              +
                       "Parent Relationship": "Outer",                                                                                                                         +
                       "Parallel Aware": false,                                                                                                                                +
                       "Startup Cost": 160979.73,                                                                                                                              +
                       "Total Cost": 161618.99,                                                                                                                                +
                       "Plan Rows": 23246,                                                                                                                                     +
                       "Plan Width": 202,                                                                                                                                      +
                       "Group Key": ["customer.c_custkey", "nation.n_name"],                                                                                                   +
                       "Plans": [                                                                                                                                              +
                         {                                                                                                                                                     +
                           "Node Type": "Sort",                                                                                                                                +
                           "Parent Relationship": "Outer",                                                                                                                     +
                           "Parallel Aware": false,                                                                                                                            +
                           "Startup Cost": 160979.73,                                                                                                                          +
                           "Total Cost": 161037.84,                                                                                                                            +
                           "Plan Rows": 23246,                                                                                                                                 +
                           "Plan Width": 182,                                                                                                                                  +
                           "Sort Key": ["customer.c_custkey", "nation.n_name"],                                                                                                +
                           "Plans": [                                                                                                                                          +
                             {                                                                                                                                                 +
                               "Node Type": "Hash Join",                                                                                                                       +
                               "Parent Relationship": "Outer",                                                                                                                 +
                               "Parallel Aware": false,                                                                                                                        +
                               "Join Type": "Inner",                                                                                                                           +
                               "Startup Cost": 152020.99,                                                                                                                      +
                               "Total Cost": 157225.35,                                                                                                                        +
                               "Plan Rows": 23246,                                                                                                                             +
                               "Plan Width": 182,                                                                                                                              +
                               "Inner Unique": true,                                                                                                                           +
                               "Hash Cond": "(customer.c_nationkey = nation.n_nationkey)",                                                                                     +
                               "Plans": [                                                                                                                                      +
                                 {                                                                                                                                             +
                                   "Node Type": "Hash Join",                                                                                                                   +
                                   "Parent Relationship": "Outer",                                                                                                             +
                                   "Parallel Aware": true,                                                                                                                     +
                                   "Join Type": "Inner",                                                                                                                       +
                                   "Startup Cost": 152019.43,                                                                                                                  +
                                   "Total Cost": 157152.42,                                                                                                                    +
                                   "Plan Rows": 23246,                                                                                                                         +
                                   "Plan Width": 164,                                                                                                                          +
                                   "Inner Unique": false,                                                                                                                      +
                                   "Hash Cond": "(customer.c_custkey = orders.o_custkey)",                                                                                     +
                                   "Plans": [                                                                                                                                  +
                                     {                                                                                                                                         +
                                       "Node Type": "Seq Scan",                                                                                                                +
                                       "Parent Relationship": "Outer",                                                                                                         +
                                       "Parallel Aware": true,                                                                                                                 +
                                       "Relation Name": "customer",                                                                                                            +
                                       "Alias": "customer",                                                                                                                    +
                                       "Startup Cost": 0.00,                                                                                                                   +
                                       "Total Cost": 4333.00,                                                                                                                  +
                                       "Plan Rows": 62500,                                                                                                                     +
                                       "Plan Width": 152                                                                                                                       +
                                     },                                                                                                                                        +
                                     {                                                                                                                                         +
                                       "Node Type": "Hash",                                                                                                                    +
                                       "Parent Relationship": "Inner",                                                                                                         +
                                       "Parallel Aware": true,                                                                                                                 +
                                       "Startup Cost": 151728.86,                                                                                                              +
                                       "Total Cost": 151728.86,                                                                                                                +
                                       "Plan Rows": 23246,                                                                                                                     +
                                       "Plan Width": 20,                                                                                                                       +
                                       "Plans": [                                                                                                                              +
                                         {                                                                                                                                     +
                                           "Node Type": "Nested Loop",                                                                                                         +
                                           "Parent Relationship": "Outer",                                                                                                     +
                                           "Parallel Aware": false,                                                                                                            +
                                           "Join Type": "Inner",                                                                                                               +
                                           "Startup Cost": 1196.88,                                                                                                            +
                                           "Total Cost": 151728.86,                                                                                                            +
                                           "Plan Rows": 23246,                                                                                                                 +
                                           "Plan Width": 20,                                                                                                                   +
                                           "Inner Unique": false,                                                                                                              +
                                           "Plans": [                                                                                                                          +
                                             {                                                                                                                                 +
                                               "Node Type": "Bitmap Heap Scan",                                                                                                +
                                               "Parent Relationship": "Outer",                                                                                                 +
                                               "Parallel Aware": true,                                                                                                         +
                                               "Relation Name": "orders",                                                                                                      +
                                               "Alias": "orders",                                                                                                              +
                                               "Startup Cost": 1196.45,                                                                                                        +
                                               "Total Cost": 29172.68,                                                                                                         +
                                               "Plan Rows": 23415,                                                                                                             +
                                               "Plan Width": 12,                                                                                                               +
                                               "Recheck Cond": "((o_orderdate >= '1993-10-01'::date) AND (o_orderdate < '1994-01-01 00:00:00'::timestamp without time zone))", +
                                               "Plans": [                                                                                                                      +
                                                 {                                                                                                                             +
                                                   "Node Type": "Bitmap Index Scan",                                                                                           +
                                                   "Parent Relationship": "Outer",                                                                                             +
                                                   "Parallel Aware": false,                                                                                                    +
                                                   "Index Name": "idx_orders_orderdate",                                                                                       +
                                                   "Startup Cost": 0.00,                                                                                                       +
                                                   "Total Cost": 1182.40,                                                                                                      +
                                                   "Plan Rows": 56197,                                                                                                         +
                                                   "Plan Width": 0,                                                                                                            +
                                                   "Index Cond": "((o_orderdate >= '1993-10-01'::date) AND (o_orderdate < '1994-01-01 00:00:00'::timestamp without time zone))"+
                                                 }                                                                                                                             +
                                               ]                                                                                                                               +
                                             },                                                                                                                                +
                                             {                                                                                                                                 +
                                               "Node Type": "Index Scan",                                                                                                      +
                                               "Parent Relationship": "Inner",                                                                                                 +
                                               "Parallel Aware": false,                                                                                                        +
                                               "Scan Direction": "Forward",                                                                                                    +
                                               "Index Name": "idx_lineitem_orderkey",                                                                                          +
                                               "Relation Name": "lineitem",                                                                                                    +
                                               "Alias": "lineitem",                                                                                                            +
                                               "Startup Cost": 0.43,                                                                                                           +
                                               "Total Cost": 5.19,                                                                                                             +
                                               "Plan Rows": 4,                                                                                                                 +
                                               "Plan Width": 20,                                                                                                               +
                                               "Index Cond": "(l_orderkey = orders.o_orderkey)",                                                                               +
                                               "Filter": "(l_returnflag = 'R'::bpchar)"                                                                                        +
                                             }                                                                                                                                 +
                                           ]                                                                                                                                   +
                                         }                                                                                                                                     +
                                       ]                                                                                                                                       +
                                     }                                                                                                                                         +
                                   ]                                                                                                                                           +
                                 },                                                                                                                                            +
                                 {                                                                                                                                             +
                                   "Node Type": "Hash",                                                                                                                        +
                                   "Parent Relationship": "Inner",                                                                                                             +
                                   "Parallel Aware": false,                                                                                                                    +
                                   "Startup Cost": 1.25,                                                                                                                       +
                                   "Total Cost": 1.25,                                                                                                                         +
                                   "Plan Rows": 25,                                                                                                                            +
                                   "Plan Width": 30,                                                                                                                           +
                                   "Plans": [                                                                                                                                  +
                                     {                                                                                                                                         +
                                       "Node Type": "Seq Scan",                                                                                                                +
                                       "Parent Relationship": "Outer",                                                                                                         +
                                       "Parallel Aware": false,                                                                                                                +
                                       "Relation Name": "nation",                                                                                                              +
                                       "Alias": "nation",                                                                                                                      +
                                       "Startup Cost": 0.00,                                                                                                                   +
                                       "Total Cost": 1.25,                                                                                                                     +
                                       "Plan Rows": 25,                                                                                                                        +
                                       "Plan Width": 30                                                                                                                        +
                                     }                                                                                                                                         +
                                   ]                                                                                                                                           +
                                 }                                                                                                                                             +
                               ]                                                                                                                                               +
                             }                                                                                                                                                 +
                           ]                                                                                                                                                   +
                         }                                                                                                                                                     +
                       ]                                                                                                                                                       +
                     }                                                                                                                                                         +
                   ]                                                                                                                                                           +
                 }                                                                                                                                                             +
               ]                                                                                                                                                               +
             }                                                                                                                                                                 +
           ]                                                                                                                                                                   +
         }                                                                                                                                                                     +
       ]                                                                                                                                                                       +
     },                                                                                                                                                                        +
     "JIT": {                                                                                                                                                                  +
       "Worker Number": -1,                                                                                                                                                    +
       "Functions": 35,                                                                                                                                                        +
       "Options": {                                                                                                                                                            +
         "Inlining": false,                                                                                                                                                    +
         "Optimization": false,                                                                                                                                                +
         "Expressions": true,                                                                                                                                                  +
         "Deforming": true                                                                                                                                                     +
       }                                                                                                                                                                       +
     }                                                                                                                                                                         +
   }                                                                                                                                                                           +
 ]
(1 row)

 c_custkey |       c_name       |   revenue   | c_acctbal |          n_name           |                c_address                 |     c_phone     |                                                    c_comment                                                     
-----------+--------------------+-------------+-----------+---------------------------+------------------------------------------+-----------------+------------------------------------------------------------------------------------------------------------------
     57040 | Customer#000057040 | 734235.2455 |    632.87 | JAPAN                     | Eioyzjf4pp                               | 22-895-641-3466 | sits. slyly regular requests sleep alongside of the regular inst
    143347 | Customer#000143347 | 721002.6948 |   2557.47 | EGYPT                     | 1aReFYv,Kw4                              | 14-742-935-3718 | ggle carefully enticing requests. final deposits use bold, bold pinto beans. ironic, idle re
     60838 | Customer#000060838 | 679127.3077 |   2454.77 | BRAZIL                    | 64EaJ5vMAHWJlBOxJklpNc2RJiWE             | 12-913-494-9813 |  need to boost against the slyly regular account
    101998 | Customer#000101998 | 637029.5667 |   3790.89 | UNITED KINGDOM            | 01c9CILnNtfOQYmZj                        | 33-593-865-6378 | ress foxes wake slyly after the bold excuses. ironic platelets are furiously carefully bold theodolites
    125341 | Customer#000125341 | 633508.0860 |   4983.51 | GERMANY                   | S29ODD6bceU8QSuuEJznkNaK                 | 17-582-695-5962 | arefully even depths. blithely even excuses sleep furiously. foxes use except the dependencies. ca
     25501 | Customer#000025501 | 620269.7849 |   7725.04 | ETHIOPIA                  |   W556MXuoiaYCCZamJI,Rn0B4ACUGdkQ8DZ     | 15-874-808-6793 | he pending instructions wake carefully at the pinto beans. regular, final instructions along the slyly fina
    115831 | Customer#000115831 | 596423.8672 |   5098.10 | FRANCE                    | rFeBbEEyk dl ne7zV5fDrmiq1oK09wV7pxqCgIc | 16-715-386-3788 | l somas sleep. furiously final deposits wake blithely regular pinto b
     84223 | Customer#000084223 | 594998.0239 |    528.65 | UNITED KINGDOM            | nAVZCs6BaWap rrM27N 2qBnzc5WBauxbA       | 33-442-824-8191 |  slyly final deposits haggle regular, pending dependencies. pending escapades wake 
     54289 | Customer#000054289 | 585603.3918 |   5583.02 | IRAN                      | vXCxoCsU0Bad5JQI ,oobkZ                  | 20-834-292-4707 | ely special foxes are quickly finally ironic p
     39922 | Customer#000039922 | 584878.1134 |   7321.11 | GERMANY                   | Zgy4s50l2GKN4pLDPBU8m342gIw6R            | 17-147-757-8036 | y final requests. furiously final foxes cajole blithely special platelets. f
      6226 | Customer#000006226 | 576783.7606 |   2230.09 | UNITED KINGDOM            | 8gPu8,NPGkfyQQ0hcIYUGPIBWc,ybP5g,        | 33-657-701-3391 | ending platelets along the express deposits cajole carefully final 
       922 | Customer#000000922 | 576767.5333 |   3869.25 | GERMANY                   | Az9RFaut7NkPnc5zSD2PwHgVwr4jRzq          | 17-945-916-9648 | luffily fluffy deposits. packages c
    147946 | Customer#000147946 | 576455.1320 |   2030.13 | ALGERIA                   | iANyZHjqhyy7Ajah0pTrYyhJ                 | 10-886-956-3143 | ithely ironic deposits haggle blithely ironic requests. quickly regu
    115640 | Customer#000115640 | 569341.1933 |   6436.10 | ARGENTINA                 | Vtgfia9qI 7EpHgecU1X                     | 11-411-543-4901 | ost slyly along the patterns; pinto be
     73606 | Customer#000073606 | 568656.8578 |   1785.67 | JAPAN                     | xuR0Tro5yChDfOCrjkd2ol                   | 22-437-653-6966 | he furiously regular ideas. slowly
    110246 | Customer#000110246 | 566842.9815 |   7763.35 | VIETNAM                   | 7KzflgX MDOq7sOkI                        | 31-943-426-9837 | egular deposits serve blithely above the fl
    142549 | Customer#000142549 | 563537.2368 |   5085.99 | INDONESIA                 | ChqEoK43OysjdHbtKCp6dKqjNyvvi9           | 19-955-562-2398 | sleep pending courts. ironic deposits against the carefully unusual platelets cajole carefully express accounts.
    146149 | Customer#000146149 | 557254.9865 |   1791.55 | ROMANIA                   | s87fvzFQpU                               | 29-744-164-6487 |  of the slyly silent accounts. quickly final accounts across the 
     52528 | Customer#000052528 | 556397.3509 |    551.79 | ARGENTINA                 | NFztyTOR10UOJ                            | 11-208-192-3205 |  deposits hinder. blithely pending asymptotes breach slyly regular re
     23431 | Customer#000023431 | 554269.5360 |   3381.86 | ROMANIA                   | HgiV0phqhaIa9aydNoIlb                    | 29-915-458-2654 | nusual, even instructions: furiously stealthy n
(20 rows)

QUERY PLAN                                             
---------------------------------------------------------------------------------------------------
 [                                                                                                +
   {                                                                                              +
     "Plan": {                                                                                    +
       "Node Type": "Limit",                                                                      +
       "Parallel Aware": false,                                                                   +
       "Startup Cost": 13076.25,                                                                  +
       "Total Cost": 13076.25,                                                                    +
       "Plan Rows": 1,                                                                            +
       "Plan Width": 40,                                                                          +
       "Plans": [                                                                                 +
         {                                                                                        +
           "Node Type": "Aggregate",                                                              +
           "Strategy": "Plain",                                                                   +
           "Partial Mode": "Simple",                                                              +
           "Parent Relationship": "InitPlan",                                                     +
           "Subplan Name": "InitPlan 1 (returns $2)",                                             +
           "Parallel Aware": false,                                                               +
           "Startup Cost": 4834.19,                                                               +
           "Total Cost": 4834.20,                                                                 +
           "Plan Rows": 1,                                                                        +
           "Plan Width": 32,                                                                      +
           "Plans": [                                                                             +
             {                                                                                    +
               "Node Type": "Nested Loop",                                                        +
               "Parent Relationship": "Outer",                                                    +
               "Parallel Aware": false,                                                           +
               "Join Type": "Inner",                                                              +
               "Startup Cost": 11.81,                                                             +
               "Total Cost": 4594.19,                                                             +
               "Plan Rows": 32000,                                                                +
               "Plan Width": 10,                                                                  +
               "Inner Unique": false,                                                             +
               "Plans": [                                                                         +
                 {                                                                                +
                   "Node Type": "Nested Loop",                                                    +
                   "Parent Relationship": "Outer",                                                +
                   "Parallel Aware": false,                                                       +
                   "Join Type": "Inner",                                                          +
                   "Startup Cost": 11.38,                                                         +
                   "Total Cost": 258.43,                                                          +
                   "Plan Rows": 400,                                                              +
                   "Plan Width": 4,                                                               +
                   "Inner Unique": false,                                                         +
                   "Plans": [                                                                     +
                     {                                                                            +
                       "Node Type": "Seq Scan",                                                   +
                       "Parent Relationship": "Outer",                                            +
                       "Parallel Aware": false,                                                   +
                       "Relation Name": "nation",                                                 +
                       "Alias": "nation_1",                                                       +
                       "Startup Cost": 0.00,                                                      +
                       "Total Cost": 1.31,                                                        +
                       "Plan Rows": 1,                                                            +
                       "Plan Width": 4,                                                           +
                       "Filter": "(n_name = 'UNITED KINGDOM'::bpchar)"                            +
                     },                                                                           +
                     {                                                                            +
                       "Node Type": "Bitmap Heap Scan",                                           +
                       "Parent Relationship": "Inner",                                            +
                       "Parallel Aware": false,                                                   +
                       "Relation Name": "supplier",                                               +
                       "Alias": "supplier_1",                                                     +
                       "Startup Cost": 11.38,                                                     +
                       "Total Cost": 253.12,                                                      +
                       "Plan Rows": 400,                                                          +
                       "Plan Width": 12,                                                          +
                       "Recheck Cond": "(s_nationkey = nation_1.n_nationkey)",                    +
                       "Plans": [                                                                 +
                         {                                                                        +
                           "Node Type": "Bitmap Index Scan",                                      +
                           "Parent Relationship": "Outer",                                        +
                           "Parallel Aware": false,                                               +
                           "Index Name": "idx_supplier_nation_key",                               +
                           "Startup Cost": 0.00,                                                  +
                           "Total Cost": 11.29,                                                   +
                           "Plan Rows": 400,                                                      +
                           "Plan Width": 0,                                                       +
                           "Index Cond": "(s_nationkey = nation_1.n_nationkey)"                   +
                         }                                                                        +
                       ]                                                                          +
                     }                                                                            +
                   ]                                                                              +
                 },                                                                               +
                 {                                                                                +
                   "Node Type": "Index Scan",                                                     +
                   "Parent Relationship": "Inner",                                                +
                   "Parallel Aware": false,                                                       +
                   "Scan Direction": "Forward",                                                   +
                   "Index Name": "idx_partsupp_suppkey",                                          +
                   "Relation Name": "partsupp",                                                   +
                   "Alias": "partsupp_1",                                                         +
                   "Startup Cost": 0.42,                                                          +
                   "Total Cost": 10.04,                                                           +
                   "Plan Rows": 80,                                                               +
                   "Plan Width": 18,                                                              +
                   "Index Cond": "(ps_suppkey = supplier_1.s_suppkey)"                            +
                 }                                                                                +
               ]                                                                                  +
             }                                                                                    +
           ]                                                                                      +
         },                                                                                       +
         {                                                                                        +
           "Node Type": "Sort",                                                                   +
           "Parent Relationship": "Outer",                                                        +
           "Parallel Aware": false,                                                               +
           "Startup Cost": 8242.05,                                                               +
           "Total Cost": 8268.72,                                                                 +
           "Plan Rows": 10667,                                                                    +
           "Plan Width": 40,                                                                      +
           "Sort Key": ["(sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric))) DESC"],+
           "Plans": [                                                                             +
             {                                                                                    +
               "Node Type": "Aggregate",                                                          +
               "Strategy": "Sorted",                                                              +
               "Partial Mode": "Simple",                                                          +
               "Parent Relationship": "Outer",                                                    +
               "Parallel Aware": false,                                                           +
               "Startup Cost": 6988.71,                                                           +
               "Total Cost": 8188.71,                                                             +
               "Plan Rows": 10667,                                                                +
               "Plan Width": 40,                                                                  +
               "Group Key": ["partsupp.ps_partkey"],                                              +
               "Filter": "(sum((partsupp.ps_supplycost * (partsupp.ps_availqty)::numeric)) > $2)",+
               "Plans": [                                                                         +
                 {                                                                                +
                   "Node Type": "Sort",                                                           +
                   "Parent Relationship": "Outer",                                                +
                   "Parallel Aware": false,                                                       +
                   "Startup Cost": 6988.71,                                                       +
                   "Total Cost": 7068.71,                                                         +
                   "Plan Rows": 32000,                                                            +
                   "Plan Width": 18,                                                              +
                   "Sort Key": ["partsupp.ps_partkey"],                                           +
                   "Plans": [                                                                     +
                     {                                                                            +
                       "Node Type": "Nested Loop",                                                +
                       "Parent Relationship": "Outer",                                            +
                       "Parallel Aware": false,                                                   +
                       "Join Type": "Inner",                                                      +
                       "Startup Cost": 11.81,                                                     +
                       "Total Cost": 4594.19,                                                     +
                       "Plan Rows": 32000,                                                        +
                       "Plan Width": 18,                                                          +
                       "Inner Unique": false,                                                     +
                       "Plans": [                                                                 +
                         {                                                                        +
                           "Node Type": "Nested Loop",                                            +
                           "Parent Relationship": "Outer",                                        +
                           "Parallel Aware": false,                                               +
                           "Join Type": "Inner",                                                  +
                           "Startup Cost": 11.38,                                                 +
                           "Total Cost": 258.43,                                                  +
                           "Plan Rows": 400,                                                      +
                           "Plan Width": 4,                                                       +
                           "Inner Unique": false,                                                 +
                           "Plans": [                                                             +
                             {                                                                    +
                               "Node Type": "Seq Scan",                                           +
                               "Parent Relationship": "Outer",                                    +
                               "Parallel Aware": false,                                           +
                               "Relation Name": "nation",                                         +
                               "Alias": "nation",                                                 +
                               "Startup Cost": 0.00,                                              +
                               "Total Cost": 1.31,                                                +
                               "Plan Rows": 1,                                                    +
                               "Plan Width": 4,                                                   +
                               "Filter": "(n_name = 'UNITED KINGDOM'::bpchar)"                    +
                             },                                                                   +
                             {                                                                    +
                               "Node Type": "Bitmap Heap Scan",                                   +
                               "Parent Relationship": "Inner",                                    +
                               "Parallel Aware": false,                                           +
                               "Relation Name": "supplier",                                       +
                               "Alias": "supplier",                                               +
                               "Startup Cost": 11.38,                                             +
                               "Total Cost": 253.12,                                              +
                               "Plan Rows": 400,                                                  +
                               "Plan Width": 12,                                                  +
                               "Recheck Cond": "(s_nationkey = nation.n_nationkey)",              +
                               "Plans": [                                                         +
                                 {                                                                +
                                   "Node Type": "Bitmap Index Scan",                              +
                                   "Parent Relationship": "Outer",                                +
                                   "Parallel Aware": false,                                       +
                                   "Index Name": "idx_supplier_nation_key",                       +
                                   "Startup Cost": 0.00,                                          +
                                   "Total Cost": 11.29,                                           +
                                   "Plan Rows": 400,                                              +
                                   "Plan Width": 0,                                               +
                                   "Index Cond": "(s_nationkey = nation.n_nationkey)"             +
                                 }                                                                +
                               ]                                                                  +
                             }                                                                    +
                           ]                                                                      +
                         },                                                                       +
                         {                                                                        +
                           "Node Type": "Index Scan",                                             +
                           "Parent Relationship": "Inner",                                        +
                           "Parallel Aware": false,                                               +
                           "Scan Direction": "Forward",                                           +
                           "Index Name": "idx_partsupp_suppkey",                                  +
                           "Relation Name": "partsupp",                                           +
                           "Alias": "partsupp",                                                   +
                           "Startup Cost": 0.42,                                                  +
                           "Total Cost": 10.04,                                                   +
                           "Plan Rows": 80,                                                       +
                           "Plan Width": 26,                                                      +
                           "Index Cond": "(ps_suppkey = supplier.s_suppkey)"                      +
                         }                                                                        +
                       ]                                                                          +
                     }                                                                            +
                   ]                                                                              +
                 }                                                                                +
               ]                                                                                  +
             }                                                                                    +
           ]                                                                                      +
         }                                                                                        +
       ]                                                                                          +
     }                                                                                            +
   }                                                                                              +
 ]
(1 row)

 ps_partkey |    value    
------------+-------------
     121139 | 17389780.68
(1 row)

QUERY PLAN                                                                                                                                     
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                                                                                                                                                +
   {                                                                                                                                                                                                                                                                              +
     "Plan": {                                                                                                                                                                                                                                                                    +
       "Node Type": "Limit",                                                                                                                                                                                                                                                      +
       "Parallel Aware": false,                                                                                                                                                                                                                                                   +
       "Startup Cost": 220712.33,                                                                                                                                                                                                                                                 +
       "Total Cost": 220746.43,                                                                                                                                                                                                                                                   +
       "Plan Rows": 1,                                                                                                                                                                                                                                                            +
       "Plan Width": 27,                                                                                                                                                                                                                                                          +
       "Plans": [                                                                                                                                                                                                                                                                 +
         {                                                                                                                                                                                                                                                                        +
           "Node Type": "Aggregate",                                                                                                                                                                                                                                              +
           "Strategy": "Sorted",                                                                                                                                                                                                                                                  +
           "Partial Mode": "Finalize",                                                                                                                                                                                                                                            +
           "Parent Relationship": "Outer",                                                                                                                                                                                                                                        +
           "Parallel Aware": false,                                                                                                                                                                                                                                               +
           "Startup Cost": 220712.33,                                                                                                                                                                                                                                             +
           "Total Cost": 220950.97,                                                                                                                                                                                                                                               +
           "Plan Rows": 7,                                                                                                                                                                                                                                                        +
           "Plan Width": 27,                                                                                                                                                                                                                                                      +
           "Group Key": ["lineitem.l_shipmode"],                                                                                                                                                                                                                                  +
           "Plans": [                                                                                                                                                                                                                                                             +
             {                                                                                                                                                                                                                                                                    +
               "Node Type": "Gather Merge",                                                                                                                                                                                                                                       +
               "Parent Relationship": "Outer",                                                                                                                                                                                                                                    +
               "Parallel Aware": false,                                                                                                                                                                                                                                           +
               "Startup Cost": 220712.33,                                                                                                                                                                                                                                         +
               "Total Cost": 220950.80,                                                                                                                                                                                                                                           +
               "Plan Rows": 14,                                                                                                                                                                                                                                                   +
               "Plan Width": 27,                                                                                                                                                                                                                                                  +
               "Workers Planned": 2,                                                                                                                                                                                                                                              +
               "Plans": [                                                                                                                                                                                                                                                         +
                 {                                                                                                                                                                                                                                                                +
                   "Node Type": "Aggregate",                                                                                                                                                                                                                                      +
                   "Strategy": "Sorted",                                                                                                                                                                                                                                          +
                   "Partial Mode": "Partial",                                                                                                                                                                                                                                     +
                   "Parent Relationship": "Outer",                                                                                                                                                                                                                                +
                   "Parallel Aware": false,                                                                                                                                                                                                                                       +
                   "Startup Cost": 219712.31,                                                                                                                                                                                                                                     +
                   "Total Cost": 219949.16,                                                                                                                                                                                                                                       +
                   "Plan Rows": 7,                                                                                                                                                                                                                                                +
                   "Plan Width": 27,                                                                                                                                                                                                                                              +
                   "Group Key": ["lineitem.l_shipmode"],                                                                                                                                                                                                                          +
                   "Plans": [                                                                                                                                                                                                                                                     +
                     {                                                                                                                                                                                                                                                            +
                       "Node Type": "Sort",                                                                                                                                                                                                                                       +
                       "Parent Relationship": "Outer",                                                                                                                                                                                                                            +
                       "Parallel Aware": false,                                                                                                                                                                                                                                   +
                       "Startup Cost": 219712.31,                                                                                                                                                                                                                                 +
                       "Total Cost": 219741.91,                                                                                                                                                                                                                                   +
                       "Plan Rows": 11839,                                                                                                                                                                                                                                        +
                       "Plan Width": 27,                                                                                                                                                                                                                                          +
                       "Sort Key": ["lineitem.l_shipmode"],                                                                                                                                                                                                                       +
                       "Plans": [                                                                                                                                                                                                                                                 +
                         {                                                                                                                                                                                                                                                        +
                           "Node Type": "Hash Join",                                                                                                                                                                                                                              +
                           "Parent Relationship": "Outer",                                                                                                                                                                                                                        +
                           "Parallel Aware": true,                                                                                                                                                                                                                                +
                           "Join Type": "Inner",                                                                                                                                                                                                                                  +
                           "Startup Cost": 177955.75,                                                                                                                                                                                                                             +
                           "Total Cost": 218911.33,                                                                                                                                                                                                                               +
                           "Plan Rows": 11839,                                                                                                                                                                                                                                    +
                           "Plan Width": 27,                                                                                                                                                                                                                                      +
                           "Inner Unique": false,                                                                                                                                                                                                                                 +
                           "Hash Cond": "(orders.o_orderkey = lineitem.l_orderkey)",                                                                                                                                                                                              +
                           "Plans": [                                                                                                                                                                                                                                             +
                             {                                                                                                                                                                                                                                                    +
                               "Node Type": "Seq Scan",                                                                                                                                                                                                                           +
                               "Parent Relationship": "Outer",                                                                                                                                                                                                                    +
                               "Parallel Aware": true,                                                                                                                                                                                                                            +
                               "Relation Name": "orders",                                                                                                                                                                                                                         +
                               "Alias": "orders",                                                                                                                                                                                                                                 +
                               "Startup Cost": 0.00,                                                                                                                                                                                                                              +
                               "Total Cost": 33875.00,                                                                                                                                                                                                                            +
                               "Plan Rows": 625000,                                                                                                                                                                                                                               +
                               "Plan Width": 20                                                                                                                                                                                                                                   +
                             },                                                                                                                                                                                                                                                   +
                             {                                                                                                                                                                                                                                                    +
                               "Node Type": "Hash",                                                                                                                                                                                                                               +
                               "Parent Relationship": "Inner",                                                                                                                                                                                                                    +
                               "Parallel Aware": true,                                                                                                                                                                                                                            +
                               "Startup Cost": 177807.76,                                                                                                                                                                                                                         +
                               "Total Cost": 177807.76,                                                                                                                                                                                                                           +
                               "Plan Rows": 11839,                                                                                                                                                                                                                                +
                               "Plan Width": 19,                                                                                                                                                                                                                                  +
                               "Plans": [                                                                                                                                                                                                                                         +
                                 {                                                                                                                                                                                                                                                +
                                   "Node Type": "Seq Scan",                                                                                                                                                                                                                       +
                                   "Parent Relationship": "Outer",                                                                                                                                                                                                                +
                                   "Parallel Aware": true,                                                                                                                                                                                                                        +
                                   "Relation Name": "lineitem",                                                                                                                                                                                                                   +
                                   "Alias": "lineitem",                                                                                                                                                                                                                           +
                                   "Startup Cost": 0.00,                                                                                                                                                                                                                          +
                                   "Total Cost": 177807.76,                                                                                                                                                                                                                       +
                                   "Plan Rows": 11839,                                                                                                                                                                                                                            +
                                   "Plan Width": 19,                                                                                                                                                                                                                              +
                                   "Filter": "((l_shipmode = ANY ('{SHIP,AIR}'::bpchar[])) AND (l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND (l_receiptdate >= '1996-01-01'::date) AND (l_receiptdate < '1997-01-01 00:00:00'::timestamp without time zone))"+
                                 }                                                                                                                                                                                                                                                +
                               ]                                                                                                                                                                                                                                                  +
                             }                                                                                                                                                                                                                                                    +
                           ]                                                                                                                                                                                                                                                      +
                         }                                                                                                                                                                                                                                                        +
                       ]                                                                                                                                                                                                                                                          +
                     }                                                                                                                                                                                                                                                            +
                   ]                                                                                                                                                                                                                                                              +
                 }                                                                                                                                                                                                                                                                +
               ]                                                                                                                                                                                                                                                                  +
             }                                                                                                                                                                                                                                                                    +
           ]                                                                                                                                                                                                                                                                      +
         }                                                                                                                                                                                                                                                                        +
       ]                                                                                                                                                                                                                                                                          +
     },                                                                                                                                                                                                                                                                           +
     "JIT": {                                                                                                                                                                                                                                                                     +
       "Worker Number": -1,                                                                                                                                                                                                                                                       +
       "Functions": 22,                                                                                                                                                                                                                                                           +
       "Options": {                                                                                                                                                                                                                                                               +
         "Inlining": false,                                                                                                                                                                                                                                                       +
         "Optimization": false,                                                                                                                                                                                                                                                   +
         "Expressions": true,                                                                                                                                                                                                                                                     +
         "Deforming": true                                                                                                                                                                                                                                                        +
       }                                                                                                                                                                                                                                                                          +
     }                                                                                                                                                                                                                                                                            +
   }                                                                                                                                                                                                                                                                              +
 ]
(1 row)

 l_shipmode | high_line_count | low_line_count 
------------+-----------------+----------------
 AIR        |            6340 |           9259
(1 row)

QUERY PLAN                                            
--------------------------------------------------------------------------------------------------
 [                                                                                               +
   {                                                                                             +
     "Plan": {                                                                                   +
       "Node Type": "Limit",                                                                     +
       "Parallel Aware": false,                                                                  +
       "Startup Cost": 163751.33,                                                                +
       "Total Cost": 163751.33,                                                                  +
       "Plan Rows": 1,                                                                           +
       "Plan Width": 16,                                                                         +
       "Plans": [                                                                                +
         {                                                                                       +
           "Node Type": "Sort",                                                                  +
           "Parent Relationship": "Outer",                                                       +
           "Parallel Aware": false,                                                              +
           "Startup Cost": 163751.33,                                                            +
           "Total Cost": 163751.83,                                                              +
           "Plan Rows": 200,                                                                     +
           "Plan Width": 16,                                                                     +
           "Sort Key": ["(count(*)) DESC", "(count(orders.o_orderkey)) DESC"],                   +
           "Plans": [                                                                            +
             {                                                                                   +
               "Node Type": "Aggregate",                                                         +
               "Strategy": "Hashed",                                                             +
               "Partial Mode": "Simple",                                                         +
               "Parent Relationship": "Outer",                                                   +
               "Parallel Aware": false,                                                          +
               "Startup Cost": 163748.33,                                                        +
               "Total Cost": 163750.33,                                                          +
               "Plan Rows": 200,                                                                 +
               "Plan Width": 16,                                                                 +
               "Group Key": ["count(orders.o_orderkey)"],                                        +
               "Plans": [                                                                        +
                 {                                                                               +
                   "Node Type": "Aggregate",                                                     +
                   "Strategy": "Sorted",                                                         +
                   "Partial Mode": "Finalize",                                                   +
                   "Parent Relationship": "Outer",                                               +
                   "Parallel Aware": false,                                                      +
                   "Startup Cost": 1000.87,                                                      +
                   "Total Cost": 161498.33,                                                      +
                   "Plan Rows": 150000,                                                          +
                   "Plan Width": 12,                                                             +
                   "Group Key": ["customer.c_custkey"],                                          +
                   "Plans": [                                                                    +
                     {                                                                           +
                       "Node Type": "Gather Merge",                                              +
                       "Parent Relationship": "Outer",                                           +
                       "Parallel Aware": false,                                                  +
                       "Startup Cost": 1000.87,                                                  +
                       "Total Cost": 158498.33,                                                  +
                       "Plan Rows": 300000,                                                      +
                       "Plan Width": 12,                                                         +
                       "Workers Planned": 2,                                                     +
                       "Plans": [                                                                +
                         {                                                                       +
                           "Node Type": "Aggregate",                                             +
                           "Strategy": "Sorted",                                                 +
                           "Partial Mode": "Partial",                                            +
                           "Parent Relationship": "Outer",                                       +
                           "Parallel Aware": false,                                              +
                           "Startup Cost": 0.85,                                                 +
                           "Total Cost": 122870.86,                                              +
                           "Plan Rows": 150000,                                                  +
                           "Plan Width": 12,                                                     +
                           "Group Key": ["customer.c_custkey"],                                  +
                           "Plans": [                                                            +
                             {                                                                   +
                               "Node Type": "Nested Loop",                                       +
                               "Parent Relationship": "Outer",                                   +
                               "Parallel Aware": false,                                          +
                               "Join Type": "Left",                                              +
                               "Startup Cost": 0.85,                                             +
                               "Total Cost": 118246.17,                                          +
                               "Plan Rows": 624938,                                              +
                               "Plan Width": 8,                                                  +
                               "Inner Unique": false,                                            +
                               "Plans": [                                                        +
                                 {                                                               +
                                   "Node Type": "Index Only Scan",                               +
                                   "Parent Relationship": "Outer",                               +
                                   "Parallel Aware": true,                                       +
                                   "Scan Direction": "Forward",                                  +
                                   "Index Name": "customer_pkey",                                +
                                   "Relation Name": "customer",                                  +
                                   "Alias": "customer",                                          +
                                   "Startup Cost": 0.42,                                         +
                                   "Total Cost": 6742.42,                                        +
                                   "Plan Rows": 62500,                                           +
                                   "Plan Width": 4                                               +
                                 },                                                              +
                                 {                                                               +
                                   "Node Type": "Index Scan",                                    +
                                   "Parent Relationship": "Inner",                               +
                                   "Parallel Aware": false,                                      +
                                   "Scan Direction": "Forward",                                  +
                                   "Index Name": "idx_orders_custkey",                           +
                                   "Relation Name": "orders",                                    +
                                   "Alias": "orders",                                            +
                                   "Startup Cost": 0.43,                                         +
                                   "Total Cost": 1.61,                                           +
                                   "Plan Rows": 17,                                              +
                                   "Plan Width": 12,                                             +
                                   "Index Cond": "(o_custkey = customer.c_custkey)",             +
                                   "Filter": "((o_comment)::text !~~ '%special%accounts%'::text)"+
                                 }                                                               +
                               ]                                                                 +
                             }                                                                   +
                           ]                                                                     +
                         }                                                                       +
                       ]                                                                         +
                     }                                                                           +
                   ]                                                                             +
                 }                                                                               +
               ]                                                                                 +
             }                                                                                   +
           ]                                                                                     +
         }                                                                                       +
       ]                                                                                         +
     },                                                                                          +
     "JIT": {                                                                                    +
       "Worker Number": -1,                                                                      +
       "Functions": 15,                                                                          +
       "Options": {                                                                              +
         "Inlining": false,                                                                      +
         "Optimization": false,                                                                  +
         "Expressions": true,                                                                    +
         "Deforming": true                                                                       +
       }                                                                                         +
     }                                                                                           +
   }                                                                                             +
 ]
(1 row)

 c_count | custdist 
---------+----------
       0 |    50004
(1 row)

QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                               +
   {                                                                                                                                             +
     "Plan": {                                                                                                                                   +
       "Node Type": "Limit",                                                                                                                     +
       "Parallel Aware": false,                                                                                                                  +
       "Startup Cost": 66867.72,                                                                                                                 +
       "Total Cost": 66867.73,                                                                                                                   +
       "Plan Rows": 1,                                                                                                                           +
       "Plan Width": 32,                                                                                                                         +
       "Plans": [                                                                                                                                +
         {                                                                                                                                       +
           "Node Type": "Aggregate",                                                                                                             +
           "Strategy": "Plain",                                                                                                                  +
           "Partial Mode": "Finalize",                                                                                                           +
           "Parent Relationship": "Outer",                                                                                                       +
           "Parallel Aware": false,                                                                                                              +
           "Startup Cost": 66867.72,                                                                                                             +
           "Total Cost": 66867.73,                                                                                                               +
           "Plan Rows": 1,                                                                                                                       +
           "Plan Width": 32,                                                                                                                     +
           "Plans": [                                                                                                                            +
             {                                                                                                                                   +
               "Node Type": "Gather",                                                                                                            +
               "Parent Relationship": "Outer",                                                                                                   +
               "Parallel Aware": false,                                                                                                          +
               "Startup Cost": 66867.48,                                                                                                         +
               "Total Cost": 66867.69,                                                                                                           +
               "Plan Rows": 2,                                                                                                                   +
               "Plan Width": 64,                                                                                                                 +
               "Workers Planned": 2,                                                                                                             +
               "Single Copy": false,                                                                                                             +
               "Plans": [                                                                                                                        +
                 {                                                                                                                               +
                   "Node Type": "Aggregate",                                                                                                     +
                   "Strategy": "Plain",                                                                                                          +
                   "Partial Mode": "Partial",                                                                                                    +
                   "Parent Relationship": "Outer",                                                                                               +
                   "Parallel Aware": false,                                                                                                      +
                   "Startup Cost": 65867.48,                                                                                                     +
                   "Total Cost": 65867.49,                                                                                                       +
                   "Plan Rows": 1,                                                                                                               +
                   "Plan Width": 64,                                                                                                             +
                   "Plans": [                                                                                                                    +
                     {                                                                                                                           +
                       "Node Type": "Merge Join",                                                                                                +
                       "Parent Relationship": "Outer",                                                                                           +
                       "Parallel Aware": false,                                                                                                  +
                       "Join Type": "Inner",                                                                                                     +
                       "Startup Cost": 0.92,                                                                                                     +
                       "Total Cost": 65807.70,                                                                                                   +
                       "Plan Rows": 3416,                                                                                                        +
                       "Plan Width": 33,                                                                                                         +
                       "Inner Unique": true,                                                                                                     +
                       "Merge Cond": "(lineitem.l_partkey = part.p_partkey)",                                                                    +
                       "Plans": [                                                                                                                +
                         {                                                                                                                       +
                           "Node Type": "Index Scan",                                                                                            +
                           "Parent Relationship": "Outer",                                                                                       +
                           "Parallel Aware": true,                                                                                               +
                           "Scan Direction": "Forward",                                                                                          +
                           "Index Name": "idx_lineitem_part_supp",                                                                               +
                           "Relation Name": "lineitem",                                                                                          +
                           "Alias": "lineitem",                                                                                                  +
                           "Startup Cost": 0.43,                                                                                                 +
                           "Total Cost": 646239.51,                                                                                              +
                           "Plan Rows": 32355,                                                                                                   +
                           "Plan Width": 20,                                                                                                     +
                           "Filter": "((l_shipdate >= '1996-08-01'::date) AND (l_shipdate < '1996-09-01 00:00:00'::timestamp without time zone))"+
                         },                                                                                                                      +
                         {                                                                                                                       +
                           "Node Type": "Index Scan",                                                                                            +
                           "Parent Relationship": "Inner",                                                                                       +
                           "Parallel Aware": false,                                                                                              +
                           "Scan Direction": "Forward",                                                                                          +
                           "Index Name": "part_pkey",                                                                                            +
                           "Relation Name": "part",                                                                                              +
                           "Alias": "part",                                                                                                      +
                           "Startup Cost": 0.29,                                                                                                 +
                           "Total Cost": 941.29,                                                                                                 +
                           "Plan Rows": 20000,                                                                                                   +
                           "Plan Width": 25                                                                                                      +
                         }                                                                                                                       +
                       ]                                                                                                                         +
                     }                                                                                                                           +
                   ]                                                                                                                             +
                 }                                                                                                                               +
               ]                                                                                                                                 +
             }                                                                                                                                   +
           ]                                                                                                                                     +
         }                                                                                                                                       +
       ]                                                                                                                                         +
     }                                                                                                                                           +
   }                                                                                                                                             +
 ]
(1 row)

    promo_revenue    
---------------------
 17.0389665791302127
(1 row)

CREATE VIEW
                                                                          
QUERY PLAN                                                                                         
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                                                        +
   {                                                                                                                                                                                      +
     "Plan": {                                                                                                                                                                            +
       "Node Type": "Limit",                                                                                                                                                              +
       "Parallel Aware": false,                                                                                                                                                           +
       "Startup Cost": 6230.74,                                                                                                                                                           +
       "Total Cost": 6230.75,                                                                                                                                                             +
       "Plan Rows": 1,                                                                                                                                                                    +
       "Plan Width": 44,                                                                                                                                                                  +
       "Plans": [                                                                                                                                                                         +
         {                                                                                                                                                                                +
           "Node Type": "Sort",                                                                                                                                                           +
           "Parent Relationship": "Outer",                                                                                                                                                +
           "Parallel Aware": false,                                                                                                                                                       +
           "Startup Cost": 6230.74,                                                                                                                                                       +
           "Total Cost": 6234.73,                                                                                                                                                         +
           "Plan Rows": 1596,                                                                                                                                                             +
           "Plan Width": 44,                                                                                                                                                              +
           "Sort Key": ["(count(DISTINCT partsupp.ps_suppkey)) DESC", "part.p_brand", "part.p_type", "part.p_size"],                                                                      +
           "Plans": [                                                                                                                                                                     +
             {                                                                                                                                                                            +
               "Node Type": "Aggregate",                                                                                                                                                  +
               "Strategy": "Sorted",                                                                                                                                                      +
               "Partial Mode": "Simple",                                                                                                                                                  +
               "Parent Relationship": "Outer",                                                                                                                                            +
               "Parallel Aware": false,                                                                                                                                                   +
               "Startup Cost": 6132.77,                                                                                                                                                   +
               "Total Cost": 6222.76,                                                                                                                                                     +
               "Plan Rows": 1596,                                                                                                                                                         +
               "Plan Width": 44,                                                                                                                                                          +
               "Group Key": ["part.p_brand", "part.p_type", "part.p_size"],                                                                                                               +
               "Plans": [                                                                                                                                                                 +
                 {                                                                                                                                                                        +
                   "Node Type": "Sort",                                                                                                                                                   +
                   "Parent Relationship": "Outer",                                                                                                                                        +
                   "Parallel Aware": false,                                                                                                                                               +
                   "Startup Cost": 6132.77,                                                                                                                                               +
                   "Total Cost": 6147.57,                                                                                                                                                 +
                   "Plan Rows": 5923,                                                                                                                                                     +
                   "Plan Width": 44,                                                                                                                                                      +
                   "Sort Key": ["part.p_brand", "part.p_type", "part.p_size"],                                                                                                            +
                   "Plans": [                                                                                                                                                             +
                     {                                                                                                                                                                    +
                       "Node Type": "Merge Join",                                                                                                                                         +
                       "Parent Relationship": "Outer",                                                                                                                                    +
                       "Parallel Aware": false,                                                                                                                                           +
                       "Join Type": "Inner",                                                                                                                                              +
                       "Startup Cost": 1435.97,                                                                                                                                           +
                       "Total Cost": 5761.63,                                                                                                                                             +
                       "Plan Rows": 5923,                                                                                                                                                 +
                       "Plan Width": 44,                                                                                                                                                  +
                       "Inner Unique": true,                                                                                                                                              +
                       "Merge Cond": "(partsupp.ps_partkey = part.p_partkey)",                                                                                                            +
                       "Plans": [                                                                                                                                                         +
                         {                                                                                                                                                                +
                           "Node Type": "Index Scan",                                                                                                                                     +
                           "Parent Relationship": "Outer",                                                                                                                                +
                           "Parallel Aware": false,                                                                                                                                       +
                           "Scan Direction": "Forward",                                                                                                                                   +
                           "Index Name": "idx_partsupp_partkey",                                                                                                                          +
                           "Relation Name": "partsupp",                                                                                                                                   +
                           "Alias": "partsupp",                                                                                                                                           +
                           "Startup Cost": 355.43,                                                                                                                                        +
                           "Total Cost": 41487.43,                                                                                                                                        +
                           "Plan Rows": 400000,                                                                                                                                           +
                           "Plan Width": 16,                                                                                                                                              +
                           "Filter": "(NOT (hashed SubPlan 1))",                                                                                                                          +
                           "Plans": [                                                                                                                                                     +
                             {                                                                                                                                                            +
                               "Node Type": "Seq Scan",                                                                                                                                   +
                               "Parent Relationship": "SubPlan",                                                                                                                          +
                               "Subplan Name": "SubPlan 1",                                                                                                                               +
                               "Parallel Aware": false,                                                                                                                                   +
                               "Relation Name": "supplier",                                                                                                                               +
                               "Alias": "supplier",                                                                                                                                       +
                               "Startup Cost": 0.00,                                                                                                                                      +
                               "Total Cost": 355.00,                                                                                                                                      +
                               "Plan Rows": 1,                                                                                                                                            +
                               "Plan Width": 4,                                                                                                                                           +
                               "Filter": "((s_comment)::text ~~ '%Customer%Complaints%'::text)"                                                                                           +
                             }                                                                                                                                                            +
                           ]                                                                                                                                                              +
                         },                                                                                                                                                               +
                         {                                                                                                                                                                +
                           "Node Type": "Sort",                                                                                                                                           +
                           "Parent Relationship": "Inner",                                                                                                                                +
                           "Parallel Aware": false,                                                                                                                                       +
                           "Startup Cost": 1080.53,                                                                                                                                       +
                           "Total Cost": 1087.93,                                                                                                                                         +
                           "Plan Rows": 2958,                                                                                                                                             +
                           "Plan Width": 40,                                                                                                                                              +
                           "Sort Key": ["part.p_partkey"],                                                                                                                                +
                           "Plans": [                                                                                                                                                     +
                             {                                                                                                                                                            +
                               "Node Type": "Seq Scan",                                                                                                                                   +
                               "Parent Relationship": "Outer",                                                                                                                            +
                               "Parallel Aware": false,                                                                                                                                   +
                               "Relation Name": "part",                                                                                                                                   +
                               "Alias": "part",                                                                                                                                           +
                               "Startup Cost": 0.00,                                                                                                                                      +
                               "Total Cost": 910.00,                                                                                                                                      +
                               "Plan Rows": 2958,                                                                                                                                         +
                               "Plan Width": 40,                                                                                                                                          +
                               "Filter": "((p_brand <> 'Brand#33'::bpchar) AND ((p_type)::text !~~ 'ECONOMY POLISHED%'::text) AND (p_size = ANY ('{25,39,48,21,30,5,32,40}'::integer[])))"+
                             }                                                                                                                                                            +
                           ]                                                                                                                                                              +
                         }                                                                                                                                                                +
                       ]                                                                                                                                                                  +
                     }                                                                                                                                                                    +
                   ]                                                                                                                                                                      +
                 }                                                                                                                                                                        +
               ]                                                                                                                                                                          +
             }                                                                                                                                                                            +
           ]                                                                                                                                                                              +
         }                                                                                                                                                                                +
       ]                                                                                                                                                                                  +
     }                                                                                                                                                                                    +
   }                                                                                                                                                                                      +
 ]
(1 row)

  p_brand   |        p_type        | p_size | supplier_cnt 
------------+----------------------+--------+--------------
 Brand#13   | MEDIUM PLATED NICKEL |     32 |           12
(1 row)

QUERY PLAN                                              
------------------------------------------------------------------------------------------------------
 [                                                                                                   +
   {                                                                                                 +
     "Plan": {                                                                                       +
       "Node Type": "Limit",                                                                         +
       "Parallel Aware": false,                                                                      +
       "Startup Cost": 148146.59,                                                                    +
       "Total Cost": 148146.60,                                                                      +
       "Plan Rows": 1,                                                                               +
       "Plan Width": 32,                                                                             +
       "Plans": [                                                                                    +
         {                                                                                           +
           "Node Type": "Aggregate",                                                                 +
           "Strategy": "Plain",                                                                      +
           "Partial Mode": "Simple",                                                                 +
           "Parent Relationship": "Outer",                                                           +
           "Parallel Aware": false,                                                                  +
           "Startup Cost": 148146.59,                                                                +
           "Total Cost": 148146.60,                                                                  +
           "Plan Rows": 1,                                                                           +
           "Plan Width": 32,                                                                         +
           "Plans": [                                                                                +
             {                                                                                       +
               "Node Type": "Merge Join",                                                            +
               "Parent Relationship": "Outer",                                                       +
               "Parallel Aware": false,                                                              +
               "Join Type": "Inner",                                                                 +
               "Startup Cost": 1.15,                                                                 +
               "Total Cost": 148141.09,                                                              +
               "Plan Rows": 2200,                                                                    +
               "Plan Width": 8,                                                                      +
               "Inner Unique": true,                                                                 +
               "Merge Cond": "(lineitem.l_partkey = part.p_partkey)",                                +
               "Plans": [                                                                            +
                 {                                                                                   +
                   "Node Type": "Merge Join",                                                        +
                   "Parent Relationship": "Outer",                                                   +
                   "Parallel Aware": false,                                                          +
                   "Join Type": "Inner",                                                             +
                   "Startup Cost": 0.86,                                                             +
                   "Total Cost": 1462725.33,                                                         +
                   "Plan Rows": 2000454,                                                             +
                   "Plan Width": 24,                                                                 +
                   "Inner Unique": false,                                                            +
                   "Merge Cond": "(lineitem_1.l_partkey = lineitem.l_partkey)",                      +
                   "Join Filter": "(lineitem.l_quantity < ((0.2 * avg(lineitem_1.l_quantity))))",    +
                   "Plans": [                                                                        +
                     {                                                                               +
                       "Node Type": "Aggregate",                                                     +
                       "Strategy": "Sorted",                                                         +
                       "Partial Mode": "Simple",                                                     +
                       "Parent Relationship": "Outer",                                               +
                       "Parallel Aware": false,                                                      +
                       "Startup Cost": 0.43,                                                         +
                       "Total Cost": 701592.63,                                                      +
                       "Plan Rows": 189414,                                                          +
                       "Plan Width": 40,                                                             +
                       "Group Key": ["lineitem_1.l_partkey"],                                        +
                       "Plans": [                                                                    +
                         {                                                                           +
                           "Node Type": "Index Scan",                                                +
                           "Parent Relationship": "Outer",                                           +
                           "Parallel Aware": false,                                                  +
                           "Scan Direction": "Forward",                                              +
                           "Index Name": "idx_lineitem_part_supp",                                   +
                           "Relation Name": "lineitem",                                              +
                           "Alias": "lineitem_1",                                                    +
                           "Startup Cost": 0.43,                                                     +
                           "Total Cost": 668744.61,                                                  +
                           "Plan Rows": 6001361,                                                     +
                           "Plan Width": 13                                                          +
                         }                                                                           +
                       ]                                                                             +
                     },                                                                              +
                     {                                                                               +
                       "Node Type": "Index Scan",                                                    +
                       "Parent Relationship": "Inner",                                               +
                       "Parallel Aware": false,                                                      +
                       "Scan Direction": "Forward",                                                  +
                       "Index Name": "idx_lineitem_part_supp",                                       +
                       "Relation Name": "lineitem",                                                  +
                       "Alias": "lineitem",                                                          +
                       "Startup Cost": 0.43,                                                         +
                       "Total Cost": 668744.61,                                                      +
                       "Plan Rows": 6001361,                                                         +
                       "Plan Width": 21                                                              +
                     }                                                                               +
                   ]                                                                                 +
                 },                                                                                  +
                 {                                                                                   +
                   "Node Type": "Index Scan",                                                        +
                   "Parent Relationship": "Inner",                                                   +
                   "Parallel Aware": false,                                                          +
                   "Scan Direction": "Forward",                                                      +
                   "Index Name": "part_pkey",                                                        +
                   "Relation Name": "part",                                                          +
                   "Alias": "part",                                                                  +
                   "Startup Cost": 0.29,                                                             +
                   "Total Cost": 1041.29,                                                            +
                   "Plan Rows": 22,                                                                  +
                   "Plan Width": 4,                                                                  +
                   "Filter": "((p_brand = 'Brand#34'::bpchar) AND (p_container = 'MED JAR'::bpchar))"+
                 }                                                                                   +
               ]                                                                                     +
             }                                                                                       +
           ]                                                                                         +
         }                                                                                           +
       ]                                                                                             +
     },                                                                                              +
     "JIT": {                                                                                        +
       "Worker Number": -1,                                                                          +
       "Functions": 21,                                                                              +
       "Options": {                                                                                  +
         "Inlining": false,                                                                          +
         "Optimization": false,                                                                      +
         "Expressions": true,                                                                        +
         "Deforming": true                                                                           +
       }                                                                                             +
     }                                                                                               +
   }                                                                                                 +
 ]
(1 row)

     avg_yearly     
--------------------
 45005.468571428571
(1 row)

QUERY PLAN                                                
----------------------------------------------------------------------------------------------------------
 [                                                                                                       +
   {                                                                                                     +
     "Plan": {                                                                                           +
       "Node Type": "Limit",                                                                             +
       "Parallel Aware": false,                                                                          +
       "Startup Cost": 529683.11,                                                                        +
       "Total Cost": 529683.36,                                                                          +
       "Plan Rows": 100,                                                                                 +
       "Plan Width": 71,                                                                                 +
       "Plans": [                                                                                        +
         {                                                                                               +
           "Node Type": "Sort",                                                                          +
           "Parent Relationship": "Outer",                                                               +
           "Parallel Aware": false,                                                                      +
           "Startup Cost": 529683.11,                                                                    +
           "Total Cost": 530868.95,                                                                      +
           "Plan Rows": 474336,                                                                          +
           "Plan Width": 71,                                                                             +
           "Sort Key": ["orders.o_totalprice DESC", "orders.o_orderdate"],                               +
           "Plans": [                                                                                    +
             {                                                                                           +
               "Node Type": "Aggregate",                                                                 +
               "Strategy": "Sorted",                                                                     +
               "Partial Mode": "Finalize",                                                               +
               "Parent Relationship": "Outer",                                                           +
               "Parallel Aware": false,                                                                  +
               "Startup Cost": 451600.31,                                                                +
               "Total Cost": 511554.33,                                                                  +
               "Plan Rows": 474336,                                                                      +
               "Plan Width": 71,                                                                         +
               "Group Key": ["customer.c_custkey", "orders.o_orderkey"],                                 +
               "Plans": [                                                                                +
                 {                                                                                       +
                   "Node Type": "Gather Merge",                                                          +
                   "Parent Relationship": "Outer",                                                       +
                   "Parallel Aware": false,                                                              +
                   "Startup Cost": 451600.31,                                                            +
                   "Total Cost": 501672.33,                                                              +
                   "Plan Rows": 395280,                                                                  +
                   "Plan Width": 71,                                                                     +
                   "Workers Planned": 2,                                                                 +
                   "Plans": [                                                                            +
                     {                                                                                   +
                       "Node Type": "Aggregate",                                                         +
                       "Strategy": "Sorted",                                                             +
                       "Partial Mode": "Partial",                                                        +
                       "Parent Relationship": "Outer",                                                   +
                       "Parallel Aware": false,                                                          +
                       "Startup Cost": 450600.29,                                                        +
                       "Total Cost": 455047.19,                                                          +
                       "Plan Rows": 197640,                                                              +
                       "Plan Width": 71,                                                                 +
                       "Group Key": ["customer.c_custkey", "orders.o_orderkey"],                         +
                       "Plans": [                                                                        +
                         {                                                                               +
                           "Node Type": "Sort",                                                          +
                           "Parent Relationship": "Outer",                                               +
                           "Parallel Aware": false,                                                      +
                           "Startup Cost": 450600.29,                                                    +
                           "Total Cost": 451094.39,                                                      +
                           "Plan Rows": 197640,                                                          +
                           "Plan Width": 44,                                                             +
                           "Sort Key": ["customer.c_custkey", "orders.o_orderkey"],                      +
                           "Plans": [                                                                    +
                             {                                                                           +
                               "Node Type": "Nested Loop",                                               +
                               "Parent Relationship": "Outer",                                           +
                               "Parallel Aware": false,                                                  +
                               "Join Type": "Inner",                                                     +
                               "Startup Cost": 321056.93,                                                +
                               "Total Cost": 427132.36,                                                  +
                               "Plan Rows": 197640,                                                      +
                               "Plan Width": 44,                                                         +
                               "Inner Unique": false,                                                    +
                               "Plans": [                                                                +
                                 {                                                                       +
                                   "Node Type": "Hash Join",                                             +
                                   "Parent Relationship": "Outer",                                       +
                                   "Parallel Aware": true,                                               +
                                   "Join Type": "Inner",                                                 +
                                   "Startup Cost": 321056.50,                                            +
                                   "Total Cost": 364491.80,                                              +
                                   "Plan Rows": 49399,                                                   +
                                   "Plan Width": 47,                                                     +
                                   "Inner Unique": true,                                                 +
                                   "Hash Cond": "(orders.o_custkey = customer.c_custkey)",               +
                                   "Plans": [                                                            +
                                     {                                                                   +
                                       "Node Type": "Hash Join",                                         +
                                       "Parent Relationship": "Outer",                                   +
                                       "Parallel Aware": false,                                          +
                                       "Join Type": "Inner",                                             +
                                       "Startup Cost": 315942.25,                                        +
                                       "Total Cost": 359247.88,                                          +
                                       "Plan Rows": 49399,                                               +
                                       "Plan Width": 32,                                                 +
                                       "Inner Unique": true,                                             +
                                       "Hash Cond": "(orders.o_orderkey = lineitem_1.l_orderkey)",       +
                                       "Plans": [                                                        +
                                         {                                                               +
                                           "Node Type": "Seq Scan",                                      +
                                           "Parent Relationship": "Outer",                               +
                                           "Parallel Aware": true,                                       +
                                           "Relation Name": "orders",                                    +
                                           "Alias": "orders",                                            +
                                           "Startup Cost": 0.00,                                         +
                                           "Total Cost": 33875.00,                                       +
                                           "Plan Rows": 625000,                                          +
                                           "Plan Width": 24                                              +
                                         },                                                              +
                                         {                                                               +
                                           "Node Type": "Hash",                                          +
                                           "Parent Relationship": "Inner",                               +
                                           "Parallel Aware": false,                                      +
                                           "Startup Cost": 313996.29,                                    +
                                           "Total Cost": 313996.29,                                      +
                                           "Plan Rows": 118557,                                          +
                                           "Plan Width": 8,                                              +
                                           "Plans": [                                                    +
                                             {                                                           +
                                               "Node Type": "Aggregate",                                 +
                                               "Strategy": "Sorted",                                     +
                                               "Partial Mode": "Simple",                                 +
                                               "Parent Relationship": "Outer",                           +
                                               "Parallel Aware": false,                                  +
                                               "Startup Cost": 0.43,                                     +
                                               "Total Cost": 312810.72,                                  +
                                               "Plan Rows": 118557,                                      +
                                               "Plan Width": 8,                                          +
                                               "Group Key": ["lineitem_1.l_orderkey"],                   +
                                               "Filter": "(sum(lineitem_1.l_quantity) > '315'::numeric)",+
                                               "Plans": [                                                +
                                                 {                                                       +
                                                   "Node Type": "Index Scan",                            +
                                                   "Parent Relationship": "Outer",                       +
                                                   "Parallel Aware": false,                              +
                                                   "Scan Direction": "Forward",                          +
                                                   "Index Name": "idx_lineitem_orderkey",                +
                                                   "Relation Name": "lineitem",                          +
                                                   "Alias": "lineitem_1",                                +
                                                   "Startup Cost": 0.43,                                 +
                                                   "Total Cost": 277468.85,                              +
                                                   "Plan Rows": 6001361,                                 +
                                                   "Plan Width": 13                                      +
                                                 }                                                       +
                                               ]                                                         +
                                             }                                                           +
                                           ]                                                             +
                                         }                                                               +
                                       ]                                                                 +
                                     },                                                                  +
                                     {                                                                   +
                                       "Node Type": "Hash",                                              +
                                       "Parent Relationship": "Inner",                                   +
                                       "Parallel Aware": true,                                           +
                                       "Startup Cost": 4333.00,                                          +
                                       "Total Cost": 4333.00,                                            +
                                       "Plan Rows": 62500,                                               +
                                       "Plan Width": 23,                                                 +
                                       "Plans": [                                                        +
                                         {                                                               +
                                           "Node Type": "Seq Scan",                                      +
                                           "Parent Relationship": "Outer",                               +
                                           "Parallel Aware": true,                                       +
                                           "Relation Name": "customer",                                  +
                                           "Alias": "customer",                                          +
                                           "Startup Cost": 0.00,                                         +
                                           "Total Cost": 4333.00,                                        +
                                           "Plan Rows": 62500,                                           +
                                           "Plan Width": 23                                              +
                                         }                                                               +
                                       ]                                                                 +
                                     }                                                                   +
                                   ]                                                                     +
                                 },                                                                      +
                                 {                                                                       +
                                   "Node Type": "Index Scan",                                            +
                                   "Parent Relationship": "Inner",                                       +
                                   "Parallel Aware": false,                                              +
                                   "Scan Direction": "Forward",                                          +
                                   "Index Name": "idx_lineitem_orderkey",                                +
                                   "Relation Name": "lineitem",                                          +
                                   "Alias": "lineitem",                                                  +
                                   "Startup Cost": 0.43,                                                 +
                                   "Total Cost": 1.10,                                                   +
                                   "Plan Rows": 17,                                                      +
                                   "Plan Width": 13,                                                     +
                                   "Index Cond": "(l_orderkey = orders.o_orderkey)"                      +
                                 }                                                                       +
                               ]                                                                         +
                             }                                                                           +
                           ]                                                                             +
                         }                                                                               +
                       ]                                                                                 +
                     }                                                                                   +
                   ]                                                                                     +
                 }                                                                                       +
               ]                                                                                         +
             }                                                                                           +
           ]                                                                                             +
         }                                                                                               +
       ]                                                                                                 +
     },                                                                                                  +
     "JIT": {                                                                                            +
       "Worker Number": -1,                                                                              +
       "Functions": 35,                                                                                  +
       "Options": {                                                                                      +
         "Inlining": true,                                                                               +
         "Optimization": true,                                                                           +
         "Expressions": true,                                                                            +
         "Deforming": true                                                                               +
       }                                                                                                 +
     }                                                                                                   +
   }                                                                                                     +
 ]
(1 row)

       c_name       | c_custkey | o_orderkey | o_orderdate | o_totalprice | sum 
--------------------+-----------+------------+-------------+--------------+-----
 Customer#000128120 |    128120 |    4722021 | 1994-04-07  |    544089.09 | 323
 Customer#000144617 |    144617 |    3043270 | 1997-02-12  |    530604.44 | 317
 Customer#000066790 |     66790 |    2199712 | 1996-09-30  |    515531.82 | 327
 Customer#000015619 |     15619 |    3767271 | 1996-08-07  |    480083.96 | 318
 Customer#000147197 |    147197 |    1263015 | 1997-02-02  |    467149.67 | 320
 Customer#000117919 |    117919 |    2869152 | 1996-06-20  |    456815.92 | 317
 Customer#000126865 |    126865 |    4702759 | 1994-11-07  |    447606.65 | 320
 Customer#000036619 |     36619 |    4806726 | 1995-01-17  |    446704.09 | 328
 Customer#000119989 |    119989 |    1544643 | 1997-09-20  |    434568.25 | 320
(9 rows)

QUERY PLAN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
   {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
     "Plan": {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
       "Node Type": "Limit",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
       "Parallel Aware": false,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
       "Startup Cost": 7839.13,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
       "Total Cost": 7839.14,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
       "Plan Rows": 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
       "Plan Width": 32,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
       "Plans": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
         {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
           "Node Type": "Aggregate",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
           "Strategy": "Plain",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
           "Partial Mode": "Simple",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
           "Parent Relationship": "Outer",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
           "Parallel Aware": false,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
           "Startup Cost": 7839.13,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
           "Total Cost": 7839.14,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          +
           "Plan Rows": 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
           "Plan Width": 32,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
           "Plans": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +
             {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
               "Node Type": "Nested Loop",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
               "Parent Relationship": "Outer",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
               "Parallel Aware": false,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
               "Join Type": "Inner",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
               "Startup Cost": 0.43,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
               "Total Cost": 7839.04,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +
               "Plan Rows": 12,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
               "Plan Width": 12,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
               "Inner Unique": false,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      +
               "Plans": [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
                   "Node Type": "Seq Scan",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                   "Parent Relationship": "Outer",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
                   "Parallel Aware": false,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                   "Relation Name": "part",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                   "Alias": "part",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
                   "Startup Cost": 0.00,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
                   "Total Cost": 1260.00,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  +
                   "Plan Rows": 49,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
                   "Plan Width": 30,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
                   "Filter": "((p_size >= 1) AND (((p_brand = 'Brand#34'::bpchar) AND (p_container = ANY ('{\"SM CASE\",\"SM BOX\",\"SM PACK\",\"SM PKG\"}'::bpchar[])) AND (p_size <= 5)) OR ((p_brand = 'Brand#52'::bpchar) AND (p_container = ANY ('{\"MED BAG\",\"MED BOX\",\"MED PKG\",\"MED PACK\"}'::bpchar[])) AND (p_size <= 10)) OR ((p_brand = 'Brand#33'::bpchar) AND (p_container = ANY ('{\"LG CASE\",\"LG BOX\",\"LG PACK\",\"LG PKG\"}'::bpchar[])) AND (p_size <= 15))))"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
                 },                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        +
                 {                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
                   "Node Type": "Index Scan",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              +
                   "Parent Relationship": "Inner",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
                   "Parallel Aware": false,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                +
                   "Scan Direction": "Forward",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
                   "Index Name": "idx_lineitem_part_supp",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
                   "Relation Name": "lineitem",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            +
                   "Alias": "lineitem",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    +
                   "Startup Cost": 0.43,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
                   "Total Cost": 134.26,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
                   "Plan Rows": 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
                   "Plan Width": 25,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
                   "Index Cond": "(l_partkey = part.p_partkey)",                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
                   "Filter": "((l_shipmode = ANY ('{AIR,\"AIR REG\"}'::bpchar[])) AND (l_shipinstruct = 'DELIVER IN PERSON'::bpchar) AND (((l_quantity >= '6'::numeric) AND (l_quantity <= '16'::numeric)) OR ((l_quantity >= '18'::numeric) AND (l_quantity <= '28'::numeric)) OR ((l_quantity >= '22'::numeric) AND (l_quantity <= '32'::numeric))) AND (((part.p_brand = 'Brand#34'::bpchar) AND (part.p_container = ANY ('{\"SM CASE\",\"SM BOX\",\"SM PACK\",\"SM PKG\"}'::bpchar[])) AND (l_quantity >= '6'::numeric) AND (l_quantity <= '16'::numeric) AND (part.p_size <= 5)) OR ((part.p_brand = 'Brand#52'::bpchar) AND (part.p_container = ANY ('{\"MED BAG\",\"MED BOX\",\"MED PKG\",\"MED PACK\"}'::bpchar[])) AND (l_quantity >= '18'::numeric) AND (l_quantity <= '28'::numeric) AND (part.p_size <= 10)) OR ((part.p_brand = 'Brand#33'::bpchar) AND (part.p_container = ANY ('{\"LG CASE\",\"LG BOX\",\"LG PACK\",\"LG PKG\"}'::bpchar[])) AND (l_quantity >= '22'::numeric) AND (l_quantity <= '32'::numeric) AND (part.p_size <= 15))))"+
                 }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         +
               ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           +
             }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             +
           ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               +
         }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 +
       ]                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   +
     }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     +
   }                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       +
 ]
(1 row)

   revenue   
-------------
 395482.9752
(1 row)

QUERY PLAN                                                                            
------------------------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                                               +
   {                                                                                                                                                             +
     "Plan": {                                                                                                                                                   +
       "Node Type": "Limit",                                                                                                                                     +
       "Parallel Aware": false,                                                                                                                                  +
       "Startup Cost": 324691.09,                                                                                                                                +
       "Total Cost": 324691.10,                                                                                                                                  +
       "Plan Rows": 1,                                                                                                                                           +
       "Plan Width": 51,                                                                                                                                         +
       "Plans": [                                                                                                                                                +
         {                                                                                                                                                       +
           "Node Type": "Sort",                                                                                                                                  +
           "Parent Relationship": "Outer",                                                                                                                       +
           "Parallel Aware": false,                                                                                                                              +
           "Startup Cost": 324691.09,                                                                                                                            +
           "Total Cost": 324691.10,                                                                                                                              +
           "Plan Rows": 1,                                                                                                                                       +
           "Plan Width": 51,                                                                                                                                     +
           "Sort Key": ["supplier.s_name"],                                                                                                                      +
           "Plans": [                                                                                                                                            +
             {                                                                                                                                                   +
               "Node Type": "Nested Loop",                                                                                                                       +
               "Parent Relationship": "Outer",                                                                                                                   +
               "Parallel Aware": false,                                                                                                                          +
               "Join Type": "Semi",                                                                                                                              +
               "Startup Cost": 203431.82,                                                                                                                        +
               "Total Cost": 324691.08,                                                                                                                          +
               "Plan Rows": 1,                                                                                                                                   +
               "Plan Width": 51,                                                                                                                                 +
               "Inner Unique": false,                                                                                                                            +
               "Join Filter": "(supplier.s_suppkey = lineitem.l_suppkey)",                                                                                       +
               "Plans": [                                                                                                                                        +
                 {                                                                                                                                               +
                   "Node Type": "Nested Loop",                                                                                                                   +
                   "Parent Relationship": "Outer",                                                                                                               +
                   "Parallel Aware": false,                                                                                                                      +
                   "Join Type": "Inner",                                                                                                                         +
                   "Startup Cost": 0.00,                                                                                                                         +
                   "Total Cost": 456.31,                                                                                                                         +
                   "Plan Rows": 400,                                                                                                                             +
                   "Plan Width": 55,                                                                                                                             +
                   "Inner Unique": false,                                                                                                                        +
                   "Join Filter": "(supplier.s_nationkey = nation.n_nationkey)",                                                                                 +
                   "Plans": [                                                                                                                                    +
                     {                                                                                                                                           +
                       "Node Type": "Seq Scan",                                                                                                                  +
                       "Parent Relationship": "Outer",                                                                                                           +
                       "Parallel Aware": false,                                                                                                                  +
                       "Relation Name": "nation",                                                                                                                +
                       "Alias": "nation",                                                                                                                        +
                       "Startup Cost": 0.00,                                                                                                                     +
                       "Total Cost": 1.31,                                                                                                                       +
                       "Plan Rows": 1,                                                                                                                           +
                       "Plan Width": 4,                                                                                                                          +
                       "Filter": "(n_name = 'INDONESIA'::bpchar)"                                                                                                +
                     },                                                                                                                                          +
                     {                                                                                                                                           +
                       "Node Type": "Seq Scan",                                                                                                                  +
                       "Parent Relationship": "Inner",                                                                                                           +
                       "Parallel Aware": false,                                                                                                                  +
                       "Relation Name": "supplier",                                                                                                              +
                       "Alias": "supplier",                                                                                                                      +
                       "Startup Cost": 0.00,                                                                                                                     +
                       "Total Cost": 330.00,                                                                                                                     +
                       "Plan Rows": 10000,                                                                                                                       +
                       "Plan Width": 63                                                                                                                          +
                     }                                                                                                                                           +
                   ]                                                                                                                                             +
                 },                                                                                                                                              +
                 {                                                                                                                                               +
                   "Node Type": "Materialize",                                                                                                                   +
                   "Parent Relationship": "Inner",                                                                                                               +
                   "Parallel Aware": false,                                                                                                                      +
                   "Startup Cost": 203431.82,                                                                                                                    +
                   "Total Cost": 324228.77,                                                                                                                      +
                   "Plan Rows": 1,                                                                                                                               +
                   "Plan Width": 16,                                                                                                                             +
                   "Plans": [                                                                                                                                    +
                     {                                                                                                                                           +
                       "Node Type": "Merge Join",                                                                                                                +
                       "Parent Relationship": "Outer",                                                                                                           +
                       "Parallel Aware": false,                                                                                                                  +
                       "Join Type": "Inner",                                                                                                                     +
                       "Startup Cost": 203431.82,                                                                                                                +
                       "Total Cost": 324228.77,                                                                                                                  +
                       "Plan Rows": 1,                                                                                                                           +
                       "Plan Width": 16,                                                                                                                         +
                       "Inner Unique": false,                                                                                                                    +
                       "Merge Cond": "(lineitem.l_partkey = partsupp.ps_partkey)",                                                                               +
                       "Join Filter": "((partsupp.ps_suppkey = lineitem.l_suppkey) AND ((partsupp.ps_availqty)::numeric > ((0.5 * sum(lineitem.l_quantity)))))", +
                       "Plans": [                                                                                                                                +
                         {                                                                                                                                       +
                           "Node Type": "Aggregate",                                                                                                             +
                           "Strategy": "Sorted",                                                                                                                 +
                           "Partial Mode": "Finalize",                                                                                                           +
                           "Parent Relationship": "Outer",                                                                                                       +
                           "Parallel Aware": false,                                                                                                              +
                           "Startup Cost": 203431.10,                                                                                                            +
                           "Total Cost": 315426.01,                                                                                                              +
                           "Plan Rows": 486326,                                                                                                                  +
                           "Plan Width": 48,                                                                                                                     +
                           "Group Key": ["lineitem.l_partkey", "lineitem.l_suppkey"],                                                                            +
                           "Plans": [                                                                                                                            +
                             {                                                                                                                                   +
                               "Node Type": "Gather Merge",                                                                                                      +
                               "Parent Relationship": "Outer",                                                                                                   +
                               "Parallel Aware": false,                                                                                                          +
                               "Startup Cost": 203431.10,                                                                                                        +
                               "Total Cost": 300470.60,                                                                                                          +
                               "Plan Rows": 766052,                                                                                                              +
                               "Plan Width": 48,                                                                                                                 +
                               "Workers Planned": 2,                                                                                                             +
                               "Plans": [                                                                                                                        +
                                 {                                                                                                                               +
                                   "Node Type": "Aggregate",                                                                                                     +
                                   "Strategy": "Sorted",                                                                                                         +
                                   "Partial Mode": "Partial",                                                                                                    +
                                   "Parent Relationship": "Outer",                                                                                               +
                                   "Parallel Aware": false,                                                                                                      +
                                   "Startup Cost": 202431.08,                                                                                                    +
                                   "Total Cost": 211049.17,                                                                                                      +
                                   "Plan Rows": 383026,                                                                                                          +
                                   "Plan Width": 48,                                                                                                             +
                                   "Group Key": ["lineitem.l_partkey", "lineitem.l_suppkey"],                                                                    +
                                   "Plans": [                                                                                                                    +
                                     {                                                                                                                           +
                                       "Node Type": "Sort",                                                                                                      +
                                       "Parent Relationship": "Outer",                                                                                           +
                                       "Parallel Aware": false,                                                                                                  +
                                       "Startup Cost": 202431.08,                                                                                                +
                                       "Total Cost": 203388.65,                                                                                                  +
                                       "Plan Rows": 383026,                                                                                                      +
                                       "Plan Width": 21,                                                                                                         +
                                       "Sort Key": ["lineitem.l_partkey", "lineitem.l_suppkey"],                                                                 +
                                       "Plans": [                                                                                                                +
                                         {                                                                                                                       +
                                           "Node Type": "Seq Scan",                                                                                              +
                                           "Parent Relationship": "Outer",                                                                                       +
                                           "Parallel Aware": true,                                                                                               +
                                           "Relation Name": "lineitem",                                                                                          +
                                           "Alias": "lineitem",                                                                                                  +
                                           "Startup Cost": 0.00,                                                                                                 +
                                           "Total Cost": 159053.51,                                                                                              +
                                           "Plan Rows": 383026,                                                                                                  +
                                           "Plan Width": 21,                                                                                                     +
                                           "Filter": "((l_shipdate >= '1997-01-01'::date) AND (l_shipdate < '1998-01-01 00:00:00'::timestamp without time zone))"+
                                         }                                                                                                                       +
                                       ]                                                                                                                         +
                                     }                                                                                                                           +
                                   ]                                                                                                                             +
                                 }                                                                                                                               +
                               ]                                                                                                                                 +
                             }                                                                                                                                   +
                           ]                                                                                                                                     +
                         },                                                                                                                                      +
                         {                                                                                                                                       +
                           "Node Type": "Materialize",                                                                                                           +
                           "Parent Relationship": "Inner",                                                                                                       +
                           "Parallel Aware": false,                                                                                                              +
                           "Startup Cost": 0.71,                                                                                                                 +
                           "Total Cost": 2681.38,                                                                                                                +
                           "Plan Rows": 809,                                                                                                                     +
                           "Plan Width": 24,                                                                                                                     +
                           "Plans": [                                                                                                                            +
                             {                                                                                                                                   +
                               "Node Type": "Nested Loop",                                                                                                       +
                               "Parent Relationship": "Outer",                                                                                                   +
                               "Parallel Aware": false,                                                                                                          +
                               "Join Type": "Inner",                                                                                                             +
                               "Startup Cost": 0.71,                                                                                                             +
                               "Total Cost": 2679.36,                                                                                                            +
                               "Plan Rows": 809,                                                                                                                 +
                               "Plan Width": 24,                                                                                                                 +
                               "Inner Unique": false,                                                                                                            +
                               "Plans": [                                                                                                                        +
                                 {                                                                                                                               +
                                   "Node Type": "Index Scan",                                                                                                    +
                                   "Parent Relationship": "Outer",                                                                                               +
                                   "Parallel Aware": false,                                                                                                      +
                                   "Scan Direction": "Forward",                                                                                                  +
                                   "Index Name": "part_pkey",                                                                                                    +
                                   "Relation Name": "part",                                                                                                      +
                                   "Alias": "part",                                                                                                              +
                                   "Startup Cost": 0.29,                                                                                                         +
                                   "Total Cost": 991.29,                                                                                                         +
                                   "Plan Rows": 202,                                                                                                             +
                                   "Plan Width": 4,                                                                                                              +
                                   "Filter": "((p_name)::text ~~ 'red%'::text)"                                                                                  +
                                 },                                                                                                                              +
                                 {                                                                                                                               +
                                   "Node Type": "Index Scan",                                                                                                    +
                                   "Parent Relationship": "Inner",                                                                                               +
                                   "Parallel Aware": false,                                                                                                      +
                                   "Scan Direction": "Forward",                                                                                                  +
                                   "Index Name": "idx_partsupp_partkey",                                                                                         +
                                   "Relation Name": "partsupp",                                                                                                  +
                                   "Alias": "partsupp",                                                                                                          +
                                   "Startup Cost": 0.42,                                                                                                         +
                                   "Total Cost": 8.32,                                                                                                           +
                                   "Plan Rows": 4,                                                                                                               +
                                   "Plan Width": 20,                                                                                                             +
                                   "Index Cond": "(ps_partkey = part.p_partkey)"                                                                                 +
                                 }                                                                                                                               +
                               ]                                                                                                                                 +
                             }                                                                                                                                   +
                           ]                                                                                                                                     +
                         }                                                                                                                                       +
                       ]                                                                                                                                         +
                     }                                                                                                                                           +
                   ]                                                                                                                                             +
                 }                                                                                                                                               +
               ]                                                                                                                                                 +
             }                                                                                                                                                   +
           ]                                                                                                                                                     +
         }                                                                                                                                                       +
       ]                                                                                                                                                         +
     },                                                                                                                                                          +
     "JIT": {                                                                                                                                                    +
       "Worker Number": -1,                                                                                                                                      +
       "Functions": 37,                                                                                                                                          +
       "Options": {                                                                                                                                              +
         "Inlining": false,                                                                                                                                      +
         "Optimization": false,                                                                                                                                  +
         "Expressions": true,                                                                                                                                    +
         "Deforming": true                                                                                                                                       +
       }                                                                                                                                                         +
     }                                                                                                                                                           +
   }                                                                                                                                                             +
 ]
(1 row)

          s_name           |   s_address   
---------------------------+---------------
 Supplier#000000089        | fhtzZcSorhud1
(1 row)

QUERY PLAN                                                     
--------------------------------------------------------------------------------------------------------------------
 [                                                                                                                 +
   {                                                                                                               +
     "Plan": {                                                                                                     +
       "Node Type": "Limit",                                                                                       +
       "Parallel Aware": false,                                                                                    +
       "Startup Cost": 179068.19,                                                                                  +
       "Total Cost": 179068.20,                                                                                    +
       "Plan Rows": 1,                                                                                             +
       "Plan Width": 34,                                                                                           +
       "Plans": [                                                                                                  +
         {                                                                                                         +
           "Node Type": "Sort",                                                                                    +
           "Parent Relationship": "Outer",                                                                         +
           "Parallel Aware": false,                                                                                +
           "Startup Cost": 179068.19,                                                                              +
           "Total Cost": 179068.20,                                                                                +
           "Plan Rows": 1,                                                                                         +
           "Plan Width": 34,                                                                                       +
           "Sort Key": ["(count(*)) DESC", "supplier.s_name"],                                                     +
           "Plans": [                                                                                              +
             {                                                                                                     +
               "Node Type": "Aggregate",                                                                           +
               "Strategy": "Sorted",                                                                               +
               "Partial Mode": "Simple",                                                                           +
               "Parent Relationship": "Outer",                                                                     +
               "Parallel Aware": false,                                                                            +
               "Startup Cost": 179068.16,                                                                          +
               "Total Cost": 179068.18,                                                                            +
               "Plan Rows": 1,                                                                                     +
               "Plan Width": 34,                                                                                   +
               "Group Key": ["supplier.s_name"],                                                                   +
               "Plans": [                                                                                          +
                 {                                                                                                 +
                   "Node Type": "Sort",                                                                            +
                   "Parent Relationship": "Outer",                                                                 +
                   "Parallel Aware": false,                                                                        +
                   "Startup Cost": 179068.16,                                                                      +
                   "Total Cost": 179068.17,                                                                        +
                   "Plan Rows": 1,                                                                                 +
                   "Plan Width": 26,                                                                               +
                   "Sort Key": ["supplier.s_name"],                                                                +
                   "Plans": [                                                                                      +
                     {                                                                                             +
                       "Node Type": "Nested Loop",                                                                 +
                       "Parent Relationship": "Outer",                                                             +
                       "Parallel Aware": false,                                                                    +
                       "Join Type": "Inner",                                                                       +
                       "Startup Cost": 1264.72,                                                                    +
                       "Total Cost": 179068.15,                                                                    +
                       "Plan Rows": 1,                                                                             +
                       "Plan Width": 26,                                                                           +
                       "Inner Unique": true,                                                                       +
                       "Plans": [                                                                                  +
                         {                                                                                         +
                           "Node Type": "Nested Loop",                                                             +
                           "Parent Relationship": "Outer",                                                         +
                           "Parallel Aware": false,                                                                +
                           "Join Type": "Semi",                                                                    +
                           "Startup Cost": 1264.30,                                                                +
                           "Total Cost": 179067.64,                                                                +
                           "Plan Rows": 1,                                                                         +
                           "Plan Width": 42,                                                                       +
                           "Inner Unique": false,                                                                  +
                           "Plans": [                                                                              +
                             {                                                                                     +
                               "Node Type": "Gather",                                                              +
                               "Parent Relationship": "Outer",                                                     +
                               "Parallel Aware": false,                                                            +
                               "Startup Cost": 1263.86,                                                            +
                               "Total Cost": 179066.57,                                                            +
                               "Plan Rows": 1,                                                                     +
                               "Plan Width": 42,                                                                   +
                               "Workers Planned": 2,                                                               +
                               "Single Copy": false,                                                               +
                               "Plans": [                                                                          +
                                 {                                                                                 +
                                   "Node Type": "Nested Loop",                                                     +
                                   "Parent Relationship": "Outer",                                                 +
                                   "Parallel Aware": false,                                                        +
                                   "Join Type": "Anti",                                                            +
                                   "Startup Cost": 263.86,                                                         +
                                   "Total Cost": 178066.47,                                                        +
                                   "Plan Rows": 1,                                                                 +
                                   "Plan Width": 42,                                                               +
                                   "Inner Unique": false,                                                          +
                                   "Plans": [                                                                      +
                                     {                                                                             +
                                       "Node Type": "Hash Join",                                                   +
                                       "Parent Relationship": "Outer",                                             +
                                       "Parallel Aware": false,                                                    +
                                       "Join Type": "Inner",                                                       +
                                       "Startup Cost": 263.43,                                                     +
                                       "Total Cost": 156522.95,                                                    +
                                       "Plan Rows": 33172,                                                         +
                                       "Plan Width": 42,                                                           +
                                       "Inner Unique": false,                                                      +
                                       "Hash Cond": "(l1.l_suppkey = supplier.s_suppkey)",                         +
                                       "Plans": [                                                                  +
                                         {                                                                         +
                                           "Node Type": "Seq Scan",                                                +
                                           "Parent Relationship": "Outer",                                         +
                                           "Parallel Aware": true,                                                 +
                                           "Relation Name": "lineitem",                                            +
                                           "Alias": "l1",                                                          +
                                           "Startup Cost": 0.00,                                                   +
                                           "Total Cost": 152802.09,                                                +
                                           "Plan Rows": 833522,                                                    +
                                           "Plan Width": 16,                                                       +
                                           "Filter": "(l_receiptdate > l_commitdate)"                              +
                                         },                                                                        +
                                         {                                                                         +
                                           "Node Type": "Hash",                                                    +
                                           "Parent Relationship": "Inner",                                         +
                                           "Parallel Aware": false,                                                +
                                           "Startup Cost": 258.43,                                                 +
                                           "Total Cost": 258.43,                                                   +
                                           "Plan Rows": 400,                                                       +
                                           "Plan Width": 30,                                                       +
                                           "Plans": [                                                              +
                                             {                                                                     +
                                               "Node Type": "Nested Loop",                                         +
                                               "Parent Relationship": "Outer",                                     +
                                               "Parallel Aware": false,                                            +
                                               "Join Type": "Inner",                                               +
                                               "Startup Cost": 11.38,                                              +
                                               "Total Cost": 258.43,                                               +
                                               "Plan Rows": 400,                                                   +
                                               "Plan Width": 30,                                                   +
                                               "Inner Unique": false,                                              +
                                               "Plans": [                                                          +
                                                 {                                                                 +
                                                   "Node Type": "Seq Scan",                                        +
                                                   "Parent Relationship": "Outer",                                 +
                                                   "Parallel Aware": false,                                        +
                                                   "Relation Name": "nation",                                      +
                                                   "Alias": "nation",                                              +
                                                   "Startup Cost": 0.00,                                           +
                                                   "Total Cost": 1.31,                                             +
                                                   "Plan Rows": 1,                                                 +
                                                   "Plan Width": 4,                                                +
                                                   "Filter": "(n_name = 'UNITED KINGDOM'::bpchar)"                 +
                                                 },                                                                +
                                                 {                                                                 +
                                                   "Node Type": "Bitmap Heap Scan",                                +
                                                   "Parent Relationship": "Inner",                                 +
                                                   "Parallel Aware": false,                                        +
                                                   "Relation Name": "supplier",                                    +
                                                   "Alias": "supplier",                                            +
                                                   "Startup Cost": 11.38,                                          +
                                                   "Total Cost": 253.12,                                           +
                                                   "Plan Rows": 400,                                               +
                                                   "Plan Width": 38,                                               +
                                                   "Recheck Cond": "(s_nationkey = nation.n_nationkey)",           +
                                                   "Plans": [                                                      +
                                                     {                                                             +
                                                       "Node Type": "Bitmap Index Scan",                           +
                                                       "Parent Relationship": "Outer",                             +
                                                       "Parallel Aware": false,                                    +
                                                       "Index Name": "idx_supplier_nation_key",                    +
                                                       "Startup Cost": 0.00,                                       +
                                                       "Total Cost": 11.29,                                        +
                                                       "Plan Rows": 400,                                           +
                                                       "Plan Width": 0,                                            +
                                                       "Index Cond": "(s_nationkey = nation.n_nationkey)"          +
                                                     }                                                             +
                                                   ]                                                               +
                                                 }                                                                 +
                                               ]                                                                   +
                                             }                                                                     +
                                           ]                                                                       +
                                         }                                                                         +
                                       ]                                                                           +
                                     },                                                                            +
                                     {                                                                             +
                                       "Node Type": "Index Scan",                                                  +
                                       "Parent Relationship": "Inner",                                             +
                                       "Parallel Aware": false,                                                    +
                                       "Scan Direction": "Forward",                                                +
                                       "Index Name": "idx_lineitem_orderkey",                                      +
                                       "Relation Name": "lineitem",                                                +
                                       "Alias": "l3",                                                              +
                                       "Startup Cost": 0.43,                                                       +
                                       "Total Cost": 1.09,                                                         +
                                       "Plan Rows": 6,                                                             +
                                       "Plan Width": 16,                                                           +
                                       "Index Cond": "(l_orderkey = l1.l_orderkey)",                               +
                                       "Filter": "((l_receiptdate > l_commitdate) AND (l_suppkey <> l1.l_suppkey))"+
                                     }                                                                             +
                                   ]                                                                               +
                                 }                                                                                 +
                               ]                                                                                   +
                             },                                                                                    +
                             {                                                                                     +
                               "Node Type": "Index Scan",                                                          +
                               "Parent Relationship": "Inner",                                                     +
                               "Parallel Aware": false,                                                            +
                               "Scan Direction": "Forward",                                                        +
                               "Index Name": "idx_lineitem_orderkey",                                              +
                               "Relation Name": "lineitem",                                                        +
                               "Alias": "l2",                                                                      +
                               "Startup Cost": 0.43,                                                               +
                               "Total Cost": 1.05,                                                                 +
                               "Plan Rows": 17,                                                                    +
                               "Plan Width": 16,                                                                   +
                               "Index Cond": "(l_orderkey = l1.l_orderkey)",                                       +
                               "Filter": "(l_suppkey <> l1.l_suppkey)"                                             +
                             }                                                                                     +
                           ]                                                                                       +
                         },                                                                                        +
                         {                                                                                         +
                           "Node Type": "Index Scan",                                                              +
                           "Parent Relationship": "Inner",                                                         +
                           "Parallel Aware": false,                                                                +
                           "Scan Direction": "Forward",                                                            +
                           "Index Name": "orders_pkey",                                                            +
                           "Relation Name": "orders",                                                              +
                           "Alias": "orders",                                                                      +
                           "Startup Cost": 0.43,                                                                   +
                           "Total Cost": 0.51,                                                                     +
                           "Plan Rows": 1,                                                                         +
                           "Plan Width": 4,                                                                        +
                           "Index Cond": "(o_orderkey = l1.l_orderkey)",                                           +
                           "Filter": "(o_orderstatus = 'F'::bpchar)"                                               +
                         }                                                                                         +
                       ]                                                                                           +
                     }                                                                                             +
                   ]                                                                                               +
                 }                                                                                                 +
               ]                                                                                                   +
             }                                                                                                     +
           ]                                                                                                       +
         }                                                                                                         +
       ]                                                                                                           +
     },                                                                                                            +
     "JIT": {                                                                                                      +
       "Worker Number": -1,                                                                                        +
       "Functions": 38,                                                                                            +
       "Options": {                                                                                                +
         "Inlining": false,                                                                                        +
         "Optimization": false,                                                                                    +
         "Expressions": true,                                                                                      +
         "Deforming": true                                                                                         +
       }                                                                                                           +
     }                                                                                                             +
   }                                                                                                               +
 ]
(1 row)

          s_name           | numwait 
---------------------------+---------
 Supplier#000009568        |      21
 Supplier#000004411        |      19
 Supplier#000001468        |      18
 Supplier#000003298        |      18
 Supplier#000006352        |      18
 Supplier#000008757        |      18
 Supplier#000008790        |      18
 Supplier#000009557        |      18
 Supplier#000001998        |      17
 Supplier#000005657        |      17
 Supplier#000006188        |      17
 Supplier#000006422        |      17
 Supplier#000007849        |      17
 Supplier#000008552        |      17
 Supplier#000008949        |      17
 Supplier#000003112        |      16
 Supplier#000003613        |      16
 Supplier#000009545        |      16
 Supplier#000000007        |      15
 Supplier#000000266        |      15
 Supplier#000000429        |      15
 Supplier#000002054        |      15
 Supplier#000005971        |      15
 Supplier#000006296        |      15
 Supplier#000006459        |      15
 Supplier#000007012        |      15
 Supplier#000009178        |      15
 Supplier#000009827        |      15
 Supplier#000009923        |      15
 Supplier#000000247        |      14
 Supplier#000000268        |      14
 Supplier#000001300        |      14
 Supplier#000001401        |      14
 Supplier#000001900        |      14
 Supplier#000003540        |      14
 Supplier#000004485        |      14
 Supplier#000004568        |      14
 Supplier#000005359        |      14
 Supplier#000005594        |      14
 Supplier#000007120        |      14
 Supplier#000007207        |      14
 Supplier#000008177        |      14
 Supplier#000009339        |      14
 Supplier#000001140        |      13
 Supplier#000001482        |      13
 Supplier#000002841        |      13
 Supplier#000002902        |      13
 Supplier#000003936        |      13
 Supplier#000004118        |      13
 Supplier#000004308        |      13
 Supplier#000004470        |      13
 Supplier#000004598        |      13
 Supplier#000004607        |      13
 Supplier#000004737        |      13
 Supplier#000005046        |      13
 Supplier#000005523        |      13
 Supplier#000005609        |      13
 Supplier#000005834        |      13
 Supplier#000006083        |      13
 Supplier#000006164        |      13
 Supplier#000006239        |      13
 Supplier#000006658        |      13
 Supplier#000007310        |      13
 Supplier#000007706        |      13
 Supplier#000008269        |      13
 Supplier#000008348        |      13
 Supplier#000008676        |      13
 Supplier#000009456        |      13
 Supplier#000009864        |      13
 Supplier#000009959        |      13
 Supplier#000000170        |      12
 Supplier#000000260        |      12
 Supplier#000000295        |      12
 Supplier#000000957        |      12
 Supplier#000001074        |      12
 Supplier#000001166        |      12
 Supplier#000001488        |      12
 Supplier#000002086        |      12
 Supplier#000002257        |      12
 Supplier#000003417        |      12
 Supplier#000003532        |      12
 Supplier#000004811        |      12
 Supplier#000005034        |      12
 Supplier#000005368        |      12
 Supplier#000005678        |      12
 Supplier#000005726        |      12
 Supplier#000005933        |      12
 Supplier#000006057        |      12
 Supplier#000006469        |      12
 Supplier#000006525        |      12
 Supplier#000006616        |      12
 Supplier#000006726        |      12
 Supplier#000006835        |      12
 Supplier#000006976        |      12
 Supplier#000007372        |      12
 Supplier#000007556        |      12
 Supplier#000008640        |      12
 Supplier#000008810        |      12
 Supplier#000008980        |      12
 Supplier#000009087        |      12
(100 rows)

QUERY PLAN                                                                    
--------------------------------------------------------------------------------------------------------------------------------------------------
 [                                                                                                                                               +
   {                                                                                                                                             +
     "Plan": {                                                                                                                                   +
       "Node Type": "Limit",                                                                                                                     +
       "Parallel Aware": false,                                                                                                                  +
       "Startup Cost": 16101.30,                                                                                                                 +
       "Total Cost": 16101.43,                                                                                                                   +
       "Plan Rows": 1,                                                                                                                           +
       "Plan Width": 72,                                                                                                                         +
       "Plans": [                                                                                                                                +
         {                                                                                                                                       +
           "Node Type": "Aggregate",                                                                                                             +
           "Strategy": "Plain",                                                                                                                  +
           "Partial Mode": "Finalize",                                                                                                           +
           "Parent Relationship": "InitPlan",                                                                                                    +
           "Subplan Name": "InitPlan 1 (returns $1)",                                                                                            +
           "Parallel Aware": false,                                                                                                              +
           "Startup Cost": 6353.82,                                                                                                              +
           "Total Cost": 6353.83,                                                                                                                +
           "Plan Rows": 1,                                                                                                                       +
           "Plan Width": 32,                                                                                                                     +
           "Plans": [                                                                                                                            +
             {                                                                                                                                   +
               "Node Type": "Gather",                                                                                                            +
               "Parent Relationship": "Outer",                                                                                                   +
               "Parallel Aware": false,                                                                                                          +
               "Startup Cost": 6353.60,                                                                                                          +
               "Total Cost": 6353.81,                                                                                                            +
               "Plan Rows": 2,                                                                                                                   +
               "Plan Width": 32,                                                                                                                 +
               "Workers Planned": 2,                                                                                                             +
               "Single Copy": false,                                                                                                             +
               "Plans": [                                                                                                                        +
                 {                                                                                                                               +
                   "Node Type": "Aggregate",                                                                                                     +
                   "Strategy": "Plain",                                                                                                          +
                   "Partial Mode": "Partial",                                                                                                    +
                   "Parent Relationship": "Outer",                                                                                               +
                   "Parallel Aware": false,                                                                                                      +
                   "Startup Cost": 5353.60,                                                                                                      +
                   "Total Cost": 5353.61,                                                                                                        +
                   "Plan Rows": 1,                                                                                                               +
                   "Plan Width": 32,                                                                                                             +
                   "Plans": [                                                                                                                    +
                     {                                                                                                                           +
                       "Node Type": "Seq Scan",                                                                                                  +
                       "Parent Relationship": "Outer",                                                                                           +
                       "Parallel Aware": true,                                                                                                   +
                       "Relation Name": "customer",                                                                                              +
                       "Alias": "customer_1",                                                                                                    +
                       "Startup Cost": 0.00,                                                                                                     +
                       "Total Cost": 5348.62,                                                                                                    +
                       "Plan Rows": 1989,                                                                                                        +
                       "Plan Width": 6,                                                                                                          +
                       "Filter": "((c_acctbal > 0.00) AND (\"substring\"((c_phone)::text, 1, 2) = ANY ('{19,24,11,25,30,20,15}'::text[])))"      +
                     }                                                                                                                           +
                   ]                                                                                                                             +
                 }                                                                                                                               +
               ]                                                                                                                                 +
             }                                                                                                                                   +
           ]                                                                                                                                     +
         },                                                                                                                                      +
         {                                                                                                                                       +
           "Node Type": "Aggregate",                                                                                                             +
           "Strategy": "Sorted",                                                                                                                 +
           "Partial Mode": "Finalize",                                                                                                           +
           "Parent Relationship": "Outer",                                                                                                       +
           "Parallel Aware": false,                                                                                                              +
           "Startup Cost": 9747.46,                                                                                                              +
           "Total Cost": 9846.11,                                                                                                                +
           "Plan Rows": 738,                                                                                                                     +
           "Plan Width": 72,                                                                                                                     +
           "Group Key": ["(\"substring\"((customer.c_phone)::text, 1, 2))"],                                                                     +
           "Plans": [                                                                                                                            +
             {                                                                                                                                   +
               "Node Type": "Gather Merge",                                                                                                      +
               "Parent Relationship": "Outer",                                                                                                   +
               "Parallel Aware": false,                                                                                                          +
               "Startup Cost": 9747.46,                                                                                                          +
               "Total Cost": 9827.04,                                                                                                            +
               "Plan Rows": 616,                                                                                                                 +
               "Plan Width": 72,                                                                                                                 +
               "Workers Planned": 2,                                                                                                             +
               "Params Evaluated": ["$1"],                                                                                                       +
               "Plans": [                                                                                                                        +
                 {                                                                                                                               +
                   "Node Type": "Aggregate",                                                                                                     +
                   "Strategy": "Sorted",                                                                                                         +
                   "Partial Mode": "Partial",                                                                                                    +
                   "Parent Relationship": "Outer",                                                                                               +
                   "Parallel Aware": false,                                                                                                      +
                   "Startup Cost": 8747.44,                                                                                                      +
                   "Total Cost": 8755.91,                                                                                                        +
                   "Plan Rows": 308,                                                                                                             +
                   "Plan Width": 72,                                                                                                             +
                   "Group Key": ["(\"substring\"((customer.c_phone)::text, 1, 2))"],                                                             +
                   "Plans": [                                                                                                                    +
                     {                                                                                                                           +
                       "Node Type": "Sort",                                                                                                      +
                       "Parent Relationship": "Outer",                                                                                           +
                       "Parallel Aware": false,                                                                                                  +
                       "Startup Cost": 8747.44,                                                                                                  +
                       "Total Cost": 8748.21,                                                                                                    +
                       "Plan Rows": 308,                                                                                                         +
                       "Plan Width": 38,                                                                                                         +
                       "Sort Key": ["(\"substring\"((customer.c_phone)::text, 1, 2))"],                                                          +
                       "Plans": [                                                                                                                +
                         {                                                                                                                       +
                           "Node Type": "Nested Loop",                                                                                           +
                           "Parent Relationship": "Outer",                                                                                       +
                           "Parallel Aware": false,                                                                                              +
                           "Join Type": "Anti",                                                                                                  +
                           "Startup Cost": 0.43,                                                                                                 +
                           "Total Cost": 8734.71,                                                                                                +
                           "Plan Rows": 308,                                                                                                     +
                           "Plan Width": 38,                                                                                                     +
                           "Inner Unique": false,                                                                                                +
                           "Plans": [                                                                                                            +
                             {                                                                                                                   +
                               "Node Type": "Seq Scan",                                                                                          +
                               "Parent Relationship": "Outer",                                                                                   +
                               "Parallel Aware": true,                                                                                           +
                               "Relation Name": "customer",                                                                                      +
                               "Alias": "customer",                                                                                              +
                               "Startup Cost": 0.00,                                                                                             +
                               "Total Cost": 5348.62,                                                                                            +
                               "Plan Rows": 729,                                                                                                 +
                               "Plan Width": 26,                                                                                                 +
                               "Filter": "((c_acctbal > $1) AND (\"substring\"((c_phone)::text, 1, 2) = ANY ('{19,24,11,25,30,20,15}'::text[])))"+
                             },                                                                                                                  +
                             {                                                                                                                   +
                               "Node Type": "Index Only Scan",                                                                                   +
                               "Parent Relationship": "Inner",                                                                                   +
                               "Parallel Aware": false,                                                                                          +
                               "Scan Direction": "Forward",                                                                                      +
                               "Index Name": "idx_orders_custkey",                                                                               +
                               "Relation Name": "orders",                                                                                        +
                               "Alias": "orders",                                                                                                +
                               "Startup Cost": 0.43,                                                                                             +
                               "Total Cost": 48.22,                                                                                              +
                               "Plan Rows": 17,                                                                                                  +
                               "Plan Width": 8,                                                                                                  +
                               "Index Cond": "(o_custkey = customer.c_custkey)"                                                                  +
                             }                                                                                                                   +
                           ]                                                                                                                     +
                         }                                                                                                                       +
                       ]                                                                                                                         +
                     }                                                                                                                           +
                   ]                                                                                                                             +
                 }                                                                                                                               +
               ]                                                                                                                                 +
             }                                                                                                                                   +
           ]                                                                                                                                     +
         }                                                                                                                                       +
       ]                                                                                                                                         +
     }                                                                                                                                           +
   }                                                                                                                                             +
 ]
(1 row)

 cntrycode | numcust | totacctbal 
-----------+---------+------------
 11        |     895 | 6682253.81
(1 row)

